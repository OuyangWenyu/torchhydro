import numpy as np
from hydrodataset import CamelsYstl
from torchhydro.datasets.arch import Arch
from tests.test_arch_data import (
    e_42, e_42_original, e_60, e_100, e_395, e_500, e_1000, e_1460,
    y_arma_3_100, y_residual_arma_3_p3d0q3_100,
    y_streamflow_100, y_streamflow_395, y_residual_streamflow_395, y_residual_2_streamflow_395,
    y_streamflow_1460, y_residual_streamflow_1460, y_residual_2_streamflow_1460,
    y_streamflow_395_itp,
    y_streamflow_395_Omege, y_streamflow_1460_Omege,
    y_residual_2_streamflow_395_1,
)

class Ystl(object):
    def __init__(self):
        self.datasource = CamelsYstl()
        self.basin = ["1000",]
        self.time_range = ["1990-01-01","1994-01-01"]
        self.var_list = ["streamflow", "discharge_vol1", "discharge_vol2", "discharge_vol3",]
        self.pet_list = ["pet"]
        self.prcp_list = ["prcp"]
        self.streamflow = None
        self.prcp = None
        self.pet = None
        self.read_streamflow()
        # self.read_prcp()
        # self.read_pet()

    def read_streamflow(self):
        data = self.datasource.read_ts_xrdataset(
            self.basin,
            self.time_range,
            self.var_list,
        )
        data1 = data.streamflow.to_dataframe()
        # data2 = data.discharge_vol1.to_dataframe()
        # data3 = data.discharge_vol2.to_dataframe()
        # data4 = data.discharge_vol3.to_dataframe()
        # data1.drop(axis=0, index=("1000", "1992-02-29"), inplace=True)
        # data2.drop(axis=0, index=("1000", "1992-02-29"), inplace=True)
        # data3.drop(axis=0, index=("1000", "1992-02-29"), inplace=True)
        # data4.drop(axis=0, index=("1000", "1992-02-29"), inplace=True)
        data1 = data1.values[:, 0]
        # data2 = data2.values[:, 0]
        # data3 = data3.values[:, 0]
        # data4 = data4.values[:, 0]
        data_ = data1.tolist()  # + data2.tolist() + data3.tolist() + data4.tolist()
        self.streamflow = data_  # + data_

def test_cov():
    x = [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25]
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]
    arch = Arch()
    cov_xy = arch.cov(x, y)
    print(cov_xy)
# 112.0

def test_correlation_coefficient():
    x = [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25]
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]
    arch = Arch()
    cf_xy = arch.correlation_coefficient(x, y)
    print(cf_xy)
# 1.0

def test_autocorrelation_coefficient():
    x = [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25]
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]
    arch = Arch()
    acf_x = arch.autocorrelation_coefficient(x, 0)
    acf_y = arch.autocorrelation_coefficient(y, 0)
    print("acf_x")
    print(acf_x)
    print("acf_y")
    print(acf_y)
# acf_x  p=0
# 1.0
# acf_y
# 1.0
# acf_x  p=1
# 0.7692307692307692
# acf_y
# 0.7692307692307692
# acf_x  p=2
# 0.543956043956044
# acf_y
# 0.543956043956044

def test_autocorrelation_function():
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]  # 13
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    y_non_stationary = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49,
                        47, 53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    acf_y = arch.autocorrelation_function(y_residual_streamflow_1460, 500)
    print("acf_y")
    print(acf_y)
# acf_y  y_streamflow_100
# [1.0, 0.4890217866079111, 0.3730435325796203, 0.30943171756125193, 0.2903743490414458, 0.2527380292429242,
#  0.22716180864275232, 0.201260054027222, 0.17799776823752736, 0.161526129486014, 0.15922140814570662,
#  0.16479811526698018, 0.14814069021275406, 0.10396022090655761, 0.10756174327598879, 0.1159200114033717,
#  0.09532994462046454, 0.0737327012245338, 0.0607135930433197, 0.04689502511205941, 0.04358534730555633,
#  0.05028332135152962, 0.06620434569109297, 0.08901400134251614, 0.12600021297823052, 0.1497104874726196,
#  0.14870136607406342, 0.08687728972936505, -0.02465822041046203, -0.035884808206033784, -0.04764973197177684,
#  -0.060146343023873776, -0.07080382545122141, -0.07734197898525726, -0.07731508598397653, -0.07019732141743823,
#  -0.060750990224451414, -0.06066294530597317, -0.0572185180396532, -0.04266840328598805, -0.03843981978902132,
#  -0.04537584163326208, -0.055028190390885426, -0.06126381760750669, -0.06359274253763472, -0.05978966182367262,
#  -0.055868205441495414, -0.057661770678519936, -0.05435524208488426, -0.020390510188813268, 0.0695531457689958,
#  0.15828655265323596, -0.002858335965718018, -0.09195051913397304, -0.10091445816022428, -0.09354964960831892,
#  -0.08774669254716466, -0.08653614399035475, -0.09262396398096126, -0.10651991047714839, -0.112897773677954,
#  -0.11353825607086294, -0.11371448284625305, -0.11159937429155692, -0.10999820143057237, -0.10632281858930692,
#  -0.1008519196022209, -0.09532138652502058, -0.0935769126031454, -0.10788807665553737, -0.1248659979494118,
#  -0.12465016794812338, -0.12351870226452377, -0.11683269270392024, -0.10821073552044914, -0.10173997072560591,
#  -0.09709867000494606]

def test_partial_autocorrelation_coefficient():
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]  # 13
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    y_non_stationary = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49,
                        47, 53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    r_k = [1, 0.909385243, 0.858581821, 0.769086258, 0.718442721, 0.630705892, 0.58086178, 0.495523223, 0.447118075,
           0.364817332, 0.318490687, 0.239867296, 0.196258694, 0.121952194, 0.081701175, 0.012351107, -0.02390279,
           -0.087656887, -0.119274123, -0.176792709, -0.203133744, -0.25377728, -0.274202574, -0.317331521,
           -0.331201535, -0.366176353, -0.372851547, -0.399032696, -0.397873531, -0.414621473, -0.404988408,
           -0.411663602]
    r_k_1 = r_k[:1]
    pacc_k = arch.partial_autocorrelation_coefficient(r_k_1)
    print("pacc_k")
    print(pacc_k)
# pacc_k k=1
# 0.909385243

def test_partial_autocorrelation_function():
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]  # 13
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    y_non_stationary = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49,
                        47, 53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    pacf_y= arch.partial_autocorrelation_function(y_residual_streamflow_1460, 500)
    print("pacf_y")
    print(pacf_y)
# pacf_y  y_streamflow_100
# [ 1.00000000e+00  4.89021787e-01  1.75987213e-01  9.31707703e-02
#   8.74213878e-02  3.96493886e-02  3.02744689e-02  1.69247427e-02
#   8.81097249e-03  9.87713548e-03  2.16151652e-02  3.02773406e-02
#   5.53302329e-03 -3.16597373e-02  1.09679441e-02  1.98711211e-02
#  -9.17391470e-03 -1.33746584e-02 -8.30007167e-03 -1.01007508e-02
#   3.86111484e-04  1.13989368e-02  2.30387193e-02  3.45720381e-02
#   5.33592269e-02  4.25830310e-02  1.37520316e-02 -5.80584156e-02
#  -1.24166931e-01 -3.17693461e-02 -2.09489384e-02 -1.47528068e-02
#  -7.93819775e-03 -6.81790754e-03 -1.80482597e-03  3.00300090e-03
#   5.91434517e-03  1.65269969e-03  8.79113146e-03  2.04966292e-02
#   6.34297204e-03 -8.28148541e-03 -5.38688499e-03 -2.81345233e-03
#  -5.72683777e-03 -4.44123033e-03 -7.22476478e-03 -1.49303173e-02
#  -9.40180699e-03  2.39935568e-02  9.07354248e-02  1.19926563e-01
#  -1.32628916e-01 -8.55978421e-02 -1.62353922e-02 -7.76425574e-03
#  -2.53344343e-03 -1.62209507e-03 -9.26597998e-03 -2.16341430e-02
#  -2.37341242e-02 -2.28490757e-02 -1.42089767e-02  4.89734415e-03
#   7.52019068e-03 -7.86979126e-03 -3.42187775e-04  1.67428851e-02
#   1.19367100e-02 -1.16136354e-02 -2.12515114e-02 -1.37671123e-02
#  -1.77814042e-02 -1.53637871e-02 -1.58891374e-02 -1.69086598e-02
#  -5.92238178e-04]

def test_autocorrelation_function_streamflow():
    ystl = Ystl()
    y = ystl.streamflow[:60]
    arch = Arch()
    acf_y = arch.autocorrelation_function(y)
    print("acf_y")
    print(acf_y)
# acf_y_60
# [1.0, 0.8572761620454818, 0.6385768912931514, 0.5050825841013289, 0.44653638403995016, 0.4185441902455531,
#  0.3865704425932139, 0.33706325563399486, 0.2718288785083308, 0.20527471190164556, 0.14627775907318724,
#  0.090195274986454, 0.040649454864340455, 0.020467989378790626, 0.01871623720512344, 0.02399900366360696,
#  0.027130568269475144, 0.015336252842722938, -0.021977685513096576, -0.06831296879203817, -0.09906441374961863,
#  -0.11806218551925013, -0.132441375577407, -0.14502085223578084, -0.1573314825368771, -0.16912342792631613,
#  -0.17980271594051625, -0.1887652012662332, -0.19558386433073563, -0.19946329936429272, -0.19970940673656967,
#  -0.1975305617182452, -0.19417913728434713, -0.19175009440569452, -0.18961722932044892, -0.18499561862816008,
#  -0.17966357456806203, -0.17630856571184267, -0.17379043482347045, -0.17116897410859383, -0.16708284501733178,
#  -0.1610971603858868, -0.15233855973691007, -0.13961232833549037, -0.12670635326968843, -0.11743191106285727,
#  -0.10899764449240897]

def test_partial_autocorrelation_function_streamflow():
    ystl = Ystl()
    y = ystl.streamflow[:60]
    arch = Arch()
    pacf_y = arch.partial_autocorrelation_function(y)
    print("pacf_y")
    print(pacf_y)
# pacf_y_60
# [ 1.10101109e+00 -4.31313671e-01  1.26547726e-01  2.45816853e-02
#   1.82020813e-02 -2.64601338e-03 -1.96984572e-02 -3.09167709e-02
#  -2.65835641e-02 -2.47081339e-02 -2.86656256e-02 -1.95726960e-02
#   5.13427860e-03 -2.90367630e-03 -9.03609942e-04 -6.41873025e-03
#  -2.09019051e-02 -3.68201230e-02 -2.96501411e-02 -1.67478226e-02
#  -1.96007478e-02 -1.56092095e-02 -1.28515601e-02 -1.27453238e-02
#  -1.30679890e-02 -1.46077210e-02 -1.58518908e-02 -1.67253944e-02
#  -1.67478264e-02 -1.57891337e-02 -1.48459537e-02 -1.34477497e-02
#  -1.38717939e-02 -1.29526467e-02 -1.16996186e-02 -1.42725254e-02
#  -1.63146338e-02 -1.55790375e-02 -1.56192771e-02 -1.43930304e-02
#  -1.34924621e-02 -1.17067379e-02 -9.75973446e-03 -1.20831188e-02
#  -1.43523232e-02 -1.26349573e-02]
# pacf_y
# [ 1.          0.85727616 -0.36346162  0.14466159  0.03550953  0.02535685
#   0.00402063 -0.01184719 -0.02137158 -0.01608567 -0.01363453 -0.01709839
#  -0.0078693   0.01670959  0.00863855  0.01060163  0.00506393 -0.00937222
#  -0.02521926 -0.01812237 -0.00528659 -0.0082928  -0.00440002 -0.00168579
#  -0.00162665 -0.00201446 -0.00368665 -0.00513423 -0.00627972 -0.00661231
#  -0.00595238 -0.00528904 -0.0041184  -0.00481954 -0.00415041 -0.00309347
#  -0.00606696 -0.00870686 -0.0085929  -0.00935203 -0.00885177 -0.00871088
#  -0.00762783 -0.00628375 -0.00953454 -0.01308311 -0.01263496]

def test_ar_least_squares_estimation():
    y_42 = [1, 1.1, 1.21, 1.331, 1.4641, 1.61051, 1.771561, 1.9487171, 2.14358881, 2.357947691, 2.59374246,
            2.853116706, 3.138428377, 3.452271214, 3.797498336, 4.177248169, 4.594972986, 5.054470285, 5.559917313,
            6.115909045, 6.727499949, 7.400249944, 8.140274939, 8.954302433, 9.849732676, 10.83470594, 11.91817654,
            13.10999419, 14.42099361, 15.86309297, 17.44940227, 19.1943425, 21.11377675, 23.22515442, 25.54766986,
            28.10243685, 30.91268053, 34.00394859, 37.40434344, 41.14477779, 45.25925557, 49.78518112]
    arch = Arch()
    phi = arch.ar_least_squares_estimation(y_42, 1)
    print("phi")
    print(phi)
# phi
# (array([1.1]), 1.0000000000000004)

def test_adf_least_squares_estimation():
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    arch = Arch()
    rho, s_rho = arch.adf_least_squares_estimation(dy2_c, 3)
    print("rho")
    print(rho)
    print("s_rho")
    print(s_rho)
# rho
# -3.1784358068686576
# s_rho
# 0.40833351710609556

def test_tau_statistic():
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    arch = Arch()
    t_y = arch.tau_statistic(dy2_c, 3)
    print("t_y")
    print(t_y)
# t_y
# -7.7839209217861445

def test_get_tau_critical():
    arch = Arch()
    case = "case 2"
    p = 0.05
    n_sample = 42
    tau_critical = arch.get_tau_critical(case, n_sample, p)
    print("tau_critical")
    print(tau_critical)
# tau_critical
# -1.95
# tau_critical
# -2.9524

def test_adf_test():
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    dx_c_42 = [-8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0,
               -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0,
               -8.0, 8.0, -8.0, 8.0]
    arch = Arch()
    case = "case 1"
    significance_level = 0.05
    b_stability = arch.adf_test(y_residual_2_streamflow_395, 3, case, significance_level)
    print("b_stability")
    print(b_stability)
# b_stability
# True
# b_stability  e_100
# True
# b_stability  e_60
# True
# b_stability  e_42
# True
# b_stability  y_streamflow_100
# False
# b_stability  y_streamflow_395
# False
# b_stability  y_streamflow_1460
# True
# b_stability  y_residual_2_streamflow_1460
# True
# b_stability  y_residual_2_streamflow_395
# True

def test_integrated_one_degree():
    y_non_stationary = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49,
                        47, 53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    y_integrated, y_trend = arch.integrate_one_degree(y_non_stationary)
    p = 4
    case = "case 1"
    significance_level = 0.05
    b_stability = arch.adf_test(y_integrated, p, case, significance_level)
    print("y_integrated")
    print(y_integrated)
    print("y_trend")
    print(y_trend)
    print("b_stability")
    print(b_stability)
# y_integrated
# [ 6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.
#   6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.
#   6. -2.  6. -2.  6.]
# y_trend
# [-1. -1.  5.  3.  9.  7. 13. 11. 17. 15. 21. 19. 25. 23. 29. 27. 33. 31.
#  37. 35. 41. 39. 45. 43. 49. 47. 53. 51. 57. 55. 61. 59. 65. 63. 69. 67.
#  73. 71. 77. 75. 81. 79.]
# b_stability
# False

def test_integrate_d_degree():
    y_non_stationary_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49,
                        47, 53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    y_integrated, y_trend = arch.integrate_d_degree(y_non_stationary_42, 2)
    p = 1
    case = "case 1"
    significance_level = 0.05
    b_stability = arch.adf_test(y_integrated, p, case, significance_level)
    print("y_integrated")
    print(y_integrated)
    print("y_trend")
    print(y_trend)
    print("b_stability")
    print(b_stability)
# y_non_stationary_42 p=1
# y_integrated
# [-8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8.
#  -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8.
#  -8.  8. -8.  8.]
# y_trend
# [-1.  5. 11.  1. 15.  5. 19.  9. 23. 13. 27. 17. 31. 21. 35. 25. 39. 29.
#  43. 33. 47. 37. 51. 41. 55. 45. 59. 49. 63. 53. 67. 57. 71. 61. 75. 65.
#  79. 69. 83. 73. 87. 77.]
# b_stability
# False

def test_integration_streamflow():
    arch = Arch()
    d = 3
    y_integrated, y_trend = arch.integration(x=y_streamflow_395, d=d)
    p = 1
    case = "case 1"
    significance_level = 0.05
    b_stability = arch.adf_test(y_integrated, p, case, significance_level)
    print("y_integrated")
    print(y_integrated)
    print("y_trend")
    print(y_trend)
    print("b_stability")
    print(b_stability)
# y_streamflow_395  d=3
# y_integrated
# [-0.1999999999999602, -0.8000000000000114, 0.0, -0.9000000000000057, 2.842170943040401e-14, 0.9999999999999432,
#  -0.1999999999999318, 1.0999999999999375, -0.1999999999999602, -0.8000000000000114, 0.0, 0.0, 0.0, 0.0, 0.0,
#  -1.8000000000000114, 0.10000000000002274, 1.6999999999999886, 0.0, 0.9000000000000057, -0.09999999999999432,
#  -0.7000000000000455, -0.1999999999999318, 0.7999999999999261, -0.09999999999993747, -0.6000000000000227, 0.0,
#  -0.39999999999997726, 0.09999999999993747, 0.2000000000000739, 0.1999999999999318, 0.20000000000004547,
#  0.09999999999999432, -0.4000000000000057, 0.0, 0.30000000000001137, -0.10000000000002274, -0.19999999999998863, 0.0,
#  -0.29999999999999716, 0.09999999999999432, 0.20000000000000284, 0.0, 0.5999999999999943, -0.19999999999998863,
#  -0.4000000000000057, 0.0, -1.5, 0.29999999999999716, 1.1000000000000085, 0.19999999999998863, 0.6000000000000085,
#  0.10000000000000853, -0.9000000000000341, 0.20000000000004547, 0.5999999999999659, 0.0, -0.5999999999999659,
#  -0.20000000000004547, -0.5999999999999659, 0.0, 0.5999999999999659, 0.20000000000004547, -0.3000000000000398,
#  0.10000000000002274, 0.09999999999999432, 0.0, 0.7999999999999972, -0.09999999999999432, -0.7000000000000028, 0.0,
#  -1.2999999999999972, 0.09999999999999432, 1.2000000000000028, 0.0, 1.0, 0.0, -1.0, 0.0, -0.5, 0.0, 0.5, 0.0,
#  0.20000000000000284, 0.09999999999999432, -0.29999999999999716, 0.0, 0.09999999999999432, 1.4210854715202004e-14,
#  -0.20000000000001705, 0.20000000000001705, -0.20000000000000284, -1.4210854715202004e-14, 0.20000000000000284,
#  -0.19999999999998863, 0.09999999999999432, -0.09999999999999432, 0.0999999999999801, 2.842170943040401e-14,
#  0.0999999999999801, 0.10000000000000853, -0.20000000000001705, 2.842170943040401e-14, 0.0999999999999801,
#  0.10000000000000853, -0.20000000000000284, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, -0.09999999999999432, -0.4000000000000057,
#  0.09999999999999432, 7.5, -0.3999999999999915, -7.200000000000003, 1.4210854715202004e-14, -5.300000000000026,
#  0.30000000000001137, 5.0, 0.0, -4.200000000000017, 0.4000000000000341, 3.799999999999983, 0.0, 0.0, 0.0, 0.0, 0.0,
#  -0.799999999999983, 0.0999999999999659, 0.700000000000017, 0.0, 1.1999999999999886, -0.1999999999999602,
#  -0.9000000000000625, -0.1999999999999318, 0.7999999999999261, -0.09999999999993747, -0.6000000000000227, 0.0,
#  -0.39999999999997726, 0.09999999999993747, 0.2000000000000739, 0.1999999999999318, 1.2000000000000455,
#  -0.19999999999998863, -1.0000000000000568, -0.1999999999999318, -0.5000000000000568, 2.842170943040401e-14,
#  0.5999999999999943, 0.0, 2.6999999999999886, -0.0999999999999659, -2.7000000000000455, 0.20000000000004547,
#  1.099999999999966, 0.10000000000002274, -1.400000000000034, 0.20000000000004547, -4.600000000000051,
#  0.5000000000000568, 3.899999999999949, 0.20000000000004547, 0.1999999999999602, 0.10000000000002274,
#  -0.4000000000000057, 0.0, -1.5999999999999943, 0.19999999999998863, 1.4000000000000057, 0.0, 0.4000000000000057,
#  -2.842170943040401e-14, -0.49999999999994316, 0.1999999999999318, 7.9000000000000625, -0.5000000000000568,
#  -7.5999999999999375, 0.1999999999999318, 33.10000000000005, -2.4000000000000057, -30.900000000000034,
#  0.20000000000004547, 28.599999999999966, -2.1999999999999886, -93.39999999999998, 5.2999999999999545,
#  21.200000000000045, 3.2999999999999545, 37.10000000000002, 0.0, 21.799999999999955, -1.8999999999999204,
#  -19.80000000000001, -0.20000000000004547, 12.300000000000068, -1.1000000000000796, -11.099999999999966, 0.0,
#  2.099999999999966, -0.1999999999999318, -1.900000000000034, 0.0, 4.300000000000011, -0.4000000000000341,
#  -3.7999999999999545, -0.20000000000004547, -3.7999999999999545, 0.39999999999997726, 3.3999999999999773,
#  0.20000000000004547, 0.49999999999994316, 5.684341886080802e-14, -0.6000000000000227, 0.0, -0.8999999999999773,
#  -5.684341886080802e-14, 1.0000000000000568, -0.20000000000004547, -0.8999999999999773, 0.10000000000002274,
#  0.7999999999999545, 0.20000000000004547, 0.7999999999999545, -0.0999999999999659, -0.8000000000000114, 0.0,
#  -0.5999999999999943, 0.19999999999998863, 0.4000000000000057, 0.0, 1.5999999999999943, -0.19999999999998863,
#  -1.4000000000000057, 0.0, 0.4000000000000057, -0.09999999999999432, -0.20000000000004547, -0.1999999999999318,
#  0.6999999999999318, -0.09999999999993747, -0.6000000000000512, 0.20000000000004547, -0.5000000000000284,
#  0.29999999999998295, 5.684341886080802e-14, 0.1999999999999318, 0.5000000000000568, -2.842170943040401e-14,
#  -0.5999999999999943, 0.0, 1.5999999999999943, -0.19999999999998863, -1.4000000000000057, 0.0, -2.0999999999999943,
#  0.19999999999998863, 1.9000000000000057, 0.0, 0.09999999999999432, 0.10000000000002274, -0.3000000000000398,
#  0.20000000000004547, -1.0000000000000284, 0.29999999999998295, 0.5000000000000568, 0.1999999999999318,
#  -0.5999999999999375, 0.1999999999999602, 0.30000000000001137, 0.0, -0.4000000000000057, 0.10000000000002274,
#  0.1999999999999602, 0.20000000000004547, 1.4999999999999432, 5.684341886080802e-14, -1.6000000000000227, 0.0,
#  44.20000000000002, -3.700000000000017, -40.40000000000006, -0.19999999999984652, -55.90000000000015,
#  4.300000000000068, 51.69999999999999, 0.0, 3.099999999999966, -0.1999999999999318, -2.900000000000034, 0.0,
#  4.800000000000011, -0.30000000000001137, -4.600000000000023, 0.20000000000004547, 7.399999999999977,
#  -0.6000000000000227, -6.7999999999999545, -0.20000000000004547, -6.399999999999977, 0.6000000000000227,
#  5.7999999999999545, 0.20000000000004547, -1.7000000000000455, 0.10000000000002274, 1.6000000000000227,
#  -0.20000000000004547, 1.1000000000000796, -0.20000000000010232, -0.7999999999999545, -2.842170943040401e-14,
#  0.6000000000000512, 0.09999999999999432, -0.8000000000000398, 0.20000000000004547, 1.7999999999999545,
#  -0.0999999999999659, -1.8000000000000114, 0.0, 0.6000000000000227, 0.09999999999993747, -0.7999999999999261,
#  0.1999999999999318, 7.7000000000000455, -0.6999999999999886, -7.000000000000057, -0.1999999999999602,
#  -2.399999999999949, -1.1368683772161603e-13, 2.6000000000000796, -0.20000000000004547, -9.0, 0.8000000000000682,
#  8.199999999999932, 0.20000000000004547, 5.099999999999966, -0.5, -4.599999999999966, -0.20000000000004547,
#  14.000000000000057, -1.3000000000000682, -12.499999999999943, -0.20000000000004547, -21.599999999999966,
#  1.6999999999999886, 20.0, 0.0, 3.400000000000034, -0.3000000000000682, -3.099999999999966, 0.0, -0.7000000000000455,
#  0.20000000000010232, 0.3999999999999204, 0.20000000000004547, 2.099999999999966, -0.19999999999998863, -2.0, 0.0,
#  0.700000000000017, 0.0999999999999659, -0.799999999999983, 0.0, 2.9000000000000057, -0.30000000000001137,
#  -1.3000000000000114, -0.0999999999999659, -7.200000000000017, 0.5, 25.80000000000001, -1.6000000000000512,
#  -36.89999999999992, 1.3999999999999488, 12.900000000000034, 0.2999999999999545, 4.900000000000034,
#  -0.10000000000002274, 0.09999999999999432, -0.0999999999999659, -1.700000000000017, 0.0, 2.299999999999983,
#  -0.0999999999999659, -3.0, 0.0999999999999659, 1.200000000000017, 0.0, 86.70000000000002]
# y_trend
# [167.6 165.8 165.  165.2 165.8 165.  165.  162.3 159.6 159.  156.9 158.2
#  158.8 158.  158.  158.  158.  158.  158.  152.6 147.5 145.7 142.2 141.4
#  140.3 138.  135.9 136.3 136.3 135.2 134.7 133.  131.6 130.4 129.5 129.1
#  129.1 128.2 127.7 128.1 128.2 128.  128.  127.1 126.5 126.2 125.7 127.
#  127.7 127.8 128.3 124.3 121.2 119.9 118.  117.8 118.  116.2 115.8 117.1
#  118.5 118.8 119.2 117.9 116.5 116.2 115.8 114.4 113.4 112.5 111.5 112.9
#  114.  113.8 114.3 110.9 107.8 107.  105.  106.  107.  106.  106.  104.5
#  103.  102.5 101.5 101.1 101.  100.2  99.7  99.5  99.3  98.6  98.6  97.9
#   97.3  97.2  96.4  96.   95.2  94.7  94.1  93.8  93.8  93.3  93.   93.
#   93.3  93.1  93.1  93.1  93.1  93.1  93.1  94.6  95.8  96.3  97.5 121.2
#  143.8 152.4 168.2 168.1 168.9 179.4 184.9 177.8 171.9 173.2 170.7 168.2
#  165.7 163.2 160.7 155.8 151.2 147.9 143.9 143.5 142.5 140.  137.9 138.3
#  138.3 137.2 136.7 135.  133.6 132.4 131.5 134.1 136.2 136.6 137.5 137.
#  136.4 137.  137.  145.1 152.9 155.3 160.9 169.7 178.9 185.1 193.2 187.4
#  183.2 186.2 185.8 185.9 186.4 186.  186.  181.2 177.  175.4 172.4 170.6
#  168.8 165.9 164.  185.7 206.  211.5 225.1 337.9 443.6 489.8 567.4 730.7
#  887.5 792.8 740.5 684.9 577.6 541.2 467.7 459.6 445.8 394.4 362.3 367.2
#  368.7 349.1 340.6 338.4 335.6 329.2 324.7 333.1 340.3 340.4 343.8 335.9
#  329.1 328.6 325.2 323.2 321.3 318.2 315.7 310.5 305.3 302.2 297.6 290.4
#  283.4 277.8 271.9 268.3 264.5 259.2 254.7 248.4 242.7 237.6 232.1 231.4
#  230.1 226.2 223.7 222.4 220.8 219.  216.9 217.  216.7 215.2 214.8 212.8
#  211.8 210.4 209.5 210.  210.6 210.  210.  214.8 219.  220.6 223.6 220.3
#  217.6 218.5 217.5 216.8 216.4 215.2 214.8 211.3 208.8 206.9 205.  201.2
#  198.1 195.4 192.4 188.2 184.3 180.6 177.2 178.2 179.3 177.2 176.7 308.8
#  429.8 473.8 557.7 474.  403.1 431.3 407.8 393.6 378.8 358.4 340.9 337.8
#  333.8 320.8 312.9 327.1 339.6 339.2 345.1 331.9 320.4 319.8 313.9 302.8
#  292.1 284.6 275.  268.8 261.9 253.6 246.1 240.4 235.  227.8 221.9 221.3
#  220.5 216.2 213.7 213.  212.6 210.4 209.5 231.6 251.7 258.6 272.  278.3
#  284.5 296.  304.4 285.9 269.7 269.  260.6 267.4 272.8 269.6 270.5 313.5
#  352.5 367.9 395.3 358.  325.7 331.7 317.7 313.9 309.2 298.6 291.1 281.5
#  272.5 264.  255.6 253.4 250.7 244.2 239.7 237.3 235.2 231.4 228.4 234.1
#  238.9 242.7 248.8 234.6 223.1 283.  332.6 291.8 273.9 276.5 263.2 260.7
#  254.3 249.5 245.6 237.9 231.4 231.3 230.4 222.3 216.2 212.4 207.4]
# b_stability
# False


def test_ar_one_step():
    arch = Arch()
    x = [-1, 5, 3]
    phi = [1,  1, -1]
    y_ar = arch.ar_one_step(x, phi)
    print("y_ar")
    print(y_ar)
# y_ar
# 1.0

def test_ma_one_step():
    arch = Arch()
    theta = [0.5, 0.5]
    e_ = [0.2, -0.6, 0.4]
    y_ma = arch.ma_one_step(e_, theta)
    print("y_ma")
    print(y_ma)
# y_ma
# 0.20000000000000004

def test_arma():
    y_ar = [1, 1.1, 1.21, 1.331, 1.4641, 1.61051, 1.771561, 1.9487171, 2.14358881, 2.357947691, 2.59374246,
            2.853116706, 3.138428377, 3.452271214, 3.797498336, 4.177248169, 4.594972986, 5.054470285, 5.559917313,
            6.115909045, 6.727499949, 7.400249944, 8.140274939, 8.954302433, 9.849732676, 10.83470594, 11.91817654,
            13.10999419, 14.42099361, 15.86309297, 17.44940227, 19.1943425, 21.11377675, 23.22515442, 25.54766986,
            28.10243685, 30.91268053, 34.00394859, 37.40434344, 41.14477779, 45.25925557, 49.78518112]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_ma = [1.7353783, -1.36841262, -0.166777075, -0.753366275, 1.45740841, -2.678726045, 2.95109758, -1.57809631,
            0.75515902, -0.35337346, 1.6423096, -2.73567821, 0.763169625, -0.16732928, 1.381313085, -1.61125952,
            0.433033895, -0.736127845, 0.53665943, 0.617224805, -1.336510315, 1.75054977, 0.384745335, 0.10721545,
            0.70512525, -1.078639365, 0.27449017, -0.818807845, 0.255513105, 0.71981598, -0.901322015, 0.004593315,
            -0.433279465, -0.44610282, -0.19312684, 0.378474935, -1.05546158, 0.848587345, 1.5981108, -0.03234046,
            -0.50734116, -0.736194715]
    y_ma_3 = [1.7353783, -0.50072347, -0.41713881, -0.910187173, 1.398521383, -2.249336914, 2.413901882,
              -0.866470275, 0.473005864, -0.32290873, 1.5936451, -2.43638975, 0.072553639, 0.022901334,
              1.563896432, -1.286556336, 0.013603894, -0.675115471, 0.494459221, 0.807378766, -1.151707475,
              1.398538223, 0.764429098, 0.157547476, 0.499730309, -1.100229409, -0.10377932, -0.807829208,
              0.150206757, 0.854577979, -0.659199656, -0.224124415, -0.438436862, -0.446123873, -0.196161369,
              0.470880813, -0.850328004, 0.683679514, 1.858619176, 0.353364577, -0.725437628, -1.100054169]
    y_arma_ = [1, -0.26841262, -0.462030957, -1.261600327, 0.06964805, -2.60211319, 0.088773071, -1.480445931,
              -0.873331504, -1.314038115, 0.196867674, -2.519123769, -2.00786652, -2.375982452, -1.232267612,
              -2.966753893, -2.830395388, -3.849562771, -3.697859618, -3.450420775, -5.131973167, -3.894620714,
              -3.89933745, -4.182055745, -3.89513607, -5.363289042, -5.625127776, -7.006448398, -7.451580133,
              -7.476922166, -9.125936397, -10.03393672, -11.47060986, -13.06377366, -14.56327787, -15.64113072,
              -18.26070538, -19.23818857, -19.56389662, -21.55262675, -24.21523058, -27.37294835]
    y_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49, 47,
            53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    y_arma_3 = [1.7353783, -0.50072347, -0.41713881, -0.92181951, 0.36780299, -1.743817484, 0.237778149, -0.182590216,
                -0.1241625, -0.375413807, 1.169004369, -1.100234682, -1.446588147, -1.114497817, 0.407219526,
                -0.905032923, -1.28627579, -1.82756835, -1.43961739, -0.667941851, -1.964033703, -0.916233958,
                0.015790115, -0.034643347, 0.275217813, -0.787403122, -1.031894986, -1.730389506, -1.704323326,
                -0.880478776, -1.632939545, -2.185126825, -2.691584215, -3.296429054, -3.72094185, -3.501186254,
                -4.616730324, -4.438674962, -2.800814468, -2.76314241, -4.092466378, -5.609301596]
    arch = Arch()
    phi = [1.1, -0.2, 0.2]
    theta = [0.3, 0.2, 0.1]
    # phi = [1.1]
    # theta = [0.5]
    p = 3
    q = 3
    y_arma = arch.arma(x=y_arma_3, e=e, phi=phi, theta=theta, p=p, q=q)
    error = np.array(y_arma_3) - y_arma
    print("y_arma")
    print(y_arma)
    print("error")
    print(error)
# y_ar
# [ 1.          1.1         1.21        1.331       1.4641      1.61051
#   1.771561    1.9487171   2.14358881  2.35794769  2.59374246  2.85311671
#   3.13842838  3.45227121  3.79749834  4.17724817  4.59497299  5.05447028
#   5.55991731  6.11590904  6.72749995  7.40024994  8.14027494  8.95430243
#   9.84973268 10.83470594 11.91817653 13.10999419 14.42099361 15.86309297
#  17.44940227 19.1943425  21.11377675 23.22515443 25.54766986 28.10243685
#  30.91268054 34.00394858 37.40434345 41.14477778 45.25925557 49.78518113]
# error
# [ 0.00000000e+00  0.00000000e+00 -2.22044605e-16  0.00000000e+00
#  -2.22044605e-16  0.00000000e+00 -2.22044605e-16  0.00000000e+00
#  -4.44089210e-16  0.00000000e+00 -1.00000452e-10 -4.44089210e-16
#   4.00000033e-10 -7.00000058e-10  5.99999606e-10 -6.00000050e-10
#   9.99991201e-11  3.99999145e-10 -5.00000930e-10  7.00000058e-10
#  -5.00000930e-10  9.99991201e-11  5.99998273e-10  1.00000008e-10
#  -3.00001801e-10 -3.60000207e-09  5.99999872e-09 -4.00000033e-09
#   9.99998306e-10 -1.00000186e-09  3.00000025e-09  3.00000025e-09
#  -3.55271368e-15 -5.00000397e-09 -2.00000017e-09  4.00000033e-09
#  -5.00000397e-09  6.99999703e-09 -9.00000430e-09  6.00000050e-09
#   9.99996530e-10 -7.00000413e-09]
# y_ma  p=0,q=1
# [ 1.7353783  -1.36841262 -0.16677708 -0.75336627  1.45740841 -2.67872605
#   2.95109758 -1.57809631  0.75515902 -0.35337346  1.6423096  -2.73567821
#   0.76316962 -0.16732928  1.38131309 -1.61125952  0.4330339  -0.73612784
#   0.53665943  0.6172248  -1.33651031  1.75054977  0.38474534  0.10721545
#   0.70512525 -1.07863936  0.27449017 -0.81880785  0.25551311  0.71981598
#  -0.90132201  0.00459331 -0.43327947 -0.44610282 -0.19312684  0.37847494
#  -1.05546158  0.84858734  1.5981108  -0.03234046 -0.50734116 -0.73619472]
# error
# [ 0.00000000e+00  0.00000000e+00  5.55111512e-17  0.00000000e+00
#   0.00000000e+00  4.44089210e-16  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  5.55111512e-17  0.00000000e+00 -4.44089210e-16
#   0.00000000e+00  2.77555756e-17 -2.22044605e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  1.11022302e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00 -5.55111512e-17  1.38777878e-17
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.30104261e-17
#   5.55111512e-17  0.00000000e+00  2.77555756e-17  0.00000000e+00
#   0.00000000e+00  0.00000000e+00 -2.22044605e-16  1.38777878e-17
#   0.00000000e+00  1.11022302e-16]
# y_arma  p=1,q=1
# [  1.          -0.26841262  -0.46203096  -1.26160033   0.06964805
#   -2.60211319   0.08877307  -1.48044593  -0.8733315   -1.31403811
#    0.19686767  -2.51912377  -2.00786652  -2.37598245  -1.23226761
#   -2.96675389  -2.83039539  -3.84956277  -3.69785962  -3.45042077
#   -5.13197317  -3.89462071  -3.89933745  -4.18205575  -3.89513607
#   -5.36328904  -5.62512778  -7.0064484   -7.45158013  -7.47692217
#   -9.1259364  -10.03393672 -11.47060986 -13.06377367 -14.56327787
#  -15.64113072 -18.26070537 -19.23818857 -19.56389663 -21.55262674
#  -24.21523059 -27.37294835]
# error
# [ 0.00000000e+00 -1.11022302e-16  5.55111512e-17  7.00000058e-10
#  -2.99999872e-10  4.44089210e-16  1.24900090e-16  9.00000074e-10
#   1.00000008e-10 -5.99999828e-10  5.00000097e-10 -4.00000477e-10
#   9.00000519e-10  0.00000000e+00  2.00000017e-10  2.00000017e-10
#  -6.99999614e-10  8.00000066e-10  1.00000452e-10 -2.00000461e-10
#   5.00000041e-10 -3.00000025e-10  4.00000921e-10  0.00000000e+00
#  -4.99998709e-10  0.00000000e+00  2.00000017e-10  6.00000938e-10
#  -2.00000017e-10  3.00001801e-10  6.00000050e-10  1.70000192e-09
#  -2.99999847e-09  6.00000050e-09 -3.99999855e-09  2.00000372e-09
#  -8.00000066e-09  3.00000735e-09  6.99999703e-09 -7.99999711e-09
#   5.00000397e-09  3.00000025e-09]
# y_42 p=3,q=0
# [-1.  5.  3.  9.  7. 13. 11. 17. 15. 21. 19. 25. 23. 29. 27. 33. 31. 37.
#  35. 41. 39. 45. 43. 49. 47. 53. 51. 57. 55. 61. 59. 65. 63. 69. 67. 73.
#  71. 77. 75. 81. 79. 85.]
# error
# [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
#  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
# y_ma_3  p=0,q=3
# [ 1.7353783  -0.50072347 -0.41713881 -0.91018717  1.39852138 -2.24933691
#   2.41390188 -0.86647027  0.47300586 -0.32290873  1.5936451  -2.43638975
#   0.07255364  0.02290133  1.56389643 -1.28655634  0.01360389 -0.67511547
#   0.49445922  0.80737877 -1.15170747  1.39853822  0.7644291   0.15754748
#   0.49973031 -1.10022941 -0.10377932 -0.80782921  0.15020676  0.85457798
#  -0.65919966 -0.22412442 -0.43843686 -0.44612387 -0.19616137  0.47088081
#  -0.850328    0.68367951  1.85861918  0.35336458 -0.72543763 -1.10005417]
# error
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   2.22044605e-16  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   5.55111512e-17  5.89805982e-17 -2.22044605e-16  0.00000000e+00
#   5.03069808e-17  0.00000000e+00  5.55111512e-17  0.00000000e+00
#  -2.22044605e-16  2.22044605e-16 -1.11022302e-16  2.77555756e-17
#  -5.55111512e-17  0.00000000e+00  1.38777878e-17  0.00000000e+00
#   2.77555756e-17 -1.11022302e-16  0.00000000e+00  2.77555756e-17
#   0.00000000e+00  0.00000000e+00  2.77555756e-17 -5.55111512e-17
#   1.11022302e-16  0.00000000e+00 -2.22044605e-16  5.55111512e-17
#   1.11022302e-16  0.00000000e+00]
# y_arma  p=3,q=3
# [ 1.7353783  -0.50072347 -0.41713881 -0.92181951  0.36780299 -1.74381749
#   0.23777815 -0.18259022 -0.1241625  -0.37541381  1.16900437 -1.10023468
#  -1.44658815 -1.11449782  0.40721953 -0.90503292 -1.28627579 -1.82756835
#  -1.43961739 -0.66794185 -1.9640337  -0.91623396  0.01579011 -0.03464335
#   0.27521781 -0.78740312 -1.03189499 -1.73038951 -1.70432333 -0.88047878
#  -1.63293955 -2.18512682 -2.69158422 -3.29642905 -3.72094185 -3.50118625
#  -4.61673032 -4.43867496 -2.80081447 -2.76314241 -4.09246638 -5.6093016 ]
# error
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.11022302e-16
#   2.77555756e-16  1.00000008e-09 -5.99999994e-10  2.99999942e-10
#   2.00000086e-10  0.00000000e+00 -1.00000008e-10  6.99999836e-10
#  -5.99999828e-10  5.00000041e-10 -3.00000025e-10  4.00000033e-10
#  -1.00000008e-10  2.00000239e-10  6.00000050e-10 -1.11022302e-16
#   1.00000008e-10  1.00000563e-10  3.99999874e-10 -4.99999993e-10
#   2.99999969e-10  3.00000025e-10  2.00000239e-10 -3.99999811e-10
#   8.00000066e-10 -3.99999922e-10  6.00000272e-10 -5.00000041e-10
#   7.00000502e-10 -5.00000041e-10  4.00000033e-10  2.00000017e-10
#   2.00000905e-10 -4.00000033e-10  2.00000461e-10  2.00000461e-10
#  -2.00000017e-10  4.00000921e-10]

def test_integration():
    y_42_e = [2.62434536, 1.30041627, 0.375950045, -0.006054495, 1.79302332, -0.258324885, 2.36560341, 2.05991608,
              2.08202446, 2.268096861, 3.93116521, 1.524029966, 1.785940822, 2.907008264, 4.739240601, 3.644241619,
              3.872599141, 4.09039776, 5.163201853, 6.71983113, 5.918288374, 7.994664064, 9.614227514, 9.907592133,
              11.0018358, 10.60140606, 11.45342238, 12.11277965, 13.68522082, 16.2595044, 17.02291925, 18.45175859,
              20.22822728, 22.03636243, 24.45382091, 27.75414918, 29.78903788, 33.67970911, 39.18135347, 42.71672304,
              45.4384421, 48.80163439]
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    dy2_center = 0.117178035
    ty2 = [2.62434536, 1.30041627, -0.02351282, -0.54851618, -0.388059035, 3.592101135, -2.30967309, 4.989531705,
           1.75422875, 2.10413284, 2.454169262, 5.594233559, -0.883105278, 2.047851677, 4.028075707, 6.571472937,
           2.549242638, 4.100956663, 4.308196379, 6.236005947, 8.276460406, 5.116745619, 10.07103975, 11.23379096,
           10.20095675, 12.09607946, 10.20097632, 12.3054387, 12.77213692, 15.25766198, 18.83378799, 17.78633411,
           19.88059793, 22.00469597, 23.84449758, 26.87127939, 31.05447745, 31.82392658, 37.57038034, 44.68299784,
           46.2520926, 48.16016116]
    y_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49, 47,
            53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    d = 2
    dx_c, mean_dx, tx = arch.integration(x=y_42, d=d)
    # error_dx_c = np.array(dy2_c) - dx_c
    # error_tx = np.array(ty2) - tx
    print("dx_c")
    print(dx_c)
    # print("error_dx_c")
    # print(error_dx_c)
    print("tx")
    print(tx)
    # print("error_tx")
    # print(error_tx)
    print("mean_dx")
    print(mean_dx)
# dx_c
# [0.28228483050000025, 0.4252836505000001, 2.0639043205000003, -3.9676040545, 4.5580984655, -3.0467936594999996,
#  0.21061767550000038, 0.04678598650000014, 1.3598179135000001, -4.187381627500001, 2.5518680655000003,
#  0.7419785515000002, 0.5939868604999999, -3.044409353499999, 1.2061784694999993, -0.1277369374999991,
#  0.7378274395000001, 0.3666471494999998, -2.4753500674999995, 2.7607404115, -0.5739902745000004, -1.443376865499999,
#  0.6837010135000007, -1.6118514415000003, 1.135268025499999, -0.30983708449999764, 0.7959058654999985,
#  0.884664375500002, -1.9280467645000008, 0.5482464554999996, 0.23045131549999848, -0.08551157449999598,
#  0.4921452954999989, 0.7656917554999975, -1.3826176044999978, 1.7386044954999993, 1.4937950955000017,
#  -2.0834528244999997, -0.930828544499995, 0.5242951954999885]
# error_dx_c
# [-5.00000263e-10 -5.00000097e-10 -5.00000485e-10 -4.99999597e-10
#  -5.00000041e-10 -5.00000485e-10 -5.00000374e-10 -5.00000139e-10
#   4.99999819e-10 -4.99999153e-10 -5.00000485e-10  1.49999979e-09
#  -1.49999990e-09  1.49999879e-09 -4.99999375e-10 -5.00000902e-10
#   4.99999930e-10 -1.49999985e-09  1.49999968e-09 -5.00000041e-10
#  -4.99999597e-10  4.99998931e-10 -3.50000062e-09  6.50000032e-09
#  -3.49999896e-09 -5.00002373e-10  5.00001485e-10  6.49999798e-09
#  -3.49999918e-09 -5.49999957e-09  2.50000151e-09 -5.00004024e-10
#   2.50000110e-09 -4.99997488e-10 -1.50000212e-09 -1.49999924e-09
#   5.49999823e-09 -9.50000034e-09  4.49999493e-09  2.50001153e-09]
# tx
# [ 2.62434536e+00  1.30041627e+00 -2.35128200e-02 -5.48516180e-01
#  -3.88059035e-01  3.59210114e+00 -2.30967309e+00  4.98953170e+00
#   1.75422875e+00  2.10413284e+00  2.45416926e+00  5.59423356e+00
#  -8.83105278e-01  2.04785168e+00  4.02807571e+00  6.57147294e+00
#   2.54924264e+00  4.10095666e+00  4.30819638e+00  6.23600595e+00
#   8.27646041e+00  5.11674562e+00  1.00710398e+01  1.12337910e+01
#   1.02009568e+01  1.20960795e+01  1.02009763e+01  1.23054387e+01
#   1.27721369e+01  1.52576620e+01  1.88337880e+01  1.77863341e+01
#   1.98805979e+01  2.20046960e+01  2.38444976e+01  2.68712794e+01
#   3.10544774e+01  3.18239266e+01  3.75703803e+01  4.46829978e+01
#   4.62520926e+01  4.81601612e+01]
# error_tx
# [ 0.00000000e+00  0.00000000e+00  1.00613962e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  8.88178420e-16
#   2.22044605e-16  0.00000000e+00  0.00000000e+00  0.00000000e+00
#  -1.11022302e-16 -9.99999639e-10  1.00000008e-09 -9.99999195e-10
#   9.99999195e-10  0.00000000e+00  0.00000000e+00  9.99999195e-10
#  -1.00000008e-09  9.99999195e-10 -4.00000033e-09 -3.99999855e-09
#  -2.00000017e-09 -7.00000058e-09  0.00000000e+00  1.77635684e-15
#  -1.77635684e-15 -9.99999905e-09  9.99999727e-09  9.99999727e-09
#   0.00000000e+00  3.55271368e-15 -3.55271368e-15  0.00000000e+00
#   3.55271368e-15  0.00000000e+00  0.00000000e+00  1.00000008e-08
#  -1.00000008e-08 -7.10542736e-15]
# mean_dx
# 0.11717803449999982
# dx_c
# [-8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0,
#  8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0]
# tx
# [-1.  5. 11.  1. 15.  5. 19.  9. 23. 13. 27. 17. 31. 21. 35. 25. 39. 29.
#  43. 33. 47. 37. 51. 41. 55. 45. 59. 49. 63. 53. 67. 57. 71. 61. 75. 65.
#  79. 69. 83. 73. 87. 77.]
# mean_dx
# 0.0

def test_generate_white_noise():
    np.random.seed(1)
    e = np.random.standard_normal(size=1460)
    # e = e.tolist()
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\e.txt', e)
    # print("e")
    # print(e)

def test_streamflow():
    ystl = Ystl()
    y_streamflow = ystl.streamflow
    print("y_streamflow")
    print(y_streamflow)


def test_Q_statistic():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    m = 6
    arch = Arch()
    Q = arch.Q_statistic(x=e, m=m)
    print("e")
    print(e)
    print("Q")
    print(Q)
# Q
# 3.407046110144282
# Q  m=1
# 0.17031960620512743

def test_white_noise_test():
    m = 6
    significant = 0.05
    arch = Arch()
    b_white_noise = arch.white_noise_test(x=e_100, m=m, significance_level=significant)
    print("b_white_noise")
    print(b_white_noise)
# b_white_noise  m=1
# True
# b_white_noise  m=6
# True
# b_white_noise  m=12
# True
# b_white_noise  m=18
# True
# b_white_noise  m=6  e_1000
# True
# b_white_noise  m=6  e_42
# False
# b_white_noise  m=6  e_60
# False
# b_white_noise  m=6  e_100
# True

def test_arima():
    y_ar = [1, 1.1, 1.21, 1.331, 1.4641, 1.61051, 1.771561, 1.9487171, 2.14358881, 2.357947691, 2.59374246,
              2.853116706, 3.138428377, 3.452271214, 3.797498336, 4.177248169, 4.594972986, 5.054470285,
              5.559917313, 6.115909045, 6.727499949, 7.400249944, 8.140274939, 8.954302433, 9.849732676,
              10.83470594, 11.91817654, 13.10999419, 14.42099361, 15.86309297, 17.44940227, 19.1943425,
              21.11377675, 23.22515442, 25.54766986, 28.10243685, 30.91268053, 34.00394859, 37.40434344,
              41.14477779, 45.25925557, 49.78518112]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_ma = [1.7353783, -1.36841262, -0.166777075, -0.753366275, 1.45740841, -2.678726045, 2.95109758, -1.57809631,
            0.75515902, -0.35337346, 1.6423096, -2.73567821, 0.763169625, -0.16732928, 1.381313085, -1.61125952,
            0.433033895, -0.736127845, 0.53665943, 0.617224805, -1.336510315, 1.75054977, 0.384745335, 0.10721545,
            0.70512525, -1.078639365, 0.27449017, -0.818807845, 0.255513105, 0.71981598, -0.901322015, 0.004593315,
            -0.433279465, -0.44610282, -0.19312684, 0.378474935, -1.05546158, 0.848587345, 1.5981108, -0.03234046,
            -0.50734116, -0.736194715]
    y_ma_3 = [1.7353783, -0.50072347, -0.41713881, -0.910187173, 1.398521383, -2.249336914, 2.413901882,
              -0.866470275, 0.473005864, -0.32290873, 1.5936451, -2.43638975, 0.072553639, 0.022901334,
              1.563896432, -1.286556336, 0.013603894, -0.675115471, 0.494459221, 0.807378766, -1.151707475,
              1.398538223, 0.764429098, 0.157547476, 0.499730309, -1.100229409, -0.10377932, -0.807829208,
              0.150206757, 0.854577979, -0.659199656, -0.224124415, -0.438436862, -0.446123873, -0.196161369,
              0.470880813, -0.850328004, 0.683679514, 1.858619176, 0.353364577, -0.725437628, -1.100054169]
    y_arma = [1, -0.26841262, -0.462030957, -1.261600327, 0.06964805, -2.60211319, 0.088773071, -1.480445931,
              -0.873331504, -1.314038115, 0.196867674, -2.519123769, -2.00786652, -2.375982452, -1.232267612,
              -2.966753893, -2.830395388, -3.849562771, -3.697859618, -3.450420775, -5.131973167, -3.894620714,
              -3.89933745, -4.182055745, -3.89513607, -5.363289042, -5.625127776, -7.006448398, -7.451580133,
              -7.476922166, -9.125936397, -10.03393672, -11.47060986, -13.06377366, -14.56327787, -15.64113072,
              -18.26070538, -19.23818857, -19.56389662, -21.55262675, -24.21523058, -27.37294835]
    y_arma_3 = [1.7353783, -0.50072347, -0.41713881, -0.92181951, 0.36780299, -1.743817484, 0.237778149, -0.182590216,
                -0.1241625, -0.375413807, 1.169004369, -1.100234682, -1.446588147, -1.114497817, 0.407219526,
                -0.905032923, -1.28627579, -1.82756835, -1.43961739, -0.667941851, -1.964033703, -0.916233958,
                0.015790115, -0.034643347, 0.275217813, -0.787403122, -1.031894986, -1.730389506, -1.704323326,
                -0.880478776, -1.632939545, -2.185126825, -2.691584215, -3.296429054, -3.72094185, -3.501186254,
                -4.616730324, -4.438674962, -2.800814468, -2.76314241, -4.092466378, -5.609301596]
    # i
    y_42_e = [2.62434536, 1.30041627, 0.375950045, -0.006054495, 1.79302332, -0.258324885, 2.36560341, 2.05991608,
              2.08202446, 2.268096861, 3.93116521, 1.524029966, 1.785940822, 2.907008264, 4.739240601, 3.644241619,
              3.872599141, 4.09039776, 5.163201853, 6.71983113, 5.918288374, 7.994664064, 9.614227514, 9.907592133,
              11.0018358, 10.60140606, 11.45342238, 12.11277965, 13.68522082, 16.2595044, 17.02291925, 18.45175859,
              20.22822728, 22.03636243, 24.45382091, 27.75414918, 29.78903788, 33.67970911, 39.18135347, 42.71672304,
              45.4384421, 48.80163439]
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    dy2_center = 0.117178035
    ty2 = [2.62434536, 1.30041627, -0.02351282, -0.54851618, -0.388059035, 3.592101135, -2.30967309, 4.989531705,
           1.75422875, 2.10413284, 2.454169262, 5.594233559, -0.883105278, 2.047851677, 4.028075707, 6.571472937,
           2.549242638, 4.100956663, 4.308196379, 6.236005947, 8.276460406, 5.116745619, 10.07103975, 11.23379096,
           10.20095675, 12.09607946, 10.20097632, 12.3054387, 12.77213692, 15.25766198, 18.83378799, 17.78633411,
           19.88059793, 22.00469597, 23.84449758, 26.87127939, 31.05447745, 31.82392658, 37.57038034, 44.68299784,
           46.2520926, 48.16016116]
    y_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49, 47,
            53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    y_arima_ = [-1, 3.63158738, 2.833222925, 8.246633725, 8.45740841, 10.32127396, 13.95109758, 15.42190369,
               15.75515902, 20.64662654, 20.6423096, 22.26432179, 23.76316963, 28.83267072, 28.38131309,
               31.38874048, 31.4330339, 36.26387216, 35.53665943, 41.61722481, 37.66348969, 46.75054977,
               43.38474534, 49.10721545, 47.70512525, 51.92136064, 51.27449017, 56.18119216, 55.25551311,
               61.71981598, 58.09867799, 65.00459332, 62.56672054, 68.55389718, 66.80687316, 73.37847494,
               69.94453842, 77.84858735, 76.5981108, 80.96765954, 78.49265884, 84.26380529]
    y_ima_p0d2q1 = [1.7353783, 2.102343981, 2.302532586, 1.749354917, 2.653585657, 0.879090353, 2.055692629, 1.654198595,
             2.007863581, 2.008155108, 3.650756234, 2.557679151, 2.227771692, 1.730534954, 2.614611301, 1.887428128,
             1.59327885, 0.563001728, 0.069384035, 0.192991147, -1.019912055, -0.482265487, 0.440126416, 1.469733769,
             3.204466372, 3.86055961, 4.791143018, 4.902918582, 5.27020725, 6.357311899, 6.543094533, 6.733470482,
             6.490566966, 5.80156063, 4.919427454, 4.415769214, 2.856649393, 2.146116918, 3.033695243, 3.888933107,
             4.236829812, 3.848531803]
    arch = Arch()
    phi = []
    theta = [0.5]
    # theta = [0.3, 0.2, 0.1]
    p = 0
    d = 2
    q = 1
    y_arima = arch.arima(x=y_ima_p0d2q1, e=e, phi=None, theta=theta, p=p, d=d, q=q)
    error = np.array(y_ima_p0d2q1) - y_arima
    print("y_arima")
    print(y_arima)
    print("error")
    print(error)
    # dx_c, mean_dx, tx = arch.arima(x=y_42_e, e=None, phi=None, theta=None, p=p, d=d, q=q)
    # error_dx_c = np.array(dy2_c) - dx_c
    # error_tx = np.array(ty2) - tx
    # print("dx_c")
    # print(dx_c)
    # print("error_dx_c")
    # print(error_dx_c)
    # print("tx")
    # print(tx)
    # print("error_tx")
    # print(error_tx)
    # print("mean_dx")
    # print(mean_dx)
# y_ar
# [ 1.          1.1         1.21        1.331       1.4641      1.61051
#   1.771561    1.9487171   2.14358881  2.35794769  2.59374246  2.85311671
#   3.13842838  3.45227121  3.79749834  4.17724817  4.59497299  5.05447028
#   5.55991731  6.11590904  6.72749995  7.40024994  8.14027494  8.95430243
#   9.84973268 10.83470594 11.91817653 13.10999419 14.42099361 15.86309297
#  17.44940227 19.1943425  21.11377675 23.22515443 25.54766986 28.10243685
#  30.91268054 34.00394858 37.40434345 41.14477778 45.25925557 49.78518113]
# error
# [ 0.00000000e+00  0.00000000e+00 -2.22044605e-16  0.00000000e+00
#  -2.22044605e-16  0.00000000e+00 -2.22044605e-16  0.00000000e+00
#  -4.44089210e-16  0.00000000e+00 -1.00000452e-10 -4.44089210e-16
#   4.00000033e-10 -7.00000058e-10  5.99999606e-10 -6.00000050e-10
#   9.99991201e-11  3.99999145e-10 -5.00000930e-10  7.00000058e-10
#  -5.00000930e-10  9.99991201e-11  5.99998273e-10  1.00000008e-10
#  -3.00001801e-10 -3.60000207e-09  5.99999872e-09 -4.00000033e-09
#   9.99998306e-10 -1.00000186e-09  3.00000025e-09  3.00000025e-09
#  -3.55271368e-15 -5.00000397e-09 -2.00000017e-09  4.00000033e-09
#  -5.00000397e-09  6.99999703e-09 -9.00000430e-09  6.00000050e-09
#   9.99996530e-10 -7.00000413e-09]
# y_ma
# [ 1.7353783  -1.36841262 -0.16677708 -0.75336627  1.45740841 -2.67872605
#   2.95109758 -1.57809631  0.75515902 -0.35337346  1.6423096  -2.73567821
#   0.76316962 -0.16732928  1.38131309 -1.61125952  0.4330339  -0.73612784
#   0.53665943  0.6172248  -1.33651031  1.75054977  0.38474534  0.10721545
#   0.70512525 -1.07863936  0.27449017 -0.81880785  0.25551311  0.71981598
#  -0.90132201  0.00459331 -0.43327947 -0.44610282 -0.19312684  0.37847494
#  -1.05546158  0.84858734  1.5981108  -0.03234046 -0.50734116 -0.73619472]
# error
# [ 0.00000000e+00  0.00000000e+00  5.55111512e-17  0.00000000e+00
#   0.00000000e+00  4.44089210e-16  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  5.55111512e-17  0.00000000e+00 -4.44089210e-16
#   0.00000000e+00  2.77555756e-17 -2.22044605e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  1.11022302e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00 -5.55111512e-17  1.38777878e-17
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.30104261e-17
#   5.55111512e-17  0.00000000e+00  2.77555756e-17  0.00000000e+00
#   0.00000000e+00  0.00000000e+00 -2.22044605e-16  1.38777878e-17
#   0.00000000e+00  1.11022302e-16]
# dx_c  p=0,d=2,q=0
# [0.28228483050000025, 0.4252836505000001, 2.0639043205000003, -3.9676040545, 4.5580984655, -3.0467936594999996,
#  0.21061767550000038, 0.04678598650000014, 1.3598179135000001, -4.187381627500001, 2.5518680655000003,
#  0.7419785515000002, 0.5939868604999999, -3.044409353499999, 1.2061784694999993, -0.1277369374999991,
#  0.7378274395000001, 0.3666471494999998, -2.4753500674999995, 2.7607404115, -0.5739902745000004, -1.443376865499999,
#  0.6837010135000007, -1.6118514415000003, 1.135268025499999, -0.30983708449999764, 0.7959058654999985,
#  0.884664375500002, -1.9280467645000008, 0.5482464554999996, 0.23045131549999848, -0.08551157449999598,
#  0.4921452954999989, 0.7656917554999975, -1.3826176044999978, 1.7386044954999993, 1.4937950955000017,
#  -2.0834528244999997, -0.930828544499995, 0.5242951954999885]
# error_dx_c
# [-5.00000263e-10 -5.00000097e-10 -5.00000485e-10 -4.99999597e-10
#  -5.00000041e-10 -5.00000485e-10 -5.00000374e-10 -5.00000139e-10
#   4.99999819e-10 -4.99999153e-10 -5.00000485e-10  1.49999979e-09
#  -1.49999990e-09  1.49999879e-09 -4.99999375e-10 -5.00000902e-10
#   4.99999930e-10 -1.49999985e-09  1.49999968e-09 -5.00000041e-10
#  -4.99999597e-10  4.99998931e-10 -3.50000062e-09  6.50000032e-09
#  -3.49999896e-09 -5.00002373e-10  5.00001485e-10  6.49999798e-09
#  -3.49999918e-09 -5.49999957e-09  2.50000151e-09 -5.00004024e-10
#   2.50000110e-09 -4.99997488e-10 -1.50000212e-09 -1.49999924e-09
#   5.49999823e-09 -9.50000034e-09  4.49999493e-09  2.50001153e-09]
# tx
# [ 2.62434536e+00  1.30041627e+00 -2.35128200e-02 -5.48516180e-01
#  -3.88059035e-01  3.59210114e+00 -2.30967309e+00  4.98953170e+00
#   1.75422875e+00  2.10413284e+00  2.45416926e+00  5.59423356e+00
#  -8.83105278e-01  2.04785168e+00  4.02807571e+00  6.57147294e+00
#   2.54924264e+00  4.10095666e+00  4.30819638e+00  6.23600595e+00
#   8.27646041e+00  5.11674562e+00  1.00710398e+01  1.12337910e+01
#   1.02009568e+01  1.20960795e+01  1.02009763e+01  1.23054387e+01
#   1.27721369e+01  1.52576620e+01  1.88337880e+01  1.77863341e+01
#   1.98805979e+01  2.20046960e+01  2.38444976e+01  2.68712794e+01
#   3.10544774e+01  3.18239266e+01  3.75703803e+01  4.46829978e+01
#   4.62520926e+01  4.81601612e+01]
# error_tx
# [ 0.00000000e+00  0.00000000e+00  1.00613962e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  8.88178420e-16
#   2.22044605e-16  0.00000000e+00  0.00000000e+00  0.00000000e+00
#  -1.11022302e-16 -9.99999639e-10  1.00000008e-09 -9.99999195e-10
#   9.99999195e-10  0.00000000e+00  0.00000000e+00  9.99999195e-10
#  -1.00000008e-09  9.99999195e-10 -4.00000033e-09 -3.99999855e-09
#  -2.00000017e-09 -7.00000058e-09  0.00000000e+00  1.77635684e-15
#  -1.77635684e-15 -9.99999905e-09  9.99999727e-09  9.99999727e-09
#   0.00000000e+00  3.55271368e-15 -3.55271368e-15  0.00000000e+00
#   3.55271368e-15  0.00000000e+00  0.00000000e+00  1.00000008e-08
#  -1.00000008e-08 -7.10542736e-15]
# mean_dx
# 0.11717803449999982
# y_arima
# [  1.          -0.26841262  -0.46203096  -0.22201859  -1.26558416
#    1.07079317  -6.72136417   7.10519854  -6.97589844   1.7790995
#   -1.260315     1.12359216  -9.11680928   1.89075827  -2.32537254
#   -0.03207518  -7.42950425  -1.3675122   -5.59842594  -1.63625081
#   -4.42945973  -7.18014288   0.94299567  -5.15839158  -4.06072724
#   -4.05553073  -8.48280849  -5.37410543  -9.35896273  -6.14236485
#   -7.93709428 -12.55167347 -10.55537795 -13.93020266 -15.01748076
#  -15.57655833 -17.30590539 -21.72286342 -16.80653708 -19.20026921
#  -25.87329907 -28.35056693]
# error
# [ 0.00000000e+00 -1.11022302e-16 -1.66533454e-16 -1.03958173e+00
#   1.33523221e+00 -3.67290636e+00  6.81013724e+00 -8.58564447e+00
#   6.10256694e+00 -3.09313761e+00  1.45718268e+00 -3.64271592e+00
#   7.10894276e+00 -4.26674073e+00  1.09310492e+00 -2.93467871e+00
#   4.59910886e+00 -2.48205057e+00  1.90056632e+00 -1.81416997e+00
#  -7.02513442e-01  3.28552217e+00 -4.84233312e+00  9.76335836e-01
#   1.65591172e-01 -1.30775831e+00  2.85768072e+00 -1.63234297e+00
#   1.90738260e+00 -1.33455732e+00 -1.18884212e+00  2.51773675e+00
#  -9.15231914e-01  8.66428996e-01  4.54202893e-01 -6.45723869e-02
#  -9.54799989e-01  2.48467485e+00 -2.75735954e+00 -2.35235754e+00
#   1.65806849e+00  9.77618582e-01]
# y_arima p=3 q=0
# [-1.  5.  3.  9.  7. 13. 11. 17. 15. 21. 19. 25. 23. 29. 27. 33. 31. 37.
#  35. 41. 39. 45. 43. 49. 47. 53. 51. 57. 55. 61. 59. 65. 63. 69. 67. 73.
#  71. 77. 75. 81. 79. 85.]
# error
# [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
#  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
# y_ma_3  p=0,q=3
# [ 1.7353783  -0.50072347 -0.41713881 -0.91018717  1.39852138 -2.24933691
#   2.41390188 -0.86647027  0.47300586 -0.32290873  1.5936451  -2.43638975
#   0.07255364  0.02290133  1.56389643 -1.28655634  0.01360389 -0.67511547
#   0.49445922  0.80737877 -1.15170747  1.39853822  0.7644291   0.15754748
#   0.49973031 -1.10022941 -0.10377932 -0.80782921  0.15020676  0.85457798
#  -0.65919966 -0.22412442 -0.43843686 -0.44612387 -0.19616137  0.47088081
#  -0.850328    0.68367951  1.85861918  0.35336458 -0.72543763 -1.10005417]
# error
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   2.22044605e-16  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   5.55111512e-17  5.89805982e-17 -2.22044605e-16  0.00000000e+00
#   5.03069808e-17  0.00000000e+00  5.55111512e-17  0.00000000e+00
#  -2.22044605e-16  2.22044605e-16 -1.11022302e-16  2.77555756e-17
#  -5.55111512e-17  0.00000000e+00  1.38777878e-17  0.00000000e+00
#   2.77555756e-17 -1.11022302e-16  0.00000000e+00  2.77555756e-17
#   0.00000000e+00  0.00000000e+00  2.77555756e-17 -5.55111512e-17
#   1.11022302e-16  0.00000000e+00 -2.22044605e-16  5.55111512e-17
#   1.11022302e-16  0.00000000e+00]
# y_arima  p=3,q=3
# [ 1.7353783  -0.50072347 -0.41713881 -0.92181951  0.36780299 -1.74381749
#   0.23777815 -0.18259022 -0.1241625  -0.37541381  1.16900437 -1.10023468
#  -1.44658815 -1.11449782  0.40721953 -0.90503292 -1.28627579 -1.82756835
#  -1.43961739 -0.66794185 -1.9640337  -0.91623396  0.01579011 -0.03464335
#   0.27521781 -0.78740312 -1.03189499 -1.73038951 -1.70432333 -0.88047878
#  -1.63293955 -2.18512682 -2.69158422 -3.29642905 -3.72094185 -3.50118625
#  -4.61673032 -4.43867496 -2.80081447 -2.76314241 -4.09246638 -5.6093016 ]
# error
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.11022302e-16
#   2.77555756e-16  1.00000008e-09 -5.99999994e-10  2.99999942e-10
#   2.00000086e-10  0.00000000e+00 -1.00000008e-10  6.99999836e-10
#  -5.99999828e-10  5.00000041e-10 -3.00000025e-10  4.00000033e-10
#  -1.00000008e-10  2.00000239e-10  6.00000050e-10 -1.11022302e-16
#   1.00000008e-10  1.00000563e-10  3.99999874e-10 -4.99999993e-10
#   2.99999969e-10  3.00000025e-10  2.00000239e-10 -3.99999811e-10
#   8.00000066e-10 -3.99999922e-10  6.00000272e-10 -5.00000041e-10
#   7.00000502e-10 -5.00000041e-10  4.00000033e-10  2.00000017e-10
#   2.00000905e-10 -4.00000033e-10  2.00000461e-10  2.00000461e-10
#  -2.00000017e-10  4.00000921e-10]
# y_arima_ p=1,d=2,q=1
# [-1.          3.63158738  2.83322292  6.76842198  8.96265563 11.24907112
#  13.54012418 14.29384477 19.86386428 16.92956962 22.67916942 22.85507686
#  23.08015243 25.27483049 31.7698096  31.89653261 31.4273947  33.7613114
#  36.90180296 41.04170045 39.61047972 45.55158279 43.23853794 52.63599882
#  46.50351422 52.40593395 50.85073856 54.72889567 55.84681275 60.93900903
#  59.94979287 64.62455213 61.00715382 69.083511   65.97987551 73.22950269
#  70.63296729 77.4217055  76.06973958 84.52679722 79.26681978 82.18299082]
# error
# [ 0.00000000e+00  0.00000000e+00  4.44089210e-16  1.47821174e+00
#  -5.05247224e-01 -9.27797159e-01  4.10973402e-01  1.12805892e+00
#  -4.10870526e+00  3.71705692e+00 -2.03685982e+00 -5.90755073e-01
#   6.83017202e-01  3.55784023e+00 -3.38849651e+00 -5.07792133e-01
#   5.63920150e-03  2.50256076e+00 -1.36514353e+00  5.75524362e-01
#  -1.94699003e+00  1.19896698e+00  1.46207402e-01 -3.52878337e+00
#   1.20161103e+00 -4.84573308e-01  4.23751606e-01  1.45229649e+00
#  -5.91299638e-01  7.80806947e-01 -1.85111488e+00  3.80041191e-01
#   1.55956672e+00 -5.29613823e-01  8.26997646e-01  1.48972251e-01
#  -6.88428873e-01  4.26881851e-01  5.28371217e-01 -3.55913768e+00
#  -7.74160943e-01  2.08081447e+00]
# y_ima_p0d2q1
# [ 1.7353783   2.10234398  2.30253259  1.74935492  2.65358566  0.87909035
#   2.05569263  1.6541986   2.00786358  2.00815511  3.65075623  2.55767915
#   2.22777169  1.73053495  2.6146113   1.88742813  1.59327885  0.56300173
#   0.06938404  0.19299115 -1.01991206 -0.48226549  0.44012642  1.46973377
#   3.20446637  3.86055961  4.79114302  4.90291858  5.27020725  6.3573119
#   6.54309453  6.73347048  6.49056697  5.80156063  4.91942745  4.41576921
#   2.85664939  2.14611692  3.03369524  3.88893311  4.23682981  3.8485318 ]
# error
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.00000030e-09
#  -1.00000008e-09  1.00000053e-09  0.00000000e+00 -2.22044605e-16
#   4.44089210e-16  9.99999639e-10 -9.99999639e-10  9.99999639e-10
#  -9.99999195e-10  9.99999639e-10  0.00000000e+00 -2.22044605e-16
#   0.00000000e+00  1.00000019e-09 -1.00000021e-09  2.77555756e-17
#   9.99999861e-10  4.99600361e-16 -5.55111512e-17  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.00000097e-09
#  -1.00000008e-09  9.99999195e-10  0.00000000e+00  8.88178420e-16
#  -8.88178420e-16  0.00000000e+00  0.00000000e+00  1.00000008e-09
#  -9.99999639e-10  1.00000008e-09 -4.44089210e-16 -9.99999639e-10
#   9.99999195e-10  1.00000008e-09]

def test_arma_least_squares_estimation():
    y_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49, 47,
            53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    y_ar = [1, 1.1, 1.21, 1.331, 1.4641, 1.61051, 1.771561, 1.9487171, 2.14358881, 2.357947691, 2.59374246,
              2.853116706, 3.138428377, 3.452271214, 3.797498336, 4.177248169, 4.594972986, 5.054470285,
              5.559917313, 6.115909045, 6.727499949, 7.400249944, 8.140274939, 8.954302433, 9.849732676,
              10.83470594, 11.91817654, 13.10999419, 14.42099361, 15.86309297, 17.44940227, 19.1943425,
              21.11377675, 23.22515442, 25.54766986, 28.10243685, 30.91268053, 34.00394859, 37.40434344,
              41.14477779, 45.25925557, 49.78518112]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_ma = [1.7353783, -1.36841262, -0.166777075, -0.753366275, 1.45740841, -2.678726045, 2.95109758, -1.57809631,
            0.75515902, -0.35337346, 1.6423096, -2.73567821, 0.763169625, -0.16732928, 1.381313085, -1.61125952,
            0.433033895, -0.736127845, 0.53665943, 0.617224805, -1.336510315, 1.75054977, 0.384745335, 0.10721545,
            0.70512525, -1.078639365, 0.27449017, -0.818807845, 0.255513105, 0.71981598, -0.901322015, 0.004593315,
            -0.433279465, -0.44610282, -0.19312684, 0.378474935, -1.05546158, 0.848587345, 1.5981108, -0.03234046,
            -0.50734116, -0.736194715]
    y_arma = [1, -0.26841262, -0.462030957, -1.261600327, 0.06964805, -2.60211319, 0.088773071, -1.480445931,
              -0.873331504, -1.314038115, 0.196867674, -2.519123769, -2.00786652, -2.375982452, -1.232267612,
              -2.966753893, -2.830395388, -3.849562771, -3.697859618, -3.450420775, -5.131973167, -3.894620714,
              -3.89933745, -4.182055745, -3.89513607, -5.363289042, -5.625127776, -7.006448398, -7.451580133,
              -7.476922166, -9.125936397, -10.03393672, -11.47060986, -13.06377366, -14.56327787, -15.64113072,
              -18.26070538, -19.23818857, -19.56389662, -21.55262675, -24.21523058, -27.37294835]
    y_arma_3 = [1.7353783, -0.50072347, -0.41713881, -0.92181951, 0.36780299, -1.743817484, 0.237778149, -0.182590216,
                -0.1241625, -0.375413807, 1.169004369, -1.100234682, -1.446588147, -1.114497817, 0.407219526,
                -0.905032923, -1.28627579, -1.82756835, -1.43961739, -0.667941851, -1.964033703, -0.916233958,
                0.015790115, -0.034643347, 0.275217813, -0.787403122, -1.031894986, -1.730389506, -1.704323326,
                -0.880478776, -1.632939545, -2.185126825, -2.691584215, -3.296429054, -3.72094185, -3.501186254,
                -4.616730324, -4.438674962, -2.800814468, -2.76314241, -4.092466378, -5.609301596]
    dx_c_42 = [-8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0,
               -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0,
               -8.0, 8.0, -8.0, 8.0]
    arch = Arch()
    p = 1
    q = 0
    phi, theat, R_2, B_1 = arch.arma_least_squares_estimation(dx_c_42, e=e, p=p, q=q)
    print("phi")
    print(phi)
    print("theat")
    print(theat)
    print("R_2")
    print(R_2)
# phi
# [1.1]
# theat
# []
# R_2
# 1.0000000000000004
# phi
# []
# theat
# [0.5]
# R_2
# 1.0000000000000004
# phi
# [1.1]
# theat
# [0.5]
# R_2
# 0.9999999999999996

# y_42
# phi
# [ 1.  1. -1.]
# theat
# []
# R_2
# 1.0000000000000004

# y_arma_3
# phi
# [ 1.1 -0.2  0.2]
# theat
# [0.3 0.2 0.1]
# R_2
# 1.0000000000000004

# dx_c_42
# phi
# [-1.]
# theat
# []
# R_2
# 1.0

def test_x_residual():
    y_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49, 47,
            53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_arma = [1, -0.26841262, -0.462030957, -1.261600327, 0.06964805, -2.60211319, 0.088773071, -1.480445931,
              -0.873331504, -1.314038115, 0.196867674, -2.519123769, -2.00786652, -2.375982452, -1.232267612,
              -2.966753893, -2.830395388, -3.849562771, -3.697859618, -3.450420775, -5.131973167, -3.894620714,
              -3.89933745, -4.182055745, -3.89513607, -5.363289042, -5.625127776, -7.006448398, -7.451580133,
              -7.476922166, -9.125936397, -10.03393672, -11.47060986, -13.06377366, -14.56327787, -15.64113072,
              -18.26070538, -19.23818857, -19.56389662, -21.55262675, -24.21523058, -27.37294835]
    y_arma_3 = [1.7353783, -0.50072347, -0.41713881, -0.92181951, 0.36780299, -1.743817484, 0.237778149, -0.182590216,
                -0.1241625, -0.375413807, 1.169004369, -1.100234682, -1.446588147, -1.114497817, 0.407219526,
                -0.905032923, -1.28627579, -1.82756835, -1.43961739, -0.667941851, -1.964033703, -0.916233958,
                0.015790115, -0.034643347, 0.275217813, -0.787403122, -1.031894986, -1.730389506, -1.704323326,
                -0.880478776, -1.632939545, -2.185126825, -2.691584215, -3.296429054, -3.72094185, -3.501186254,
                -4.616730324, -4.438674962, -2.800814468, -2.76314241, -4.092466378, -5.609301596]
    y_arima_ = [-1, 3.63158738, 2.833222925, 8.246633725, 8.45740841, 10.32127396, 13.95109758, 15.42190369,
               15.75515902, 20.64662654, 20.6423096, 22.26432179, 23.76316963, 28.83267072, 28.38131309,
               31.38874048, 31.4330339, 36.26387216, 35.53665943, 41.61722481, 37.66348969, 46.75054977,
               43.38474534, 49.10721545, 47.70512525, 51.92136064, 51.27449017, 56.18119216, 55.25551311,
               61.71981598, 58.09867799, 65.00459332, 62.56672054, 68.55389718, 66.80687316, 73.37847494,
               69.94453842, 77.84858735, 76.5981108, 80.96765954, 78.49265884, 84.26380529]
    arch = Arch()
    p = 3
    d = 0
    q = 3
    x_residual, y_t, R_2, phi, theta, se_beta = arch.x_residual(y_arma_3_100, e_100, p, d, q)
    print("x_residual")
    print(x_residual)
    print("y_t")
    print(y_t)
    print("R_2")
    print(R_2)
    print("phi")
    print(phi)
    print("theta")
    print(theta)
    print("se_beta")
    print(se_beta)
# x_residual
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  4.13844514e-11
#   1.56662294e-10  7.87194754e-10 -1.77807047e-10 -2.26987956e-10
#   5.21301516e-10 -1.11195664e-10 -1.12275078e-10  4.90903318e-10
#  -1.61525904e-10  2.20385710e-10 -3.22448512e-10  2.88028601e-10
#   1.70512715e-10  4.63185046e-12  6.24862828e-10 -1.06068154e-10
#   8.88311646e-12  2.75892309e-10  1.98695019e-11 -5.22870115e-10
#   3.20349025e-10  1.27309052e-10  3.13661319e-10 -5.37479616e-10
#   8.55849835e-10 -4.94138064e-10  4.74455808e-10 -3.66128017e-10
#   5.77501602e-10 -5.54486235e-10  3.70079523e-10  1.00500497e-10
#   3.07363024e-11 -3.61678687e-10 -1.22156951e-10 -1.31422873e-10
#  -2.18366658e-10  2.72983414e-10]
# y_arma_3
# [ 1.7353783  -0.50072347 -0.41713881 -0.92181951  0.36780299 -1.74381748
#   0.23777815 -0.18259022 -0.1241625  -0.37541381  1.16900437 -1.10023468
#  -1.44658815 -1.11449782  0.40721953 -0.90503292 -1.28627579 -1.82756835
#  -1.43961739 -0.66794185 -1.9640337  -0.91623396  0.01579011 -0.03464335
#   0.27521781 -0.78740312 -1.03189499 -1.73038951 -1.70432333 -0.88047878
#  -1.63293955 -2.18512682 -2.69158422 -3.29642905 -3.72094185 -3.50118625
#  -4.61673032 -4.43867496 -2.80081447 -2.76314241 -4.09246638 -5.6093016 ]
# R_2
# 1.0000000000000004
# x_residual
# [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
#  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
# y_42
# [-1.  5.  3.  9.  7. 13. 11. 17. 15. 21. 19. 25. 23. 29. 27. 33. 31. 37.
#  35. 41. 39. 45. 43. 49. 47. 53. 51. 57. 55. 61. 59. 65. 63. 69. 67. 73.
#  71. 77. 75. 81. 79. 85.]
# R_2
# 1.0
# a_diagonal
# [0.00040064]
# x_residual
# [ 0.00000000e+00  0.00000000e+00  4.44089210e-16  1.40331335e+00
#  -8.17717294e-01 -4.99646601e-01 -3.29780729e-01  1.84984922e+00
#  -4.27926446e+00  3.93349275e+00 -2.04579485e+00  5.20593307e-02
#   2.96326628e-02  3.53882280e+00 -3.44268153e+00  1.84931853e-02
#  -3.06962969e-01  2.54767613e+00 -1.60210167e+00  7.07292812e-01
#  -1.66289830e+00  9.33161702e-01  6.11715380e-01 -3.06226425e+00
#   1.44870941e+00 -3.69034572e-02  2.54079400e-01  1.52194864e+00
#  -8.51870393e-01  8.01416393e-01 -1.58802027e+00  2.62271187e-01
#   1.47652842e+00 -6.48347871e-01  5.89154885e-01  3.03825909e-02
#  -6.24899347e-01  1.54941652e-01  6.70700736e-01 -2.82999462e+00
#  -4.28358225e-01  2.13245049e+00]
# y_arima_
# [-1.          3.63158738  2.83322292  6.84332038  9.2751257  10.82092056
#  14.28087831 13.57205447 20.03442348 16.71313379 22.68810445 22.21226246
#  23.73353697 25.29384792 31.82399462 31.37024729 31.73999687 33.71619603
#  37.1387611  40.909932   39.32638799 45.81738807 42.77302996 52.1694797
#  46.25641584 51.9582641  51.02041077 54.65924352 56.1073835  60.91839959
#  59.68669826 64.74232213 61.09019212 69.20224505 66.21771828 73.34809235
#  70.56943777 77.6936457  75.92741006 83.79765416 78.92101707 82.1313548 ]
# R_2
# 0.9430946447793861
# phi
# [-0.99651228]
# theta
# [0.86154508]
# se_beta
# [0.03930439469615502, 0.29713902184498536]
# x_residual  p=1,d=2,q=0
# [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
#  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
# y_42
# [-1.  5.  3.  9.  7. 13. 11. 17. 15. 21. 19. 25. 23. 29. 27. 33. 31. 37.
#  35. 41. 39. 45. 43. 49. 47. 53. 51. 57. 55. 61. 59. 65. 63. 69. 67. 73.
#  71. 77. 75. 81. 79. 85.]
# R_2
# 1.0
# phi
# [-1.]
# theta
# []
# se_beta
# [nan]
# x_residual  p=1,d=2,q=1
# [ 0.          0.          0.          0.79397652 -0.51466611  1.725641
#  -1.13232029 -0.00205007 -0.03471921 -0.21012213 -1.28683611  1.3571145
#   0.88347822  0.06122573 -0.92980285  0.46681841  0.52890566  0.52307427
#   0.26695905 -0.98332938  1.09859177 -1.30175444 -1.02333415 -1.08610094
#  -0.88577079  0.10027781  0.39070302  0.57043108  0.58939896 -0.86480166
#   0.70081002  0.15259318  0.89384488  0.6000891   0.97346217 -0.23584514
#   1.24215142 -0.38789033 -1.58760219 -1.48718962  0.15588401  0.53697959]
# y_42
# [-1.          5.          3.          8.20602348  7.51466611 11.274359
#  12.13232029 17.00205007 15.03471921 21.21012213 20.28683611 23.6428855
#  22.11652178 28.93877427 27.92980285 32.53318159 30.47109434 36.47692573
#  34.73304095 41.98332938 37.90140823 46.30175444 44.02333415 50.08610094
#  47.88577079 52.89972219 50.60929698 56.42956892 54.41060104 61.86480166
#  58.29918998 64.84740682 62.10615512 68.3999109  66.02653783 73.23584514
#  69.75784858 77.38789033 76.58760219 82.48718962 78.84411599 84.46302041]
# R_2
# 0.9893443873943417
# phi
# [-1.03210395]
# theta
# [-0.21305252]
# se_beta
# [0.018171873517133032, 0.15570320780260488]
# x_residual  p=3,d=0,q=3
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  4.13844514e-11
#   1.56662294e-10  7.87194754e-10 -1.77807047e-10 -2.26987956e-10
#   5.21301516e-10 -1.11195664e-10 -1.12275078e-10  4.90903318e-10
#  -1.61525904e-10  2.20385710e-10 -3.22448512e-10  2.88028601e-10
#   1.70512715e-10  4.63185046e-12  6.24862828e-10 -1.06068154e-10
#   8.88311646e-12  2.75892309e-10  1.98695019e-11 -5.22870115e-10
#   3.20349025e-10  1.27309052e-10  3.13661319e-10 -5.37479616e-10
#   8.55849835e-10 -4.94138064e-10  4.74455808e-10 -3.66128017e-10
#   5.77501602e-10 -5.54486235e-10  3.70079523e-10  1.00500497e-10
#   3.07363024e-11 -3.61678687e-10 -1.22156951e-10 -1.31422873e-10
#  -2.18366658e-10  2.72983414e-10]
# y_arma_3
# [ 1.7353783  -0.50072347 -0.41713881 -0.92181951  0.36780299 -1.74381748
#   0.23777815 -0.18259022 -0.1241625  -0.37541381  1.16900437 -1.10023468
#  -1.44658815 -1.11449782  0.40721953 -0.90503292 -1.28627579 -1.82756835
#  -1.43961739 -0.66794185 -1.9640337  -0.91623396  0.01579011 -0.03464335
#   0.27521781 -0.78740312 -1.03189499 -1.73038951 -1.70432333 -0.88047878
#  -1.63293955 -2.18512682 -2.69158422 -3.29642905 -3.72094185 -3.50118625
#  -4.61673032 -4.43867496 -2.80081447 -2.76314241 -4.09246638 -5.6093016 ]
# R_2
# 1.0000000000000004
# phi
# [ 1.1 -0.2  0.2]
# theta
# [0.3 0.2 0.1]
# se_beta
# [3.526733475186766e-10, 3.718670773606283e-10, 1.7479428215457548e-10, 3.5304111238549773e-10, 1.746122221821107e-10, 1.4576179032287249e-10]
# x_residual
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  7.07850714e-06
#  -1.84118727e-05 -4.96932612e-05  1.18716461e-05 -3.45149134e-06
#   4.65827736e-05  1.32450478e-05 -5.69784772e-06 -4.83891361e-05
#  -1.44751510e-05  5.08497398e-05 -3.52324284e-05  1.16367642e-05
#  -3.19466688e-05  4.71479075e-05  4.69608181e-06  2.38304425e-06
#  -2.82728804e-05  2.06828106e-05 -1.24679889e-05  2.06018725e-06
#  -4.17025513e-05 -7.57017405e-06  2.76334732e-05  3.51475450e-05
#   9.44212707e-07 -5.93816667e-05  4.89211652e-05  3.96426060e-05
#   5.80358517e-06 -2.94243875e-05 -6.02725046e-05  4.26012989e-05
#  -1.31698825e-05  1.08831058e-05 -6.79371946e-06  4.91008551e-05
#  -4.64820912e-05 -2.83401571e-05  5.04359283e-05 -5.28636854e-05
#   2.05063723e-05  9.30135202e-06  1.16044390e-05 -4.99421408e-05
#  -2.21851146e-05  2.55310521e-05 -1.76202885e-05 -3.26287740e-05
#   5.26421105e-07 -3.04370898e-05  2.32499499e-05  2.98514539e-05
#  -2.08165477e-05  5.23228914e-06 -8.29142066e-06  4.84658205e-05
#  -4.48634019e-06 -4.06970031e-05  3.65988431e-05  9.69915780e-06
#   9.85261234e-06  1.96547155e-05  1.73363361e-05  2.57153700e-06
#  -3.05401396e-05  1.45208560e-05 -1.37019611e-05  3.01767995e-05
#   2.68286250e-05 -5.04675319e-05  3.36811815e-05 -8.07250391e-06
#  -1.66324701e-05 -3.36405515e-05  6.25814663e-06  1.63090716e-05
#  -2.76136645e-05  4.89030316e-05 -5.02545686e-05 -4.32614681e-05
#   1.73518778e-05  2.10010653e-05  3.84374669e-05 -5.37038865e-05
#   2.13003387e-05 -1.98064147e-05  2.26983042e-05 -4.32221757e-05
#   2.57885543e-05 -3.18221212e-05 -3.23785397e-07  4.36212759e-05
#   3.58994701e-05 -3.06695927e-05 -1.69359348e-05  2.24804636e-05]
# y_t
# [  1.62434536  -0.61175641  -0.52817175  -1.06196741   0.22235134
#   -1.95349311   0.06139824  -0.41122424  -0.40623355  -0.6993039
#    0.81397429  -1.56746678  -1.92038785  -1.56168838  -0.04962349
#   -1.45487576  -1.86078043  -2.3923877   -1.98072659  -1.21048914
#   -2.54942721  -1.47687092  -0.56287061  -0.69241604  -0.45446928
#   -1.59596536  -1.8715723   -2.58910705  -2.55761851  -1.73176882
#   -2.52837223  -3.08847458  -3.5664135   -4.12321339  -4.47432467
#   -4.16031213  -5.19278259  -4.87600318  -3.09907387  -3.00849309
#   -4.28405284  -5.66087063  -6.2055702   -4.12707152  -4.44331102
#   -5.99715648  -6.03117575  -3.85660223  -4.52706032  -5.04635171
#   -5.28358672  -6.02166065  -7.43392046  -7.62412203  -7.5633008
#   -7.07001295  -6.69592684  -6.54643732  -7.16875479  -7.02780661
#   -8.42484333  -7.60064992  -7.50190897  -8.66891275  -8.77204848
#   -9.19105565  -8.54357146  -7.7403444   -6.74596309  -9.71324556
#  -12.0120102  -12.02969779 -11.43157002 -10.92607879 -11.52087084
#  -14.50608293 -14.96272487 -13.82108157 -14.17568387 -14.55479482
#  -15.79132526 -16.81462056 -17.1928818  -17.43142398 -18.16933812
#  -19.07124851 -20.66428661 -20.98189476 -21.58167932 -21.51269005
#  -21.67047407 -23.18031821 -25.09142083 -26.72701895 -27.00954144
#  -27.91736499 -29.64460666 -30.8562772  -32.62569962 -33.10497916]
# R_2
# 0.9999999999871758
# phi
# [ 1.05000148 -0.19999837  0.19999655]
# theta
# [0.30000549 0.2000049  0.0999975 ]
# se_beta
# [2.330751891026416e-05, 2.5574868559214998e-05, 8.828379847179134e-06, 2.3583773354609526e-05, 1.1762251886041388e-05, 9.797838306742823e-06]

def test_x_residual_streamflow():
    arch = Arch()
    p = 2
    d = 0
    q = 0
    x_residual, y_t, R_2, phi, theta, se_beta = arch.x_residual(y_streamflow_395, e_100, p, d, q)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\x_residual.txt', x_residual)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\y_t.txt', y_t)
    print("R_2")
    print(R_2)
    print("phi")
    print(phi)
    print("theta")
    print(theta)
    print("se_beta")
    print(se_beta)
# y_residual_streamflow_1460  p=2
# R_2
# 0.9207290207522015
# phi
# [ 1.5331421  -0.61353046]
# theta
# []
# se_beta
# [0.02077505901306154, 0.020776326740508087]
# y_residual_streamflow_1460  p=3
# R_2
# 0.9344269048513744
# phi
# [ 1.80161201 -1.28440015  0.43756275]
# theta
# []
# se_beta
# [0.02400366981844562, 0.040984491020285965, 0.024005252043346952]
# y_streamflow_395 p=3
# R_2
# 0.9950663164644005
# phi
# [ 2.40237309 -2.01357576  0.61026411]
# theta
# []
# se_beta
# [0.04991477786357921, 0.09593768871420823, 0.049900263471139426]
# y_streamflow_395 p=2
# R_2
# 0.9933629294169934
# phi
# [ 1.86818005 -0.87194949]
# theta
# []
# se_beta
# [0.027635877526645366, 0.02762854656367414]

def test_LB_statistic():
    y_residual = [0, 0, -0.65798056, 1.20741142, -0.99820696, 2.40876836, -1.85362018, 0.85126399, -0.45792635,
                  0.36726925, -1.61099009, 2.1557183, 0.20889489, 0.51447928, -1.28002155, 1.20188049, 0.04015461,
                  1.00535443, -0.17882309, -0.45951062, 0.93548651, -0.99910244, -1.07769606, -0.39597124, -1.06442015]
    y_residual_42 = [0, 0, 0, 1.07296862, -0.86540763, 2.3015387, -1.74481176, 0.7612069, -0.3190391, 0.24937038,
                     -1.46210794, 2.06014071, 0.3224172, 0.38405435, -1.13376944, 1.09989127, 0.17242821, 0.87785842,
                     -0.04221375, -0.58281521, 1.10061918, -1.14472371, -0.90159072, -0.50249434, -0.90085595,
                     0.68372786, 0.12289023, 0.93576943, 0.26788808, -0.53035547, 0.69166075, 0.39675353, 0.6871727,
                     0.84520564, 0.67124613, 0.0126646, 1.11731035, -0.2344157, -1.65980218, -0.74204416, 0.19183555,
                     0.88762896]
    e_42 = [1.62434536, -0.61175641, -0.52817175, -1.07296862, 0.86540763, -2.3015387, 1.74481176, -0.7612069,
            0.3190391, -0.24937038, 1.46210794, -2.06014071, -0.3224172, -0.38405435, 1.13376944, -1.09989127,
            -0.17242821, -0.87785842, 0.04221375, 0.58281521, -1.10061918, 1.14472371, 0.90159072, 0.50249434,
            0.90085595, -0.68372786, -0.12289023, -0.93576943, -0.26788808, 0.53035547, -0.69166075, -0.39675353,
            -0.6871727, -0.84520564, -0.67124613, -0.0126646, -1.11731035, 0.2344157, 1.65980218, 0.74204416,
            -0.19183555, -0.88762896]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_arma_3_residual = [0.00E+00, 0.00E+00, 0.00E+00, 4.14E-11, 1.57E-10, 7.87E-10, -1.78E-10, -2.27E-10, 5.21E-10,
                         -1.11E-10, -1.12E-10, 4.91E-10, -1.62E-10, 2.20E-10, -3.22E-10, 2.88E-10, 1.71E-10, 4.63E-12,
                         6.25E-10, -1.06E-10, 8.88E-12, 2.76E-10, 1.99E-11, -5.23E-10, 3.20E-10, 1.27E-10, 3.14E-10,
                         -5.37E-10, 8.56E-10, -4.94E-10, 4.74E-10, -3.66E-10, 5.78E-10, -5.54E-10, 3.70E-10, 1.01E-10,
                         3.07E-11, -3.62E-10, -1.22E-10, -1.31E-10, -2.18E-10, 2.73E-10]
    y_residual_42_p1d2 = [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                          0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]
    y_residual_arima_p1d2q1 = [0.0000, 0.0000, 0.0000, 0.7940, -0.5147, 1.7256, -1.1323, -0.0021, -0.0347, -0.2101,
                               -1.2868, 1.3571, 0.8835, 0.0612, -0.9298, 0.4668, 0.5289, 0.5231, 0.2670, -0.9833,
                               1.0986, -1.3018, -1.0233, -1.0861, -0.8858, 0.1003, 0.3907, 0.5704, 0.5894, -0.8648,
                               0.7008, 0.1526, 0.8938, 0.6001, 0.9735, -0.2358, 1.2422, -0.3879, -1.5876, -1.4872,
                               0.1559, 0.5370]
    arch = Arch()
    m = 1
    LB, acf = arch.LB_statistic(e, m)
    print("LB")
    print(LB)
    print("acf")
    print(acf)
# LB
# 27.829265039808767
# acf
# [-0.28481598529511254, 0.18435464616999242, -0.2735880527973914, 0.19595639700086842, -0.3141998549392499,
#  0.15981852447176298, -0.20192173274245087, 0.11507419162945515, -0.0962735984624025, 0.1350466929485835,
#  -0.2528406547808198, -0.049099378738369524, -0.05686051624781958, 0.08785513043231927, 0.12662767453208082,
#  0.09301925304520033, -0.014631827266700313, -0.03579969070491006]
# LB
# 3.6563421669841074
# acf
# [-0.28481598529511254]

def test_get_chi_critical():
    arch = Arch()
    m = 1
    p = 0.05
    chi_critical = arch.get_chi_critical(m, p)
    print("chi_critical")
    print(chi_critical)
# chi_critical
# 9.39
# chi_critical
# 0.004

def test_test_arima():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual_42 = [0, 0, 0, 1.07296862, -0.86540763, 2.3015387, -1.74481176, 0.7612069, -0.3190391, 0.24937038,
                     -1.46210794, 2.06014071, 0.3224172, 0.38405435, -1.13376944, 1.09989127, 0.17242821, 0.87785842,
                     -0.04221375, -0.58281521, 1.10061918, -1.14472371, -0.90159072, -0.50249434, -0.90085595,
                     0.68372786, 0.12289023, 0.93576943, 0.26788808, -0.53035547, 0.69166075, 0.39675353, 0.6871727,
                     0.84520564, 0.67124613, 0.0126646, 1.11731035, -0.2344157, -1.65980218, -0.74204416, 0.19183555,
                     0.88762896]
    y_arma_3_residual = [0.00E+00, 0.00E+00, 0.00E+00, 4.14E-11, 1.57E-10, 7.87E-10, -1.78E-10, -2.27E-10, 5.21E-10,
                         -1.11E-10, -1.12E-10, 4.91E-10, -1.62E-10, 2.20E-10, -3.22E-10, 2.88E-10, 1.71E-10, 4.63E-12,
                         6.25E-10, -1.06E-10, 8.88E-12, 2.76E-10, 1.99E-11, -5.23E-10, 3.20E-10, 1.27E-10, 3.14E-10,
                         -5.37E-10, 8.56E-10, -4.94E-10, 4.74E-10, -3.66E-10, 5.78E-10, -5.54E-10, 3.70E-10, 1.01E-10,
                         3.07E-11, -3.62E-10, -1.22E-10, -1.31E-10, -2.18E-10, 2.73E-10]
    y_residual_arima_p1d2q1 = [0.0000, 0.0000, 0.0000, 0.7940, -0.5147, 1.7256, -1.1323, -0.0021, -0.0347, -0.2101,
                               -1.2868, 1.3571, 0.8835, 0.0612, -0.9298, 0.4668, 0.5289, 0.5231, 0.2670, -0.9833,
                               1.0986, -1.3018, -1.0233, -1.0861, -0.8858, 0.1003, 0.3907, 0.5704, 0.5894, -0.8648,
                               0.7008, 0.1526, 0.8938, 0.6001, 0.9735, -0.2358, 1.2422, -0.3879, -1.5876, -1.4872,
                               0.1559, 0.5370]
    y_residual_arma_3_p3d0q3 = [0.00E+00, 0.00E+00, 0.00E+00, 4.14E-11, 1.57E-10, 7.87E-10, -1.78E-10, -2.27E-10,
                                5.21E-10, -1.11E-10, -1.12E-10, 4.91E-10, -1.62E-10, 2.20E-10, -3.22E-10, 2.88E-10,
                                1.71E-10, 4.63E-12, 6.25E-10, -1.06E-10, 8.88E-12, 2.76E-10, 1.99E-11, -5.23E-10,
                                3.20E-10, 1.27E-10, 3.14E-10, -5.37E-10, 8.56E-10, -4.94E-10, 4.74E-10, -3.66E-10,
                                5.78E-10, -5.54E-10, 3.70E-10, 1.01E-10, 3.07E-11, -3.62E-10, -1.22E-10, -1.31E-10,
                                -2.18E-10, 2.73E-10]
    arch = Arch()
    m = 6
    p = 0.05
    b_significant = arch.test_arima(y_residual_streamflow_1460, m, p)
    print("b_significant")
    print(b_significant)
# b_significant
# False
# b_significant  m=1
# True
# b_significant  m=2
# False
# b_significant  m=6 y_residual_arima_p1d2q1
# True
# b_significant  y_residual_arma_3_p3d0q3
# False
# b_significant e_1000
# True
# b_significant  y_residual_arma_3_p3d0q3_100 m=6
# False
# b_significant  e_42 m=6
# False
# b_significant  y_residual_streamflow_1460 m=6  p=3
# False

def test_t_statistic():
    y_residual = [0,  0,  -7.00148942,  2.81307703,  -0.86616938,  2.35613508,  -1.19714684,  0.4232423,  -0.4589695,
                  0.54786256,  -1.83051924,  1.84837348,  0.76232344,  0.96888897,  -1.44205859,  1.03469247,
                  0.18368458,  1.3957388,  -0.13007158]
    y_residual_42_p1d2 = [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                          0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]
    y_residual_arima_p1d2q1 = [0.0000, 0.0000, 0.0000, 0.7940, -0.5147, 1.7256, -1.1323, -0.0021, -0.0347, -0.2101,
                               -1.2868, 1.3571, 0.8835, 0.0612, -0.9298, 0.4668, 0.5289, 0.5231, 0.2670, -0.9833,
                               1.0986, -1.3018, -1.0233, -1.0861, -0.8858, 0.1003, 0.3907, 0.5704, 0.5894, -0.8648,
                               0.7008, 0.1526, 0.8938, 0.6001, 0.9735, -0.2358, 1.2422, -0.3879, -1.5876, -1.4872,
                               0.1559, 0.5370]
    y_residual_arma_3_p3d0q3 = [0.00E+00, 0.00E+00, 0.00E+00, 4.14E-11, 1.57E-10, 7.87E-10, -1.78E-10, -2.27E-10,
                                5.21E-10, -1.11E-10, -1.12E-10, 4.91E-10, -1.62E-10, 2.20E-10, -3.22E-10, 2.88E-10,
                                1.71E-10, 4.63E-12, 6.25E-10, -1.06E-10, 8.88E-12, 2.76E-10, 1.99E-11, -5.23E-10,
                                3.20E-10, 1.27E-10, 3.14E-10, -5.37E-10, 8.56E-10, -4.94E-10, 4.74E-10, -3.66E-10,
                                5.78E-10, -5.54E-10, 3.70E-10, 1.01E-10, 3.07E-11, -3.62E-10, -1.22E-10, -1.31E-10,
                                -2.18E-10, 2.73E-10]
    arch = Arch()
    phi = [1.1, -0.2, 0.2]
    theta = [0.3, 0.2, 0.1]
    se_beta = [3.526733475186766e-10, 3.718670773606283e-10, 1.7479428215457548e-10, 3.5304111238549773e-10, 1.746122221821107e-10, 1.4576179032287249e-10]
    t_statistic = arch.t_statistic(y_residual_arma_3_p3d0q3, phi, theta, se_beta)
    print("t_statistic")
    print(t_statistic)
# t_statistic
# [-57.54816672  -1.3860782 ]
# t_statistic
# [ 3.11903354e+09 -5.37826584e+08  1.14420219e+09  8.49759389e+08
#   1.14539519e+09  6.86050849e+08]

def test_get_t_critical():
    arch = Arch()
    m = 18
    p = 0.05
    t_critical = arch.get_t_critical(42-m, p)
    print("t_critical")
    print(t_critical)
# t_critical
# 1.711

def test_test_parameters():
    y_residual_arima_p1d2q1 = [0.0000, 0.0000, 0.0000, 0.7940, -0.5147, 1.7256, -1.1323, -0.0021, -0.0347, -0.2101,
                               -1.2868, 1.3571, 0.8835, 0.0612, -0.9298, 0.4668, 0.5289, 0.5231, 0.2670, -0.9833,
                               1.0986, -1.3018, -1.0233, -1.0861, -0.8858, 0.1003, 0.3907, 0.5704, 0.5894, -0.8648,
                               0.7008, 0.1526, 0.8938, 0.6001, 0.9735, -0.2358, 1.2422, -0.3879, -1.5876, -1.4872,
                               0.1559, 0.5370]
    y_residual_arma_3_p3d0q3 = [0.00E+00, 0.00E+00, 0.00E+00, 4.14E-11, 1.57E-10, 7.87E-10, -1.78E-10, -2.27E-10,
                                5.21E-10, -1.11E-10, -1.12E-10, 4.91E-10, -1.62E-10, 2.20E-10, -3.22E-10, 2.88E-10,
                                1.71E-10, 4.63E-12, 6.25E-10, -1.06E-10, 8.88E-12, 2.76E-10, 1.99E-11, -5.23E-10,
                                3.20E-10, 1.27E-10, 3.14E-10, -5.37E-10, 8.56E-10, -4.94E-10, 4.74E-10, -3.66E-10,
                                5.78E-10, -5.54E-10, 3.70E-10, 1.01E-10, 3.07E-11, -3.62E-10, -1.22E-10, -1.31E-10,
                                -2.18E-10, 2.73E-10]
    arch = Arch()
    # phi = [1.1, -0.2, 0.2]
    # theta = [0.3, 0.2, 0.1]
    # se_beta = [3.526733475186766e-10, 3.718670773606283e-10, 1.7479428215457548e-10, 3.5304111238549773e-10, 1.746122221821107e-10, 1.4576179032287249e-10]
    # phi = [1.05000148, -0.19999837, 0.19999655]
    # theta = [0.30000549, 0.2000049, 0.0999975 ]
    # se_beta = [2.330751891026416e-05, 2.5574868559214998e-05, 8.828379847179134e-06, 2.3583773354609526e-05, 1.1762251886041388e-05, 9.797838306742823e-06]
    # phi = [1.86818005, -0.87194949]
    # theta = []
    # se_beta = [0.027635877526645366, 0.02762854656367414]
    phi = [1.80161201, -1.28440015, 0.43756275]
    theta = []
    se_beta = [0.02400366981844562, 0.040984491020285965, 0.024005252043346952]
    m = 6
    significance_level = 0.05
    b_significant = arch.test_parameters(y_residual_streamflow_1460, phi, theta, se_beta, m, significance_level)
    print("b_significant")
    print(b_significant)
# b_significant  m=6
# [True, False]
# b_significant  m=12
# [True, False]
# b_significant  m=18
# [True, False]
# b_significant  m=6 y_residual_arma_3_p3d0q3
# [True, True, True, True, True, True]
# b_significant  m=6 y_residual_arma_3_p3d0q3_100
# [True, True, True, True, True, True]
# b_significant  m=6 y_residual_streamflow_395
# [True, True]
# b_significant  m=6 y_residual_streamflow_1460
# [True, True, True]

def test_arma_one_step():
    arch = Arch()
    x = [54.3, 53.2, 52.1, 50.9, 50.4, 50.4, 50.4, 50.4, 50.0, 49.3]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    phi = [1.80161201, -1.28440015, 0.43756275]
    theta = [0.5]
    p=3
    x_ = x[-p:]
    x_.reverse()
    x_infer = arch.arma_one_step(x=x_, phi=phi)
    print("x_infer")
    print(x_infer)
# x_infer
# 46.652627192999994

def test_reverse_integrate_one_degree_one_step():
    arch = Arch()
    x_infer_t = 0.0
    x_t_ = -0.6
    x_infer = arch.reverse_integrate_one_degree_one_step(x_infer_t, x_t_)
    print("x_infer")
    print(x_infer)
# x_infer
# -0.6

def test_reverse_integrate_d_degree_one_step():
    arch = Arch()
    d = 3
    x_infer_t = 0.1
    x_t_ = [97.0, 96.5, 95.9]
    x_infer = arch.reverse_integrate_d_degree_one_step(d, x_infer_t, x_t_)
    print("x_infer")
    print(x_infer)
# x_infer
# 95.30000000000001

def test_arima_infer():
    arch = Arch()
    x = [54.3, 53.2, 52.1, 50.9, 50.4, 50.4, 50.4, 50.4, 50.0, 49.3 ]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    phi = [1.80161201, -1.28440015, 0.43756275]
    theta = [0.5]
    t = 10
    p=3
    d=0
    q=0
    x_infer = arch.arima_infer(t=t, x=x, phi=phi, p=p, d=d)
    print("x_infer")
    print(x_infer)
# x_infer
# [46.652627192999994, 42.60714355396138, 38.41274374902763, 34.89369075281492, 32.17085740345077, 29.94992722295506,
#  27.906073792332272, 25.884995513871274, 23.897125949780055, 22.017315385116646]

def test_LM_statistic():
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    q = 3
    y_residual_2 = np.power(y_residual, 2)
    y_residual_2 = y_residual_2.tolist()
    a, R_2 = arch.ar_least_squares_estimation(y_residual_2_streamflow_395, q)
    residual_2_fit = arch.arma(y_residual_2_streamflow_395, e=None, phi=a, theta=None, p=q, q=0)  # ar model
    e = y_residual_2_streamflow_395 - residual_2_fit
    e_2 = np.power(e, 2)
    LM = arch.LM_statistic(y_residual_2_streamflow_395, q, e_2)
    print("LM")
    print(LM)
# LM
# 0.6707065303253715
# LM
# -129.27344400589584

def test_F_statistic():
    arch = Arch()
    R_2 = 0.025185118907720204
    k = 3
    n = 1460
    F_statistic = arch.F_statistic(R_2, k, n)
    print("F_statistic")
    print(F_statistic)
# F_statistic
# 12.538973241959683

def test_BPtest_LM_statistic():
    arch = Arch()
    R_2 = 0.025185118907720204
    n = 1460
    BPtest_LM_statistic = arch.BPtest_LM_statistic(R_2, n)
    print("BPtest_LM_statistic")
    print(BPtest_LM_statistic)
# BPtest_LM_statistic
# 36.7702736052715

def test_get_F_critical():
    arch = Arch()
    fd_n = 110
    fd_d = 45
    significance_level = 0.05
    F_critical = arch.get_F_critical(fd_n, fd_d, significance_level)
    print("F_critical")
    print(F_critical)
# F_critical (50, 0.05, 2)
# 3.18
# F_critical (110, 0.05, 2)
# 3.082
# F_critical (100, 0.05, 45)
# 1.495
# F_critical (110, 0.05, 45)
# 1.4849999999999999

def test_arch_test():
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    q = 3
    significance_level = 0.05
    b_arch_Q, b_arch_LM, b_arch_F, b_arch_bpLM = arch.arch_test(y_residual_streamflow_395, q, significance_level)
    print("b_arch_Q")
    print(b_arch_Q)
    print("b_arch_LM")
    print(b_arch_LM)
    print("b_arch_F")
    print(b_arch_F)
    print("b_arch_bpLM")
    print(b_arch_bpLM)
# b_arch_Q, b_arch_LM
# (True, True)
# b_arch_Q, b_arch_LM  q=2  y_residual_streamflow_395
# (True, False)
# b_arch_Q, b_arch_LM  q=3  y_residual_streamflow_395
# (True, False)
# b_arch_Q, b_arch_LM  q=6  y_residual_streamflow_395
# (True, False)
# b_arch_Q, b_arch_LM  q=3  y_residual_streamflow_1460
# (True, False)
# b_arch_Q, b_arch_LM  q=6  y_residual_streamflow_1460
# (True, False)
# b_arch_Q, b_arch_LM, b_arch_bpLM  q=3  y_residual_streamflow_1460
# (True, False, True)
# b_arch_Q, b_arch_LM, b_arch_F, b_arch_bpLM  q=3  y_residual_streamflow_395
# (True, False, True, True)
# b_arch_Q, b_arch_LM, b_arch_F, b_arch_bpLM  q=3  y_residual_streamflow_1460
# (True, False, True, True)

def test_delta_2_one_step():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    q = 3
    # y_residual_2 = np.power(y_residual, 2)
    # y_residual_2_ = y_residual_2[2:2+q]
    y_residual_2_streamflow_395_ = y_residual_2_streamflow_395[3:3+q]
    y_residual_2_streamflow_395_.append(1)
    y_residual_2_streamflow_395_.reverse()
    alpha = [35.10725569, 0.86070866, -0.50716606,  0.41552226]
    delta_2_i = arch.delta_2_one_step(y_residual_2_streamflow_395_, alpha,)
    print("delta_2_i")
    print(delta_2_i)
# delta_2_i
# 35.967493821477845

def test_epsilon_2():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    y_residual_2 = np.power(y_residual, 2)
    y_residual_2 = y_residual_2.tolist()
    alpha = [35.10725569, 0.86070866, -0.50716606,  0.41552226]  # omega
    q = 3
    epsilon_2 = arch.epsilon_2(y_residual_2_streamflow_395, alpha, q)
    print("epsilon_2")
    print(epsilon_2)
# epsilon_2
# [ 0.00000000e+00  0.00000000e+00  1.39448247e+00  3.67809737e+01
#   3.56196324e+01  3.53651817e+01  3.59674938e+01  3.51383442e+01
#   3.53642220e+01  3.52589476e+01  3.51263958e+01  3.67725101e+01
#   3.56316565e+01  3.53422045e+01  3.59274909e+01  3.53800474e+01
#   3.53800474e+01  3.53800474e+01  3.54190326e+01  3.63003622e+01

def test_arch_least_squares_estimation():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    e_ = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    y_residual_2 = np.power(y_residual, 2)
    y_residual_2 = y_residual_2.tolist()
    q = 1
    e_2 = np.power(e_395, 2)
    a, R_2, delta_2 = arch.arch_ordinary_least_squares_estimation(y_residual_2_streamflow_1460, q)
    print("a")
    print(a)
    print("R_2")
    print(R_2)
    print("delta_2")
    print(delta_2)
# a y_residual_2_streamflow_395  q=3
# [35.10725569  0.86070866 -0.50716606  0.41552226]
# R_2
# 0.2360206703534833
# delta_2
# 0.0014069025302231941
# a y_residual_2_streamflow_1460  q=3
# [1.33278024e+04 1.25569344e-01 6.10891224e-02 4.37201780e-02]
# R_2
# 0.025185118907720204
# delta_2
# 2.0724485863696087e-10
# a  y_residual_2_streamflow_395  q=1
# [41.6261723   0.67115674]
# R_2
# 0.1912180277043999
# delta_2
# -2.3142358823738634e-15
# a
# [1.49127499e+04 1.37672850e-01]
# R_2
# 0.018953813664857603
# delta_2
# 9.581507969295046e-12

def test_Omega_i():
    arch = Arch()
    theta = [41.6261723, 0.67115674]
    Zi = [1, y_residual_2_streamflow_395[2]]
    sigma_n4 = arch.Omega_i(Zi, theta)
    print("sigma_n4")
    print(sigma_n4)
# sigma_n4  y_residual_2_streamflow_395[1]
# 0.0005771212224997373
# sigma_n4  y_residual_2_streamflow_395[2]
# 0.0005425654055262422

def test_Omega():
    arch = Arch()
    # theta = [41.6261723, 0.67115674]
    theta = [1.49127499e+04, 1.37672850e-01]
    Omega = arch.Omega(y_residual_2_streamflow_1460, theta)
    print("Omega")
    print(Omega)
# Omega
# y_streamflow_395_Omege
# Omega
# y_streamflow_1460_Omege

def test_arch_feasible_generalized_least_squares_estimation():
    arch = Arch()
    q = 3
    a, R_2, y = arch.arch_feasible_generalized_least_squares_estimation(y_residual_2_streamflow_1460, q, y_streamflow_1460_Omege, b_y=True)
    print("a")
    print(a)
    print("R_2")
    print(R_2)
    print("y")
    print(y)
# a  y_residual_2_streamflow_395 q=3
# [ 2.18960415  0.02024819 -0.0022809   0.01220647]
# R_2
# 0.20152472141990246
# a  y_residual_2_streamflow_1460  q=3
# [6.71658575e+02 2.37001714e-02 3.90087440e-02 3.41720975e-02]
# R_2
# 0.01887150094068471
# y
# [671.65857542 672.93963109 674.96591371 ... 672.13081132 672.10939714
#  672.09004761]

def test_arch_constrained_ordinary_least_squares():
    arch = Arch()
    q = 3
    q_n = 2  # [ 2.18960415  0.02024819 -0.0022809   0.01220647]  the second parameter is negative.
    a, R_2, y = arch.arch_constrained_ordinary_least_squares(y_residual_2_streamflow_395, q, y_streamflow_395_Omege, q_n=q_n, b_y=True)
    print("a")
    print(a)
    print("R_2")
    print(R_2)
    print("y")
    print(y)
# a  ordinary_least_squares()  y_residual_2_streamflow_395 q=3
# [34.83797803  0.60908538  0.          0.16389898]
# R_2
# 0.20090092667479065
# a  generalized_least_squares()  y_residual_2_streamflow_395 q=3
# [2.18518342 0.01851308 0.         0.01112357]
# R_2
# 0.19271578808251524
# y
# [ 2.22118361  2.21741703  2.21397555  2.2117124   2.19091757  2.19239949
#   2.19033171  2.18846598  2.22241079  2.21706141  2.21256996  2.21035082
#   2.19569571  2.19569571  2.19569571  2.19653425  2.21598497  2.22295954
#   2.20162036  2.20544928  2.20391528  2.20408218  2.19932367  2.19725654
#   2.20508797  2.20324544  2.19980071  2.1994525   2.18746817  2.18756414
#   2.18634566  2.1887041   2.19341834  2.19832423  2.19303244  2.19512414
#   2.19674994  2.19514412  2.1952471   2.19429287  2.18838946  2.18886559

def test_initial_values():
    arch = Arch()
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    beta = [2.18518342, 0.01851308, 0., 0.01112357]
    ini_values = arch.initial_values(alpha, beta)
    print("ini_values")
    print(ini_values)
# ini_values
# -5933641468865  # todo:1.75
# ini_values  omega
# 2.18518342

def test_conditional_quasi_likelihood():
    arch = Arch()
    p = 2
    q = 3
    residual_2 = y_residual_2_streamflow_395[1:1+q]
    delta_2 = [1, 1,1, 1,2]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    beta = [2.18518342, 0.01851308, 0., 0.01112357]
    delta_2 = arch.conditional_quasi_likelihood(residual_2, delta_2, q, alpha, beta)
    print("delta_2")
    print(delta_2)

def test_arma_garch():
    arch = Arch()
    P = 3
    Q = 2
    p = 2
    q = 3
    residual_2 = y_residual_2_streamflow_395[1:1+q]
    delta_2 = [1, 1,1, 1,2]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    beta = [2.18518342, 0.01851308, 0., 0.01112357]
    h, e, xx = arch.arma_garch(residual_2, delta_2, P, Q, p, q, alpha, beta)
    print("h")
    print(h)
    print("e")
    print(e)
    print("xx")
    print(xx)

def test_asymptotic_variance_a0_alpha0():
    arch = Arch()
    a = 1
    alpha = 2
    variance = arch.asymptotic_variance_a0_alpha0(a, alpha)
    print("variance")
    print(variance)


def test_likelihood_equations():
    arch = Arch()
    p = 2
    q = 3
    residual_2 = y_residual_2_streamflow_395[1:1+q]
    delta_2 = [1, 1,1, 1,2]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    beta = [2.18518342, 0.01851308, 0., 0.01112357]
    eta_2 = [2.18518342, 0.01851308, 0., 0.01112357]
    l = arch.likelihood_equations(residual_2, delta_2, eta_2)
    print("l")
    print(l)

def test_arch_asymptotic_variance():
    arch = Arch()
    p = 2
    q = 3
    residual_2 = y_residual_2_streamflow_395[1:1+q]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    beta = [2.18518342, 0.01851308, 0., 0.01112357]
    eta_2 = [2.18518342, 0.01851308, 0., 0.01112357]
    average_f = arch.arch_asymptotic_variance(residual_2, alpha)
    print("average_f")
    print(average_f)

def test_delta_2():
    arch = Arch()
    residual_2 = y_residual_2_streamflow_395
    # residual_2 = y_residual_2_streamflow_395_1
    alpha0 = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha1 = [9.30971232e+01, 9.49159600e+01, 0.00000000e+00, 9.46274455e+02]
    alpha2 = [35.19315819, 0.9220255,  0., 3.8679039]
    alpha3 = [35.40975055, 1.11804071, 0., 3.56875317]
    alpha4 = [42.2744951, 28.59260134, 0., 420.75117497]
    alpha5 = [46.11069133, 21.70821798, 0., 106.6395288]
    alpha4_ = [2.30286748e+03, 1.48993133e+03, 0.00000000e+00, 7.35790267e+03]
    alpha4_ = [3.17251096e+03, 2.18526687e+03, 0.00000000e+00, 8.75038684e+03]
    alpha4_ = [2.00659474e+03, 1.42036877e+03, 0.00000000e+00, 2.10256674e+04]
    alpha4_ = [1.37244233e+03, 1.82313809e+03, 0.00000000e+00, 1.34555206e+04]
    alpha4_ = [35.19315819, 0.9220255, 0., 3.8679039]
    alpha4_ = [4.81614767e+03, 1.59475061e+03, 0.00000000e+00, 4.92331438e+04]
    alpha4_ = [256.76405645, 257.17492165, 256.21983995, 256.45970337]
    alpha_395_1 = [35.40808393, 1.1411455, 0.22434246, 4.09766646]
    alpha_395_2 = [68.35686024, 66.15518812, 66.16172623, 66.19459768]
    alpha_395_2 = [24.88502542, 22.72549769, 22.69956968, 22.6979746]
    alpha_395_2 = [12.82059331, 10.67330381, 10.63789087, 10.6258312]
    alpha_395_2 = [34.54383114, 0.25392635, 0., 2.69992071]
    alpha_395_2 = [34.51688396, 0.24714697, 0., 3.18938236]
    alpha_395_2 = [31, 0.15392635, 0., 1.69992071]
    alpha_395_2 = [28, 0.15392635, 0., 1.1]
    alpha_395_2 = [2, 1]
    alpha_395_2 = [25, 0.1, 0., 0.95]
    alpha_395_2 = [27.52040446, 0.25392635, 0.0, 0.9377970799999997]
    alpha_395_2 = [27.522109401732685, 0.25392635, 0.0, 0.9382139505572842]
    alpha_395_2 = [27.522109401732685, 0.25392635, 0.0, 0.4399943968985215]
    alpha_395_2 = [1.24844341, 0.24797631, 0., 0.80837988]
    alpha_395_2 = [6.68332411, 0.04860733, 0., 1.17182912]
    alpha_395_2 = [3.1894915, 2.21839188, 1.94194313, 2.72129519]
    alpha_395_2 = [9.57176198, 0.24797631, 0.0, 9.13934837]
    alpha_395_2 = [27.27562994, 0.59387741, 0., 0.47085832]
    delta_2 = arch.delta_2(residual_2, alpha_395_2)
    residual_2 = y_residual_2_streamflow_1460
    alpha = [6.71921606e+02, 1.62963230e+04, 3.34895884e+02, 3.69703420e+01]
    alpha = [6.85822878e+02, 1.73127878e+03, 5.06418697e+02, 3.99362576e+02]
    alpha = [6.98690405e+02, 2.76598574e+01, 2.82575788e+01, 2.89027965e+01]
    # delta_2 = arch.delta_2(residual_2, alpha)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\delta_2.txt', delta_2)
    # print("delta_2")
    # print(delta_2)

def test_log_likelihood_gauss_vt():
    arch = Arch()
    residual_2 = y_residual_2_streamflow_395
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha = [1.24844341, 0.24797631, 0., 0.80837988]
    alpha = [6.68332411, 0.04860733, 0., 1.17182912]
    alpha = [27.53412208, 0.26761428, 0., 0.45247333]
    alpha = [9.57176198, 0.24797631, 0., 9.13934837]
    alpha = [27.27562994, 0.59387741, 0., 0.47085832]
    L_theta = arch.log_likelihood_gauss_vt(residual_2, alpha)
    print("L_theta")
    print(L_theta)
# L_theta_bc
# 3366.3309763442985
# L_theta_bc
# 3366.3309763442985
# L_theta
# -3729.311696960144
# L_theta
# -3166.8616991943304
# L_theta   alpha = [6.68332411, 0.04860733, 0., 1.17182912]
# -1601.7054566091706
# L_theta   alpha = [27.53412208, 0.26761428, 0., 0.45247333]
# -1309.8630227142996
# L_theta    alpha = [9.57176198, 0.24797631, 0., 9.13934837]
# -1351.3885224262633

def test_distance_theta_0_1():
    arch = Arch()
    theta0 = [2.18518342, 0.01851308, 0., 0.01112357]
    theta1 = [34.83797803, 0.60908538, 0., 0.16389898]
    gradient = [-30052.930200781702, -30781.481516442, -1146.8238021734578, -14832.662553089904, -6339.343972740608, -17149.872735899407]
    distance = arch.distance_theta_0_1(gradient)
    print("distance")
    print(distance)
# distance  theta0 theta1
# 1066.577111810273
# distance  gradient
# 2406306718.109453

def test_gradient_theta():
    arch = Arch()
    lambd = 0.8
    theta0 = [2.18518342, 0.01851308, 0., 0.01112357]
    theta1 = [34.83797803, 0.60908538, 0., 0.16389898]
    grad = arch.gradient_theta(lambd, theta0, theta1)
    print("grad")
    print(grad)
# grad
# [-52.24447138  -0.94491568  -0.          -0.24444066]

def test_x_residual_via_parameters():
    arch = Arch()
    x = y_streamflow_395
    phi = [1.86818005, -0.87194949]
    phi = [103.06400015, 101.64626596]
    x_residual = arch.x_residual_via_parameters(x, phi)
    print("x_residual")
    print(x_residual)
    # print("y_t")
    # print(y_t)
# x_residual
# [ 0.00000000e+00  0.00000000e+00  1.39448223e+00  1.31951719e+00
# y_t
# [167.6        165.8        163.60551777 163.68048281 164.3780424

def test_gradient_thetai():
    arch = Arch()
    x = y_streamflow_395
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    theta = phi + alpha
    d_theta = 0.000001
    i_theta = 3
    grad = arch.gradient_thetai(x, theta, d_theta, i_theta, p, q)
    print("grad")
    print(grad)
# grad   d_theta=0.000001  i_theta=0
# 30052.930200326955
# grad
# 14832.662553089904

def test_gradient():
    arch = Arch()
    x = y_streamflow_395
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha1 = [9.30971232e+01, 9.49159600e+01, 0.00000000e+00, 9.46274455e+02]
    alpha2 = [35.19315819, 0.9220255,  0., 3.8679039]
    alpha3 = [35.40975055, 1.11804071, 0., 3.56875317]
    alpha4 = [2.18518342, 0.1851308, 0., 0.1112357]
    alpha4_ = [42.2744951, 28.59260134, 0., 420.75117497]
    alpha4_ = [6.49175070e-03, 3.02082401e-02, 0.00000000e+00, 9.81992982e-01]
    alpha4_ = [6.49175070e+01, 3.02082401e+02, 0.00000000e+00, 9.81992982e+03]
    alpha5 = [35.27874373, 1.03865214, 0., 4.72882228]
    alpha3_ = [35.50123889, 1.23349839, 0., 4.49514331]
    theta = phi + alpha4_
    d_theta = 0.000001
    i_theta = [2, 3, 5]
    grad = arch.gradient(x, theta, d_theta, p, q, i_theta)
    print("grad")
    print(grad)
# grad   alpha4
# [0, 0, 867.7843084115011, 380.4215930358623, 0, 1610.3814296002383]
# grad   alpha4_
# [0, 0, -0.9318364391219802, -1.0781370747281471, 0, -0.26700718080974184]
# grad  alpha5
# [0, 0, -0.9173791113425978, -9.91096476354869, 0, -3.671990498332889]
# grad  alpha3_
# [0, 0, -0.8961903859017184, -9.683588586995029, 0, -3.777280880967737]
# grad  alpha4_ = [6.49175070e-03, 3.02082401e-02, 0.00000000e+00, 9.81992982e-01]
# [0. 0. 67986.07189103 25468.47745907 0. 6237.62756641]
# grad  alpha4_ = [6.49175070e+01, 3.02082401e+02, 0.00000000e+00, 9.81992982e+03]
# [ 0.          0.         -0.12391547 -0.10186704  0.         -0.01593025]

def test_gradient_module():
    arch = Arch()
    grad0 = [0, 0, 1146.8238021734578, 14832.662553089904, 0, 17149.872735899407]
    grad1 = [0, 0, -0.40426266423310153, -0.39192309486679733, 0, -0.12180657904536929]
    grad2 = [0, 0, -0.8498277566104662, -10.047750492958585, 0, -4.117954404136981]
    grad3 = [0, 0, -0.821793264549342, -9.939450137608219, 0, -4.3086290588689735]
    grad4 = [0, 0, -0.9318364391219802, -1.0781370747281471, 0, -0.26700718080974184]
    module = arch.gradient_module(grad4)
    print("module")
    print(module)
# module  grad0
# 22703.330550926068
# module   grad1
# 0.5760805991192116
# module   grad2
# 10.892063425228766
# module   grad3
# 10.864267005858649
# module   grad4
# 1.4498246569095397

def test_grid_search():
    arch = Arch()
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha4 = [2.18518342, 0.1851308, 0., 0.1112357]
    theta = phi + alpha4
    grad = [0, 0, 1146.8238021734578, 14832.662553089904, 0, 17149.872735899407]
    grad4 = [0, 0, 867.7843084115011, 380.4215930358623, 0, 1610.3814296002383]
    d_theta = 0.000001
    p = 2
    q = 3
    theta1, likelihood_theta_1_0, L_theta = arch.grid_search(y_residual_2_streamflow_395, theta, grad4, d_theta, p)
    print("theta1")
    print(theta1)
    print("likelihood_theta_1_0")
    print(likelihood_theta_1_0)
    print("L_theta")
    print(L_theta)
# theta1  alpha
# [-1876.4399575  -1924.71454427   -69.49130422  -927.02289649  -396.2089983  -1071.85592242]
# theta1
# [ 1.86818005 -0.87194949  2.2035326   0.25583568  0.          0.28552153]
# likelihood_theta_1_0
# 976.0210089674238
# L_theta
# -2753.2906879927204
# theta1  alpha4
# [ 1.86818005 -0.87194949  2.2035326   0.4224534   0.          0.38563366]
# likelihood_theta_1_0
# 329.8449981934873
# L_theta
# -2655.687445100867
# theta1  alpha4
# [ 1.86818005 -0.87194949  2.19906797  0.19121755  0.          0.1370018 ]
# likelihood_theta_1_0
# 52.501197072047034
# L_theta
# -2933.0312462223073

def test_grid_search_single_parameter():
    arch = Arch()
    residual_2 = y_residual_2_streamflow_395
    phi = [1.86818005, -0.87194949]
    alpha = [34.54383114, 0.25392635, 0., 2.69992071]
    theta = phi + alpha
    gradient = [0., 0., -3.51171334, -3.5041112, -3.51313309, -3.52424726]
    p = 2
    q = 3
    theta1, likelihood_theta_1_0, L_theta = arch.grid_search_single_parameter(residual_2, theta, gradient, p, q)
    print("theta1")
    print(theta1)
    print("likelihood_theta_1_0")
    print(likelihood_theta_1_0)
    print("L_theta")
    print(L_theta)
# theta1
# [1.86818005, -0.87194949, 27.52040446, 0.25392635, 0.0, 0.9377970799999997]
# likelihood_theta_1_0
# 9.206679431804105
# L_theta
# -1311.1707213307743

def test_gradient_ascent():
    arch = Arch()
    x_1 = y_streamflow_395
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha4 = [2.18518342, 0.1112357, 0., 0.1851308]
    alpha3 = [31, 0.15392635, 0., 1.69992071]
    alpha3 = [25, 0.15392635, 0., 0.9]
    alpha3 = [9.57176198, 0.24797631, 0., 9.13934837]
    alpha3 = [12.38431257, 0.36105982, 0.31656086, 10.18909357]
    alpha3 = [27.53412208, 0.26761428, 0., 0.45247333]
    alpha3 = [6.68332411, 0.04860733, 0., 1.17182912]
    alpha3 = [1.24844341, 0.24797631, 0., 0.80837988]
    alpha3 = [1.24844341, 0.24797631, 0., 0.80837988]
    alpha3 = [27.522109401732685, 0.25392635, 0.0, 0.9382139505572842]
    alpha3 = [1, 1]
    alpha3 = [25, 0.1, 0., 0.95]
    alpha4_395 = [0.5, 1.1, 0., 0.1]
    alpha3 = [2.18518342, 0.01851308, 0., 0.01112357]  #
    alpha3 = [12.6339965, 13.27432677, 12.14344754, 12.20402554]
    alpha3 = [34.54383114, 0.25392635, 0., 2.69992071]
    alpha3 = [35.40975055, 1.11804071, 0., 3.56875317]
    alpha3 = [35.19315819, 0.9220255, 0., 3.8679039]
    alpha3 = [6.49175070e-03, 3.02082401e-02, 0.00000000e+00, 9.81992982e-01]
    theta = phi + alpha3
    x = y_streamflow_1460
    phi_1460 = [1.80161201, -1.28440015, 0.43756275]
    alpha_1460 = [6.71658575e+02, 2.37001714e-02, 3.90087440e-02, 3.41720975e-02]
    # alpha_1460 = [4.81614767e+03, 1.59475061e+03, 0.00000000e+00, 4.92331438e+04]
    # theta = phi_1460 + alpha_1460
    d_theta = 0.0001
    p = 2
    q = 3
    i_theta = [2, 3, 5]
    i_theta = [3, 4, 5, 6]
    theta1 = arch.gradient_ascent(x_1, theta, d_theta, p, q, i_theta)
    print("theta1")
    print(theta1)
## y_streamflow_395  phi = [1.86818005, -0.87194949]  alpha3 = [12.6339965, 13.27432677, 12.14344754, 12.20402554]
# ----------iloop = 0----------
# [1.86818005, -0.87194949, 12.6339965, 3.8608497493359017, 2.722486744926309, 12.20402554]
# gradient = [ 0.          0.         -6.12446904 -6.11733747 -6.12469083 -6.12935433]
# L_theta = -1384.6012240099658
# distance_grad_0 = 150.01176104079198
# likelihood_theta_1_0 = 75.17106113188765
# distance_theta_1_0 = 177.36805192088656
# theta1 = [1.86818005, -0.87194949, 12.6339965, 3.8608497493359017, 2.722486744926309, 12.20402554]
# ----------end----------
# gradient = [ 0.          0.         -8.87820647 -8.86727522 -8.879569   -8.88636639]
# L_theta = -1356.7731909561114
# distance_grad_0 = 315.26537326018376
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 2
# theta1
# [ 1.86818005 -0.87194949  1.24844341  0.24797631  0.          0.80837988]
## y_streamflow_395  phi = [1.86818005, -0.87194949]  alpha3 = [1.24844341, 0.24797631, 0., 0.80837988]
# ----------iloop = 0----------
# [ 1.86818005 -0.87194949  9.22625248  8.248581    7.97732645  8.76202457]
# gradient = [ 0.          0.         -6.43921171 -6.43220172 -6.43774221 -6.44344467]
# L_theta = -1461.9376128582871
# distance_grad_0 = 165.79917035525415
# likelihood_theta_1_0 = 1704.9002144667375
# distance_theta_1_0 = 254.553314085874
# theta1 = [ 1.86818005 -0.87194949  9.22625248  8.248581    7.97732645  8.76202457]
# ----------end----------
# gradient = [ 0.          0.         -6.43921171 -6.43220172 -6.43774221 -6.44344467]
# L_theta = -1461.9376128582871
# distance_grad_0 = 165.79917035525415
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 1
# theta1
# [ 1.86818005 -0.87194949  3.1894915   2.21839188  1.94194313  2.72129519]
## y_streamflow_395  phi = [1.86818005, -0.87194949]  alpha3 = [35.40975055, 1.11804071, 0., 3.56875317]
# ----------iloop = 0----------
# [ 1.86818005 -0.87194949 34.55754877  0.26761428  0.          2.7136873 ]
# gradient = [ 0.          0.         -3.51171334 -3.5041112  -3.51313309 -3.52424726]
# L_theta = -1320.3860012222617
# distance_grad_0 = 49.37334873209825
# likelihood_theta_1_0 = 11.486332034789939
# distance_theta_1_0 = 2.180610630396351
# theta1 = [ 1.86818005 -0.87194949 34.55754877  0.26761428  0.          2.7136873 ]
# ----------end----------
# gradient = [ 0.          0.         -4.40798735 -4.37532017 -4.41271312 -4.45833226]
# L_theta = -1317.6436628407173
# distance_grad_0 = 77.92254266337702
# likelihood_theta_1_0 = 2.742338381544414
# distance_theta_1_0 = 0.0
# iloop = 1
# theta1
# [ 1.86818005 -0.87194949  6.68332411  0.04860733  0.          1.17182912]
## y_streamflow_395  phi = [1.86818005, -0.87194949]  alpha3 = [6.68332411, 0.04860733, 0., 1.17182912]
# ----------iloop = 0----------
# [1.86818005, -0.87194949, 6.68332411, 0.04860733, 0.0, 1.17182912]
# gradient = [ 0.          0.         -4.40798729 -4.3753201  -4.41271306 -4.4583322 ]
# L_theta = -1601.6984325787544
# distance_grad_0 = 77.92254053224774
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# theta1 = [1.86818005, -0.87194949, 6.68332411, 0.04860733, 0.0, 1.17182912]
# ----------end----------
# gradient = [ 0.          0.         -4.40798729 -4.3753201  -4.41271306 -4.4583322 ]
# L_theta = -1601.6984325787544
# distance_grad_0 = 77.92254053224774
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 0
# theta1
# [1.86818005, -0.87194949, 6.68332411, 0.04860733, 0.0, 1.17182912]
## y_streamflow_395  phi = [1.86818005, -0.87194949]  alpha3 = [35.40975055, 1.11804071, 0., 3.56875317]
# ----------iloop = 0----------
# [ 1.86818005 -0.87194949 34.55754877  0.26761428  0.          2.7136873 ]
# gradient = [ 0.          0.         -3.51171334 -3.5041112  -3.51313309 -3.52424726]
# L_theta = -1320.3860012222617
# distance_grad_0 = 49.37334873209825
# likelihood_theta_1_0 = 11.486332034789939
# distance_theta_1_0 = 2.180610630396351
# theta1 = [ 1.86818005 -0.87194949 34.55754877  0.26761428  0.          2.7136873 ]
# ----------end----------
# gradient = [ 0.          0.         -3.80745792 -3.79685301 -3.80951965 -3.82580215]
# L_theta = -1309.8616326194897
# distance_grad_0 = 58.06203076382762
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 3
# theta1
# [ 1.86818005 -0.87194949 27.53412208  0.26761428  0.          0.45247333]
## y_streamflow_395  phi = [1.86818005, -0.87194949]  alpha3 = [27.53412208, 0.26761428, 0., 0.45247333]
# ----------iloop = 0----------
# [1.86818005, -0.87194949, 27.53412208, 0.26761428, 0.0, 0.45247333]
# gradient = [ 0.          0.         -3.80745792 -3.79685301 -3.80951965 -3.82580215]
# L_theta = -1309.8616326392375
# distance_grad_0 = 58.062030769206295
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# theta1 = [1.86818005, -0.87194949, 27.53412208, 0.26761428, 0.0, 0.45247333]
# ----------end----------
# gradient = [ 0.          0.         -3.80745792 -3.79685301 -3.80951965 -3.82580215]
# L_theta = -1309.8616326392375
# distance_grad_0 = 58.062030769206295
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 0
# theta1
# [1.86818005, -0.87194949, 27.53412208, 0.26761428, 0.0, 0.45247333]
## y_streamflow_395  phi = [1.86818005, -0.87194949]   alpha3 = [12.6339965, 13.27432677, 12.14344754, 12.20402554]
# ----------iloop = 0----------
# [1.86818005, -0.87194949, 12.6339965, 3.8608497493359017, 2.722486744926309, 12.20402554]
# gradient = [ 0.          0.         -6.12446904 -6.11733747 -6.12469083 -6.12935433]
# L_theta = -1384.6012240099658
# distance_grad_0 = 150.01176104079198
# likelihood_theta_1_0 = 75.17106113188765
# distance_theta_1_0 = 177.36805192088656
# theta1 = [1.86818005, -0.87194949, 12.6339965, 3.8608497493359017, 2.722486744926309, 12.20402554]
# ----------end----------
# gradient = [ 0.          0.         -8.9330704  -8.92205496 -8.93443566 -8.9414055 ]
# L_theta = -1351.370937398201
# distance_grad_0 = 319.17568446905426
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 3
# theta1
# [ 1.86818005 -0.87194949  9.57176198  0.24797631  0.          9.13934837]
## y_streamflow_395  phi = [1.86818005, -0.87194949]   alpha3 = [12.6339965, 13.27432677, 12.14344754, 12.20402554]
# ----------iloop = 0----------
# [ 1.86818005 -0.87194949 34.32440234  0.59387741  0.          2.29376854]
# gradient = [  0.           0.          -3.5243862   -8.85518045 -13.6362953
#   -7.29164085]
# L_theta = -1319.7260055090396
# distance_grad_0 = 329.95209458636776
# likelihood_theta_1_0 = 0.6488986830795511
# distance_theta_1_0 = 0.3286753131159973
# theta1 = [ 1.86818005 -0.87194949 34.32440234  0.59387741  0.          2.29376854]
# ----------end----------
# gradient = [  0.           0.          -3.89485976  -7.13898852 -22.19543174
#   -5.25305131]
# L_theta = -1309.7710343199624
# distance_grad_0 = 586.3668276334454
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 2
# theta1
# [ 1.86818005 -0.87194949 27.27562994  0.59387741  0.          0.47085832]
## y_streamflow_395  phi = [1.86818005, -0.87194949]   alpha3 = [2.18518342, 0.01851308, 0., 0.01112357]
# ----------iloop = 0----------
# [ 1.86818005 -0.87194949 24.88502542 22.72549769 22.69956968 22.6979746 ]
# gradient = [ 0.          0.         -2.59368766 -2.59108341 -2.59309899 -2.59530441]
# L_theta = -1489.0009944181716
# distance_grad_0 = 26.900696284318432
# likelihood_theta_1_0 = 2241.934962834629
# distance_theta_1_0 = 2060.853649947687
# theta1 = [ 1.86818005 -0.87194949 24.88502542 22.72549769 22.69956968 22.6979746 ]
# ----------end----------
# gradient = [ 0.          0.         -7.33427955 -7.3250673  -7.33535053 -7.34220464]
# L_theta = -1341.2909771542522
# distance_grad_0 = 215.1636038569915
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 6
# theta1
# [ 1.86818005 -0.87194949 12.38431257  0.36105982  0.31656086 10.18909357]
## y_streamflow_395  phi = [1.86818005, -0.87194949]   alpha3 = [12.6339965, 13.27432677, 12.14344754, 12.20402554]
# ----------iloop = 0----------
# [1.86818005, -0.87194949, 12.6339965, 3.8608497493359017, 2.722486744926309, 12.20402554]
# gradient = [ 0.          0.         -6.12446904 -6.11733747 -6.12469083 -6.12935433]
# L_theta = -1384.6012240099658
# distance_grad_0 = 150.01176104079198
# likelihood_theta_1_0 = 75.17106113188765
# distance_theta_1_0 = 177.36805192088656
# theta1 = [1.86818005, -0.87194949, 12.6339965, 3.8608497493359017, 2.722486744926309, 12.20402554]
# ----------end----------
# gradient = [ 0.          0.         -8.9330704  -8.92205496 -8.93443566 -8.9414055 ]
# L_theta = -1351.370937398201
# distance_grad_0 = 319.17568446905426
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 3
# theta1
# [ 1.86818005 -0.87194949  9.57176198  0.24797631  0.          9.13934837]
## y_streamflow_395  phi = [1.86818005, -0.87194949]   alpha3 = [34.54383114, 0.25392635, 0., 2.69992071]
# ----------iloop = 0----------
# [1.86818005, -0.87194949, 27.522109401732685, 0.25392635, 0.0, 0.9382139505572842]
# gradient = [ 0.          0.         -3.96821852 -3.95794312 -3.97018576 -3.98575643]
# L_theta = -1311.1693098548242
# distance_grad_0 = 63.06070125979027
# likelihood_theta_1_0 = 9.205594337294997
# distance_theta_1_0 = 52.40818687592194
# theta1 = [1.86818005, -0.87194949, 27.522109401732685, 0.25392635, 0.0, 0.9382139505572842]
# ----------end----------
# gradient = [ 0.          0.         -3.79433575 -3.78371557 -3.79640119 -3.81271427]
# L_theta = -1310.1770604137757
# distance_grad_0 = 57.66293936989242
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 2
# theta1
# [1.86818005, -0.87194949, 27.522109401732685, 0.25392635, 0.0, 0.4399943968985215]
## y_streamflow_395  phi = [1.86818005, -0.87194949]   alpha3 = [35.40975055, 1.11804071, 0., 3.56875317]
# ----------iloop = 0----------
# [ 1.86818005 -0.87194949 34.55754877  0.26761428  0.          2.7136873 ]
# gradient = [ 0.          0.         -3.51171334 -3.5041112  -3.51313309 -3.52424726]
# L_theta = -1320.3860012222617
# distance_grad_0 = 49.37334873209825
# likelihood_theta_1_0 = 11.486332034789939
# distance_theta_1_0 = 2.180610630396351
# theta1 = [ 1.86818005 -0.87194949 34.55754877  0.26761428  0.          2.7136873 ]
# ----------end----------
# gradient = [ 0.          0.         -3.80745792 -3.79685301 -3.80951965 -3.82580215]
# L_theta = -1309.8616326194897
# distance_grad_0 = 58.06203076382762
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 3
# theta1
# [ 1.86818005 -0.87194949 27.53412208  0.26761428  0.          0.45247333]
## y_streamflow_395  phi = [1.86818005, -0.87194949]   alpha3 = [35.19315819, 0.9220255, 0., 3.8679039]
# ----------iloop = 0----------
# [ 1.86818005 -0.87194949 34.76330671  0.49305579  0.          3.43663866]
# gradient = [623.30940798 617.7154638   -3.50293971  -3.49564482  -3.50428198
#   -3.51476375]
# L_theta = -1324.6578974860165
# distance_grad_0 = 49.12367581151497
# likelihood_theta_1_0 = 6.30784941641673
# distance_theta_1_0 = 0.5547770179703169
# theta1 = [ 1.86818005 -0.87194949 34.76330671  0.49305579  0.          3.43663866]
# ----------end----------
# gradient = [2313.74071548 2310.05554927   -3.80099938   -3.79037075   -3.80306697
#    -3.81939414]
# L_theta = -1309.7861649408073
# distance_grad_0 = 57.86559669843861
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 4
# theta1
# [ 1.86818005 -0.87194949 27.50718396  0.27457799  0.          0.43175393]

def test_multi_gradient_ascent():
    arch = Arch()
    phi = [1.86818005, -0.87194949]
    alpha1 = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha2 = [34.83797803, 0.60908538, 0., 0.16389898]
    alpha3 = [35.10725569, 0.86070866, 0.0, 0.41552226]
    alpha4 = [0.5, 1.1, 0., 0.1]
    theta1 = phi[:] + alpha1[:]
    theta2 = phi[:] + alpha2[:]
    theta3 = phi[:] + alpha3[:]
    theta = [theta1[:], theta2[:], theta3[:]]
    phi_1460 = [1.80161201, -1.28440015, 0.43756275]
    alpha_1460 = [6.71658575e+02, 2.37001714e-02, 3.90087440e-02, 3.41720975e-02]
    theta = phi_1460 + alpha_1460
    d_theta = 0.000001
    p = 2
    p=3
    q = 3
    i_theta = [2, 3, 5]
    i_theta = [3, 4, 5, 6]
    theta1 = arch.multi_gradient_ascent(y_residual_2_streamflow_395, theta, d_theta, p, q, i_theta)
    print("theta1")
    print(theta1)
# 1 theta1 L_theta
# ----------end----------
# gradient = [ 0.          0.         -0.03091418 -0.02333354  0.          0.00591263]
# L_theta = -2906.4385930042995
# distance_grad_0 = 0.001535099789738615
# likelihood_theta_1_0 = 9.157446538665681e-05
# distance_theta_1_0 = 5.996483553666465e-06
# iloop = 2
# ----------end----------
# gradient = [ 0.          0.         -0.03589912 -0.02705701  0.          0.00981709]
# L_theta = -2910.6908158702904
# distance_grad_0 = 0.0021172039317647368
# likelihood_theta_1_0 = 0.00012027964112348855
# distance_theta_1_0 = 8.270327858456003e-06
# iloop = 2
# theta1
# [array([ 1.86818005e+00, -8.71949490e-01,  3.55126928e+05,  3.70693097e+05,
#         0.00000000e+00,  3.69634114e+06]), array([ 1.86818005e+00, -8.71949490e-01,  1.42225607e+03,  1.22301976e+03,
#         0.00000000e+00,  1.44689296e+04]), array([ 1.86818005e+00, -8.71949490e-01,  1.21672379e+03,  1.00605286e+03,
#         0.00000000e+00,  1.23177205e+04])]

def test_H_gradient_thetai():
    arch = Arch()
    x = y_streamflow_395
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    theta = phi + alpha
    d_theta = 0.000001
    i_theta = 0
    grad, residual0, residual1 = arch.H_gradient_thetai(x, theta, d_theta, i_theta, p, q)
    print("grad")
    print(grad)
    print("residual0")
    print(residual0)
    print("residual1")
    print(residual1)

def test_st_theta():
    arch = Arch()
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [35.19315819, 0.9220255,  0., 3.8679039]
    residual_2 = y_residual_2_streamflow_395[4:4+q+1]  # t = 8  i=7
    residual_2.reverse()
    residual = y_residual_streamflow_395[4:4+q+1]
    residual.reverse()
    x = y_streamflow_395[4-p:4+q]
    x.reverse()
    residual_2_ = residual_2.copy()
    residual_2_[0] = 1
    alpha_ = np.transpose(alpha)
    h = arch.delta_2_one_step(residual_2_, alpha_)
    st = arch.st_theta(residual, x, h, alpha, p, q)
    print("st")
    print(st)
# st
# [-5.24625544e+00 -5.24240296e+00 -1.35432734e-02 -1.04699592e-03
#  -5.23896533e-03 -5.23896533e-03]
# st  alpha = [35.19315819, 0.9220255,  0., 3.8679039]
# [-6.57425924e+00 -6.58397153e+00 -1.35432676e-02 -1.04667789e-03
#  -5.23967354e-03 -5.23967354e-03]

def test_s_theat():
    arch = Arch()
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha = [35.19315819, 0.9220255, 0., 3.8679039]
    theta = phi + alpha
    x = y_streamflow_395
    s = arch.s_theat(x, theta, p, q)
    print("s")
    print(s)
# s
# [array([-8.99407769e+00, -9.10577053e+00, -1.15044046e-02, -4.45026328e-03,
#        -2.00306136e-02, -2.23712432e-02]), array([-1.21414204e+01, -1.21896126e+01, -1.18030917e-02, -1.18030917e-02,
#        -4.56580479e-03, -2.05506653e-02]), array([-6.57371993e+00, -6.58343173e+00, -1.35432737e-02, -1.35432737e-02,
#        -1.35432737e-02, -5.23896158e-03]), array([-2.42396887, -2.39600938, -0.01348888, -0.01348888, -0.01348888,
#        -0.01348888]), array([ 2.76686294,  2.76940056, -0.01397089, -0.01397089, -0.01397089,
#        -0.01397089]), array([ 8.81843002,  8.8993511 , -0.01320906, -0.01320906, -0.01320906,
#        -0.01320906]), array([-0.94671826, -0.99040227, -0.01263762, -0.01263762, -0.01263762,
#        -0.01263762]), array([-2.36641391, -2.40444195, -0.01336426, -0.01336426, -0.01336426,
#        -0.01336426]), array([-8.54996618, -8.66042042, -0.01159625, -0.01159625, -0.01159625,
#        -0.01159625]), array([-8.11448371, -8.16173003, -0.01180755, -0.01180755, -0.01180755,
#        -0.01180755]), array([-3.49938116, -3.49938116, -0.0134227 , -0.0134227 , -0.0134227 ,
#        -0.0134227 ]), array([-3.49938116, -3.49938116, -0.0134227 , -0.0134227 , -0.0134227 ,
#        -0.0134227 ]), array([-3.49938116, -3.49938116, -0.0134227 , -0.0134227 , -0.0134227 ,
#        -0.0134227 ]), array([-11.02686166, -11.02686166,  -0.01302009,  -0.01302009,
#         -0.01302009,  -0.01302009]), array([-7.89792876, -7.9616464 , -0.01256515, -0.01256515, -0.01256515,
#        -0.01256515]), array([-1.72338533, -1.68260402, -0.01307491, -0.01307491, -0.01307491,
#        -0.01307491]), array([ 9.21108559,  9.21584454, -0.01224525, -0.01224525, -0.01224525,
#        -0.01224525]), array([ 1.26601742e+01,  1.28471241e+01, -1.15755399e-02, -1.15755399e-02,
#        -1.15755399e-02, -1.15755399e-02]), array([ 1.16351996,  1.16928389, -0.0134329 , -0.0134329 , -0.0134329 ,
#        -0.0134329 ]), array([-1.16347164, -1.19793691, -0.01375892, -0.01375892, -0.01375892,
#        -0.01375892]), array([-7.10921451, -7.28125544, -0.01273507, -0.01273507, -0.01273507,
#        -0.01273507]), array([-3.79021164, -3.87484905, -0.01245192, -0.01245192, -0.01245192,
#        -0.01245192]), array([-0.95434578, -0.9840628 , -0.01326433, -0.01326433, -0.01326433,
#        -0.01326433]), array([-1.54115771, -1.56733181, -0.01372123, -0.01372123, -0.01372123,
#        -0.01372123]), array([-5.86154366, -5.9459188 , -0.01270215, -0.01270215, -0.01270215,
#        -0.01270215]), array([-7.15547898, -7.21061737, -0.01280329, -0.01280329, -0.01280329,
#        -0.01280329]), array([-3.0287047 , -3.03879612, -0.0138949 , -0.0138949 , -0.0138949 ,
#        -0.0138949 ]), array([-2.49740233, -2.50218327, -0.01387465, -0.01387465, -0.01387465,
#        -0.01387465]), array([ 0.84286718,  0.85361879, -0.01410672, -0.01410672, -0.01410672,
#        -0.01410672]), array([ 0.96612954,  0.97615507, -0.01396315, -0.01396315, -0.01396315,
#        -0.01396315]), array([-0.00695208, -0.01301649, -0.01373026, -0.01373026, -0.01373026,
#        -0.01373026]), array([-2.75736338, -2.78985174, -0.01364586, -0.01364586, -0.01364586,
#        -0.01364586]), array([-3.55765123, -3.59451152, -0.01347207, -0.01347207, -0.01347207,
#        -0.01347207]), array([-3.28711327, -3.31536306, -0.0130903 , -0.0130903 , -0.0130903 ,
#        -0.0130903 ]), array([-1.7149221 , -1.72692924, -0.0135874 , -0.0135874 , -0.0135874 ,
#        -0.0135874 ]), array([-2.22991425, -2.2427257 , -0.01369443, -0.01369443, -0.01369443,
#        -0.01369443]), array([-3.8425281 , -3.86100348, -0.01328275, -0.01328275, -0.01328275,
#        -0.01328275]), array([-4.51897115, -4.52581765, -0.01347342, -0.01347342, -0.01347342,
#        -0.01347342]), array([-2.73970983, -2.73769228, -0.01381849, -0.01381849, -0.01381849,
#        -0.01381849]), array([-2.22022823, -2.21540682, -0.01376598, -0.01376598, -0.01376598,
#        -0.01376598]), array([-0.4735706 , -0.47042866, -0.01402408, -0.01402408, -0.01402408,
#        -0.01402408]), array([ 1.29120236,  1.29896971, -0.01364891, -0.01364891, -0.01364891,
#        -0.01364891]), array([-1.23177981, -1.25107597, -0.01329367, -0.01329367, -0.01329367,
#        -0.01329367]), array([-2.27258635, -2.28972644, -0.01355773, -0.01355773, -0.01355773,
#        -0.01355773]), array([-5.257673  , -5.28605433, -0.01258786, -0.01258786, -0.01258786,
#        -0.01258786]), array([-9.47773127, -9.45781106, -0.01267279, -0.01267279, -0.01267279,
#        -0.01267279]), array([-4.923145  , -4.93799249, -0.01319055, -0.01319055, -0.01319055,
#        -0.01319055]), array([-1.9789219 , -1.94889408, -0.01350938, -0.01350938, -0.01350938,
#        -0.01350938]), array([ 6.79103311,  6.78077634, -0.01288877, -0.01288877, -0.01288877,
#        -0.01288877]), array([ 7.73084975,  7.8162688 , -0.01287736, -0.01287736, -0.01287736,
#        -0.01287736]), array([ 1.61041701,  1.62054424, -0.01348758, -0.01348758, -0.01348758,
#        -0.01348758]), array([-2.47872543, -2.52621649, -0.0136765 , -0.0136765 , -0.0136765 ,
#        -0.0136765 ]), array([-4.28571297, -4.37521303, -0.01302727, -0.01302727, -0.01302727,
#        -0.01302727]), array([-3.4324688 , -3.49292219, -0.01225256, -0.01225256, -0.01225256,
#        -0.01225256]), array([ 0.60969791,  0.59161826, -0.01322622, -0.01322622, -0.01322622,
#        -0.01322622]), array([-2.28636339, -2.31635162, -0.01332032, -0.01332032, -0.01332032,
#        -0.01332032]), array([-5.42970385, -5.46908385, -0.01249429, -0.01249429, -0.01249429,
#        -0.01249429]), array([-7.4225701 , -7.41566265, -0.01237018, -0.01237018, -0.01237018,
#        -0.01237018]), array([-4.45468297, -4.4329141 , -0.01357881, -0.01357881, -0.01357881,
#        -0.01357881]), array([-1.60617963, -1.5820721 , -0.01385443, -0.01385443, -0.01385443,
#        -0.01385443]), array([ 2.11796373,  2.11936431, -0.01406473, -0.01406473, -0.01406473,
#        -0.01406473]), array([ 1.45029139,  1.44867977, -0.01402897, -0.01402897, -0.01402897,
#        -0.01402897]), array([-1.1442699 , -1.14975112, -0.01407925, -0.01407925, -0.01407925,
#        -0.01407925]), array([-2.11458922, -2.12751062, -0.01385982, -0.01385982, -0.01385982,
#        -0.01385982]), array([-0.43666881, -0.43783312, -0.01410269, -0.01410269, -0.01410269,
#        -0.01410269]), array([ 1.71000043,  1.72670293, -0.01362146, -0.01362146, -0.01362146,
#        -0.01362146]), array([ 0.08971069,  0.0668807 , -0.01319156, -0.01319156, -0.01319156,
#        -0.01319156]), array([-1.81841582, -1.84354791, -0.01355283, -0.01355283, -0.01355283,
#        -0.01355283]), array([-5.15895803, -5.21488235, -0.0124061 , -0.0124061 , -0.0124061 ,
#        -0.0124061 ]), array([-8.77329552, -8.77087039, -0.01227351, -0.01227351, -0.01227351,
#        -0.01227351]), array([-4.41404831, -4.42549077, -0.0133319 , -0.0133319 , -0.0133319 ,
#        -0.0133319 ]), array([-1.19149723, -1.16103146, -0.01356457, -0.01356457, -0.01356457,
#        -0.01356457]), array([ 4.93068923,  4.91426252, -0.01324136, -0.01324136, -0.01324136,
#        -0.01324136]), array([ 7.8610706 ,  7.95183553, -0.01264228, -0.01264228, -0.01264228,
#        -0.01264228]), array([ 1.29821489,  1.28891821, -0.01308893, -0.01308893, -0.01308893,
#        -0.01308893]), array([-1.41383143, -1.44590809, -0.01353663, -0.01353663, -0.01353663,
#        -0.01353663]), array([-5.28200411, -5.39132235, -0.0123179 , -0.0123179 , -0.0123179 ,
#        -0.0123179 ]), array([-6.99052873, -7.0496348 , -0.01201812, -0.01201812, -0.01201812,
#        -0.01201812]), array([-2.6379606 , -2.64028262, -0.01394791, -0.01394791, -0.01394791,
#        -0.01394791]), array([-1.28058427, -1.27209774, -0.01392486, -0.01392486, -0.01392486,
#        -0.01392486]), array([ 0.98854282,  0.99250238, -0.0141378 , -0.0141378 , -0.0141378 ,
#        -0.0141378 ]), array([ 1.93095414,  1.94503956, -0.01405488, -0.01405488, -0.01405488,
#        -0.01405488]), array([-0.43729619, -0.44441472, -0.01388854, -0.01388854, -0.01388854,
#        -0.01388854]), array([-1.32364266, -1.33930821, -0.01393882, -0.01393882, -0.01393882,
#        -0.01393882]), array([-2.03870395, -2.06084086, -0.01381277, -0.01381277, -0.01381277,
#        -0.01381277]), array([-2.37363831, -2.39441223, -0.01360094, -0.01360094, -0.01360094,
#        -0.01360094]), array([-1.07482366, -1.08126708, -0.01391896, -0.01391896, -0.01391896,
#        -0.01391896]), array([-1.60397853, -1.61270452, -0.01396612, -0.01396612, -0.01396612,
#        -0.01396612]), array([-1.35663305, -1.36392022, -0.01385581, -0.01385581, -0.01385581,
#        -0.01385581]), array([-2.16451056, -2.17382407, -0.0138462 , -0.0138462 , -0.0138462 ,
#        -0.0138462 ]), array([-0.97295579, -0.97525564, -0.0140811 , -0.0140811 , -0.0140811 ,
#        -0.0140811 ]), array([-1.41515314, -1.41969121, -0.01385336, -0.01385336, -0.01385336,
#        -0.01385336]), array([-1.17614881, -1.18015095, -0.01404374, -0.01404374, -0.01404374,
#        -0.01404374]), array([-0.62506284, -0.62671411, -0.01407888, -0.01407888, -0.01407888,
#        -0.01407888]), array([-1.97136365, -1.98140991, -0.01390766, -0.01390766, -0.01390766,
#        -0.01390766]), array([-0.62857811, -0.62976645, -0.01408764, -0.01408764, -0.01408764,
#        -0.01408764]), array([-1.18186981, -1.18748808, -0.01400574, -0.01400574, -0.01400574,
#        -0.01400574]), array([-0.38055259, -0.38173989, -0.01405834, -0.01405834, -0.01405834,
#        -0.01405834]), array([-0.63590471, -0.64115121, -0.01393433, -0.01393433, -0.01393433,
#        -0.01393433]), array([-1.21877477, -1.22843182, -0.01395721, -0.01395721, -0.01395721,
#        -0.01395721]), array([-1.49596955, -1.5068244 , -0.01391091, -0.01391091, -0.01391091,
#        -0.01391091]), array([-1.76663614, -1.77745693, -0.01374057, -0.01374057, -0.01374057,
#        -0.01374057]), array([-0.71606252, -0.71979285, -0.01388355, -0.01388355, -0.01388355,
#        -0.01388355]), array([-1.29820904, -1.30462981, -0.01390684, -0.01390684, -0.01390684,
#        -0.01390684]), array([-1.57513571, -1.58177936, -0.0138539 , -0.0138539 , -0.0138539 ,
#        -0.0138539 ]), array([-2.10600707, -2.11157429, -0.0136995 , -0.0136995 , -0.0136995 ,
#        -0.0136995 ]), array([-1.26615844, -1.26615844, -0.013925  , -0.013925  , -0.013925  ,
#        -0.013925  ]), array([-1.26615844, -1.26615844, -0.013925  , -0.013925  , -0.013925  ,
#        -0.013925  ]), array([-1.26615844, -1.26615844, -0.013925  , -0.013925  , -0.013925  ,
#        -0.013925  ]), array([ 0.07146014,  0.07146014, -0.01369034, -0.01369034, -0.01369034,
#        -0.01369034]), array([-0.58950582, -0.60074563, -0.01350736, -0.01350736, -0.01350736,
#        -0.01350736]), array([-1.46832968, -1.47486624, -0.01369549, -0.01369549, -0.01369549,
#        -0.01369549]), array([-3.07358271, -3.0820501 , -0.01297618, -0.01297618, -0.01297618,
#        -0.01297618]), array([2.37552723e+01, 2.35233520e+01, 9.44579971e-03, 9.44579971e-03,
#        9.44579971e-03, 9.44579971e-03]), array([ 8.47463497e+00,  7.70908429e+00, -1.11764884e-03, -1.11764884e-03,
#        -1.11764884e-03, -1.11764884e-03]), array([-1.85627255, -1.91023576, -0.0044353 , -0.0044353 , -0.0044353 ,
#        -0.0044353 ]), array([-4.29716399e+00, -4.32143554e+00, -1.66289911e-03, -1.66289911e-03,
#        -1.66289911e-03, -1.66289911e-03]), array([-6.87930891e+00, -6.27317568e+00, -1.46558652e-03, -1.46558652e-03,
#        -1.46558652e-03, -1.46558652e-03]), array([-1.26328617e+01, -1.14135553e+01, -6.53987238e-03, -6.53987238e-03,
#        -6.53987238e-03, -6.53987238e-03]), array([-2.98747127, -2.20327068, -0.00709419, -0.00709419, -0.00709419,
#        -0.00709419]), array([ 1.39695486e+01,  1.26728013e+01, -7.46320183e-03, -7.46320183e-03,
#        -7.46320183e-03, -7.46320183e-03]), array([ 3.44623103,  2.94500874, -0.00612723, -0.00612723, -0.00612723,
#        -0.00612723]), array([-1.41664734e+01, -1.39707128e+01, -8.32781695e-03, -8.32781695e-03,
#        -8.32781695e-03, -8.32781695e-03]), array([-2.94140347, -2.67261539, -0.00989984, -0.00989984, -0.00989984,
#        -0.00989984]), array([ 1.52565988e+01,  1.48102126e+01, -7.55603225e-03, -7.55603225e-03,
#        -7.55603225e-03, -7.55603225e-03]), array([ 1.53596331e+01,  1.52586034e+01, -7.23304849e-03, -7.23304849e-03,
#        -7.23304849e-03, -7.23304849e-03]), array([-2.57494285, -2.61041614, -0.01393604, -0.01393604, -0.01393604,
#        -0.01393604]), array([-2.47665978, -2.51125835, -0.01395043, -0.01395043, -0.01395043,
#        -0.01395043]), array([-2.37990836, -2.41362912, -0.01396446, -0.01396446, -0.01396446,
#        -0.01396446]), array([-5.92644827, -6.01508491, -0.01391216, -0.01391216, -0.01391216,
#        -0.01391216]), array([-4.09816962, -4.1720065 , -0.01385746, -0.01385746, -0.01385746,
#        -0.01385746]), array([-1.32612749, -1.33672244, -0.01396392, -0.01396392, -0.01396392,
#        -0.01396392]), array([ 4.50761867,  4.57791153, -0.01381663, -0.01381663, -0.01381663,
#        -0.01381663]), array([ 9.21607901,  9.4382058 , -0.01320592, -0.01320592, -0.01320592,
#        -0.01320592]), array([ 1.88096451,  1.89620376, -0.01311856, -0.01311856, -0.01311856,
#        -0.01311856]), array([-1.04300925, -1.07736986, -0.01363213, -0.01363213, -0.01363213,
#        -0.01363213]), array([-8.51907604, -8.75113568, -0.01207938, -0.01207938, -0.01207938,
#        -0.01207938]), array([-4.90929109, -5.02354064, -0.01198562, -0.01198562, -0.01198562,
#        -0.01198562]), array([-1.00372613, -1.03402556, -0.01324571, -0.01324571, -0.01324571,
#        -0.01324571]), array([-1.60250789, -1.62933769, -0.01370885, -0.01370885, -0.01370885,
#        -0.01370885]), array([-5.97281675, -6.05765236, -0.01267926, -0.01267926, -0.01267926,
#        -0.01267926]), array([-7.28581329, -7.34121941, -0.01278232, -0.01278232, -0.01278232,
#        -0.01278232]), array([-3.11131838, -3.12146393, -0.01388389, -0.01388389, -0.01388389,
#        -0.01388389]), array([-2.57217002, -2.57698349, -0.01386255, -0.01386255, -0.01386255,
#        -0.01386255]), array([ 0.81478407,  0.82548938, -0.01410155, -0.01410155, -0.01410155,
#        -0.01410155]), array([ 4.78300699,  4.82748013, -0.01304055, -0.01304055, -0.01304055,
#        -0.01304055]), array([ 1.53158037,  1.4904141 , -0.01227363, -0.01227363, -0.01227363,
#        -0.01227363]), array([-2.79799816, -2.84811607, -0.01284764, -0.01284764, -0.01284764,
#        -0.01284764]), array([-8.39098284, -8.48026485, -0.01074362, -0.01074362, -0.01074362,
#        -0.01074362]), array([-9.6694879 , -9.65685102, -0.01097279, -0.01097279, -0.01097279,
#        -0.01097279]), array([-5.38663835, -5.33849583, -0.0133611 , -0.0133611 , -0.0133611 ,
#        -0.0133611 ]), array([-2.14815333, -2.10878773, -0.01360709, -0.01360709, -0.01360709,
#        -0.01360709]), array([ 0.58167081,  0.58607591, -0.01399559, -0.01399559, -0.01399559,
#        -0.01399559]), array([ 1.18180167e+01,  1.18178601e+01, -9.99010226e-03, -9.99010226e-03,
#        -9.99010226e-03, -9.99010226e-03]), array([ 5.1282395 ,  4.92337485, -0.00804722, -0.00804722, -0.00804722,
#        -0.00804722]), array([-3.96384558, -4.00096357, -0.01027907, -0.01027907, -0.01027907,
#        -0.01027907]), array([-9.24115018e+00, -9.29667961e+00, -6.39453404e-03, -6.39453404e-03,
#        -6.39453404e-03, -6.39453404e-03]), array([-6.85423840e+00, -6.77385869e+00, -5.55451259e-03, -5.55451259e-03,
#        -5.55451259e-03, -5.55451259e-03]), array([ 0.72613231,  0.65688247, -0.0091409 , -0.0091409 , -0.0091409 ,
#        -0.0091409 ]), array([-6.16177947, -5.98690912, -0.00971221, -0.00971221, -0.00971221,
#        -0.00971221]), array([-8.32156896e+00, -8.06324720e+00, -7.79791420e-03, -7.79791420e-03,
#        -7.79791420e-03, -7.79791420e-03]), array([-2.09276712e+01, -2.00665857e+01, -6.57624233e-03, -6.57624233e-03,
#        -6.57624233e-03, -6.57624233e-03]), array([-1.48111538e+01, -1.44137812e+01, -8.14747540e-03, -8.14747540e-03,
#        -8.14747540e-03, -8.14747540e-03]), array([-4.64576834, -4.24289701, -0.00909855, -0.00909855, -0.00909855,
#        -0.00909855]), array([ 1.64643500e+01,  1.58328958e+01, -7.53893459e-03, -7.53893459e-03,
#        -7.53893459e-03, -7.53893459e-03]), array([ 1.69496089e+01,  1.66873403e+01, -7.32334246e-03, -7.32334246e-03,
#        -7.32334246e-03, -7.32334246e-03]), array([-1.7213242 , -1.73610981, -0.01311019, -0.01311019, -0.01311019,
#        -0.01311019]), array([-5.49552342, -5.52869404, -0.01294731, -0.01294731, -0.01294731,
#        -0.01294731]), array([-6.53224533, -6.56364044, -0.01270056, -0.01270056, -0.01270056,
#        -0.01270056]), array([-1.49364455e+01, -1.49563838e+01, -1.22745781e-02, -1.22745781e-02,
#        -1.22745781e-02, -1.22745781e-02]), array([-8.96047682, -8.99894654, -0.01292467, -0.01292467, -0.01292467,
#        -0.01292467]), array([-3.17222062, -3.13079262, -0.01317605, -0.01317605, -0.01317605,
#        -0.01317605]), array([ 9.09022297,  9.10197923, -0.01299225, -0.01299225, -0.01299225,
#        -0.01299225]), array([10.81073665, 10.92559309, -0.01284184, -0.01284184, -0.01284184,
#        -0.01284184]), array([-0.92927306, -0.95063971, -0.01370364, -0.01370364, -0.01370364,
#        -0.01370364]), array([-3.10696927, -3.16126437, -0.01386616, -0.01386616, -0.01386616,
#        -0.01386616]), array([-4.72245008, -4.80777095, -0.01343239, -0.01343239, -0.01343239,
#        -0.01343239]), array([4.34261468e+01, 4.40116510e+01, 1.15517789e-02, 1.15517789e-02,
#        1.15517789e-02, 1.15517789e-02]), array([ 1.38304857e+01,  1.32931791e+01, -1.03776466e-03, -1.03776466e-03,
#        -1.03776466e-03, -1.03776466e-03]), array([-3.49481592, -3.58534262, -0.00437108, -0.00437108, -0.00437108,
#        -0.00437108]), array([-7.47743976e+00, -7.65343267e+00, -1.58241585e-03, -1.58241585e-03,
#        -1.58241585e-03, -1.58241585e-03]), array([4.63686957e+01, 4.41117755e+01, 3.85524069e-03, 3.85524069e-03,
#        3.85524069e-03, 3.85524069e-03]), array([8.46170640e+00, 7.00107449e+00, 6.35361238e-05, 6.35361238e-05,
#        6.35361238e-05, 6.35361238e-05]), array([-9.22257624e-01, -9.65609204e-01, -3.31814084e-04, -3.31814084e-04,
#        -3.31814084e-04, -3.31814084e-04]), array([-2.19310083e+00, -2.11686429e+00, -9.58823677e-05, -9.58823677e-05,
#        -9.58823677e-05, -9.58823677e-05]), array([ 8.57941869e-01,  7.83520706e-01, -6.27849778e-05, -6.27849778e-05,
#        -6.27849778e-05, -6.27849778e-05]), array([ 1.16000212e+01,  9.54768016e+00, -2.77646410e-05, -2.77646410e-05,
#        -2.77646410e-05, -2.77646410e-05]), array([-1.55060984e+01, -1.26858448e+01,  2.57048653e-06,  2.57048653e-06,
#         2.57048653e-06,  2.57048653e-06]), array([-6.60873942e+00, -5.95401324e+00, -4.16180267e-05, -4.16180267e-05,
#        -4.16180267e-05, -4.16180267e-05]), array([-5.96345106e+00, -5.28974598e+00, -4.59553141e-05, -4.59553141e-05,
#        -4.59553141e-05, -4.59553141e-05]), array([ 3.85803353e+00,  2.67460003e+00, -4.27835414e-05, -4.27835414e-05,
#        -4.27835414e-05, -4.27835414e-05]), array([ 7.66508660e+00,  7.11101146e+00, -4.45387358e-05, -4.45387358e-05,
#        -4.45387358e-05, -4.45387358e-05]), array([ 1.01461527e+01,  1.00384072e+01, -9.27719246e-05, -9.27719246e-05,
#        -9.27719246e-05, -9.27719246e-05]), array([ 1.09628614e+01,  1.16261070e+01, -8.13371946e-05, -8.13371946e-05,
#        -8.13371946e-05, -8.13371946e-05]), array([ 2.40841814e+01,  2.65225105e+01, -5.37962576e-04, -5.37962576e-04,
#        -5.37962576e-04, -5.37962576e-04]), array([ 8.92707092e+00,  1.02181419e+01, -1.12129787e-03, -1.12129787e-03,
#        -1.12129787e-03, -1.12129787e-03]), array([-1.84630965e+01, -2.09284522e+01, -5.87114178e-04, -5.87114178e-04,
#        -5.87114178e-04, -5.87114178e-04]), array([-9.33868048e+00, -1.04423249e+01, -4.86043246e-04, -4.86043246e-04,
#        -4.86043246e-04, -4.86043246e-04]), array([ 2.72671945e+01,  2.86624905e+01, -1.01858275e-03, -1.01858275e-03,
#        -1.01858275e-03, -1.01858275e-03]), array([ 3.16306705e+00,  3.61246643e+00, -3.27352246e-03, -3.27352246e-03,
#        -3.27352246e-03, -3.27352246e-03]), array([-1.85462572e+01, -2.00486262e+01, -1.27278780e-03, -1.27278780e-03,
#        -1.27278780e-03, -1.27278780e-03]), array([-1.51176223e+01, -1.59595914e+01, -1.16902540e-03, -1.16902540e-03,
#        -1.16902540e-03, -1.16902540e-03]), array([ 7.71680834,  7.79582846, -0.01062652, -0.01062652, -0.01062652,
#        -0.01062652]), array([-7.66073142, -7.85723853, -0.01215467, -0.01215467, -0.01215467,
#        -0.01215467]), array([-2.54265605e+01, -2.60682365e+01, -8.76198123e-03, -8.76198123e-03,
#        -8.76198123e-03, -8.76198123e-03]), array([ 1.18065202e+01,  1.18898622e+01, -4.97056264e-03, -4.97056264e-03,
#        -4.97056264e-03, -4.97056264e-03]), array([ 1.67488074e+01,  1.66118275e+01, -4.70361925e-03, -4.70361925e-03,
#        -4.70361925e-03, -4.70361925e-03]), array([-8.85362916e+00, -9.06336441e+00, -7.73473513e-03, -7.73473513e-03,
#        -7.73473513e-03, -7.73473513e-03]), array([-2.10590615e+01, -2.14000229e+01, -3.66552406e-03, -3.66552406e-03,
#        -3.66552406e-03, -3.66552406e-03]), array([-2.96919756e+01, -2.96284549e+01, -3.48067052e-03, -3.48067052e-03,
#        -3.48067052e-03, -3.48067052e-03]), array([-2.90722321e+01, -2.89181344e+01, -8.63177647e-03, -8.63177647e-03,
#        -8.63177647e-03, -8.63177647e-03]), array([-9.61777217, -9.32392517, -0.00981999, -0.00981999, -0.00981999,
#        -0.00981999]), array([ 2.94451877e+01,  2.92018426e+01, -9.22913027e-03, -9.22913027e-03,
#        -9.22913027e-03, -9.22913027e-03]), array([ 3.15455665e+01,  3.16254793e+01, -8.72711647e-03, -8.72711647e-03,
#        -8.72711647e-03, -8.72711647e-03]), array([-4.06293779, -4.1267437 , -0.01221418, -0.01221418, -0.01221418,
#        -0.01221418]), array([-11.66196855, -11.81200309,  -0.01225201,  -0.01225201,
#         -0.01225201,  -0.01225201]), array([-1.61952980e+01, -1.63896719e+01, -1.13753525e-02, -1.13753525e-02,
#        -1.13753525e-02, -1.13753525e-02]), array([-2.37044158e+01, -2.39246213e+01, -1.14052081e-02, -1.14052081e-02,
#        -1.14052081e-02, -1.14052081e-02]), array([-1.57871661e+01, -1.59130191e+01, -1.30426135e-02, -1.30426135e-02,
#        -1.30426135e-02, -1.30426135e-02]), array([-7.8120001 , -7.83587413, -0.01288865, -0.01288865, -0.01288865,
#        -0.01288865]), array([ 1.92472824,  1.94865435, -0.01391146, -0.01391146, -0.01391146,
#        -0.01391146]), array([-3.01176581, -3.06229463, -0.01400728, -0.01400728, -0.01400728,
#        -0.01400728]), array([-1.36337534e+01, -1.38366437e+01, -1.33095930e-02, -1.33095930e-02,
#        -1.33095930e-02, -1.33095930e-02]), array([-5.06480741, -5.11484895, -0.01371294, -0.01371294, -0.01371294,
#        -0.01371294]), array([ 8.82349178,  8.96670348, -0.01388072, -0.01388072, -0.01388072,
#        -0.01388072]), array([ 1.46444717e+01,  1.49399981e+01, -1.33270166e-02, -1.33270166e-02,
#        -1.33270166e-02, -1.33270166e-02]), array([ 1.69339699,  1.70945665, -0.01317602, -0.01317602, -0.01317602,
#        -0.01317602]), array([-6.13384237, -6.27619465, -0.01347165, -0.01347165, -0.01347165,
#        -0.01347165]), array([-1.38483526e+01, -1.41641446e+01, -1.22869510e-02, -1.22869510e-02,
#        -1.22869510e-02, -1.22869510e-02]), array([-1.74945882e+01, -1.78289814e+01, -1.23449145e-02, -1.23449145e-02,
#        -1.23449145e-02, -1.23449145e-02]), array([-6.28018247, -6.38738485, -0.01390054, -0.01390054, -0.01390054,
#        -0.01390054]), array([-4.00596163, -4.06522821, -0.0139156 , -0.0139156 , -0.0139156 ,
#        -0.0139156 ]), array([ 3.52095994,  3.58616819, -0.01410771, -0.01410771, -0.01410771,
#        -0.01410771]), array([ 1.26613805e+01,  1.29510767e+01, -1.28866681e-02, -1.28866681e-02,
#        -1.28866681e-02, -1.28866681e-02]), array([ 3.48501137,  3.49831212, -0.01195555, -0.01195555, -0.01195555,
#        -0.01195555]), array([-4.22661989, -4.33204502, -0.0129534 , -0.0129534 , -0.0129534 ,
#        -0.0129534 ]), array([-1.57157172e+01, -1.60960825e+01, -1.03775981e-02, -1.03775981e-02,
#        -1.03775981e-02, -1.03775981e-02]), array([-1.33154621e+01, -1.35558086e+01, -1.02826259e-02, -1.02826259e-02,
#        -1.02826259e-02, -1.02826259e-02]), array([-3.77744266, -3.82651703, -0.01317382, -0.01317382, -0.01317382,
#        -0.01317382]), array([-4.54833452, -4.60632769, -0.01331778, -0.01331778, -0.01331778,
#        -0.01331778]), array([-9.3247842 , -9.43211011, -0.01272783, -0.01272783, -0.01272783,
#        -0.01272783]), array([-4.02299541, -4.06629803, -0.01253609, -0.01253609, -0.01253609,
#        -0.01253609]), array([-4.05097368, -4.10121852, -0.01254551, -0.01254551, -0.01254551,
#        -0.01254551]), array([-5.24452858, -5.29445291, -0.01320385, -0.01320385, -0.01320385,
#        -0.01320385]), array([-9.33734608, -9.42597495, -0.01197785, -0.01197785, -0.01197785,
#        -0.01197785]), array([-1.21992646e+01, -1.22668065e+01, -1.21450000e-02, -1.21450000e-02,
#        -1.21450000e-02, -1.21450000e-02]), array([-4.65427412, -4.663025  , -0.01346315, -0.01346315, -0.01346315,
#        -0.01346315]), array([-7.23338496, -7.25631352, -0.01303947, -0.01303947, -0.01303947,
#        -0.01303947]), array([-0.84822769, -0.84203494, -0.01372975, -0.01372975, -0.01372975,
#        -0.01372975]), array([-0.87960739, -0.88199002, -0.01297516, -0.01297516, -0.01297516,
#        -0.01297516]), array([-1.45434594, -1.48301171, -0.0126291 , -0.0126291 , -0.0126291 ,
#        -0.0126291 ]), array([-6.53545655, -6.59125421, -0.01265958, -0.01265958, -0.01265958,
#        -0.01265958]), array([-9.75025413, -9.81820528, -0.01180467, -0.01180467, -0.01180467,
#        -0.01180467]), array([-0.61486875, -0.64596092, -0.01019014, -0.01019014, -0.01019014,
#        -0.01019014]), array([ 0.69408647,  0.60446305, -0.01008878, -0.01008878, -0.01008878,
#        -0.01008878]), array([-6.55327814, -6.59673164, -0.01125849, -0.01125849, -0.01125849,
#        -0.01125849]), array([-1.36503651e+01, -1.36845447e+01, -8.31724712e-03, -8.31724712e-03,
#        -8.31724712e-03, -8.31724712e-03]), array([-2.18225427e+01, -2.16249109e+01, -8.38242881e-03, -8.38242881e-03,
#        -8.38242881e-03, -8.38242881e-03]), array([-1.46495578e+01, -1.44943251e+01, -1.18085766e-02, -1.18085766e-02,
#        -1.18085766e-02, -1.18085766e-02]), array([-6.00315766, -5.82978694, -0.01186639, -0.01186639, -0.01186639,
#        -0.01186639]), array([11.77642105, 11.65524156, -0.01276519, -0.01276519, -0.01276519,
#        -0.01276519]), array([ 1.28918585e+01,  1.28625205e+01, -1.25701009e-02, -1.25701009e-02,
#        -1.25701009e-02, -1.25701009e-02]), array([-4.63769257, -4.66089693, -0.01297822, -0.01297822, -0.01297822,
#        -0.01297822]), array([-6.53841224, -6.5719853 , -0.01307583, -0.01307583, -0.01307583,
#        -0.01307583]), array([-5.69792103, -5.72584687, -0.01292789, -0.01292789, -0.01292789,
#        -0.01292789]), array([-1.28217940e+01, -1.28730544e+01, -1.28202833e-02, -1.28202833e-02,
#        -1.28202833e-02, -1.28202833e-02]), array([-6.68198836, -6.70351692, -0.01360637, -0.01360637, -0.01360637,
#        -0.01360637]), array([-6.62228904, -6.63120467, -0.01318633, -0.01318633, -0.01318633,
#        -0.01318633]), array([ 4.44071304,  4.47419402, -0.01395413, -0.01395413, -0.01395413,
#        -0.01395413]), array([-1.63292675, -1.65082689, -0.01407699, -0.01407699, -0.01407699,
#        -0.01407699]), array([-4.03003744, -4.06993751, -0.0139362 , -0.0139362 , -0.0139362 ,
#        -0.0139362 ]), array([-4.80847295, -4.85395656, -0.01361827, -0.01361827, -0.01361827,
#        -0.01361827]), array([ 1.07277026,  1.08915892, -0.01410214, -0.01410214, -0.01410214,
#        -0.01410214]), array([-2.59704273, -2.63370926, -0.01413325, -0.01413325, -0.01413325,
#        -0.01413325]), array([-4.02955415, -4.08969829, -0.01399018, -0.01399018, -0.01399018,
#        -0.01399018]), array([-3.160397  , -3.20486266, -0.01399641, -0.01399641, -0.01399641,
#        -0.01399641]), array([ 1.79314502,  1.82772273, -0.01415844, -0.01415844, -0.01415844,
#        -0.01415844]), array([ 8.69915858,  8.87678812, -0.01285906, -0.01285906, -0.01285906,
#        -0.01285906]), array([ 4.67780799,  4.69293649, -0.01169099, -0.01169099, -0.01169099,
#        -0.01169099]), array([-4.18874442, -4.28722877, -0.0126134 , -0.0126134 , -0.0126134 ,
#        -0.0126134 ]), array([-1.18148669e+01, -1.20779364e+01, -1.03000802e-02, -1.03000802e-02,
#        -1.03000802e-02, -1.03000802e-02]), array([7.12205524e+02, 7.18854334e+02, 3.74953757e-01, 3.74953757e-01,
#        3.74953757e-01, 3.74953757e-01]), array([5.83413625e+00, 4.74859046e+00, 4.41803386e-05, 4.41803386e-05,
#        4.41803386e-05, 4.41803386e-05]), array([-4.67827460e-01, -5.32847808e-01, -2.24937339e-04, -2.24937339e-04,
#        -2.24937339e-04, -2.24937339e-04]), array([-1.51171707e+00, -1.58854439e+00, -6.18520629e-05, -6.18520629e-05,
#        -6.18520629e-05, -6.18520629e-05]), array([-4.37011075e+00, -3.54935085e+00, -4.50479647e-05, -4.50479647e-05,
#        -4.50479647e-05, -4.50479647e-05]), array([-9.84269279e+00, -9.27459071e+00, -1.83732786e-05, -1.83732786e-05,
#        -1.83732786e-05, -1.83732786e-05]), array([ 3.68910033e-01,  8.94376245e-01, -1.94053824e-04, -1.94053824e-04,
#        -1.94053824e-04, -1.94053824e-04]), array([ 5.37963571e+00,  4.41300733e+00, -6.81690747e-05, -6.81690747e-05,
#        -6.81690747e-05, -6.81690747e-05]), array([ 5.52706808e+00,  5.22987320e+00, -6.02802436e-05, -6.02802436e-05,
#        -6.02802436e-05, -6.02802436e-05]), array([ 3.37441833e+01,  3.53723158e+01, -1.05944291e-02, -1.05944291e-02,
#        -1.05944291e-02, -1.05944291e-02]), array([ 1.07761034e+01,  1.13962864e+01, -1.10204042e-02, -1.10204042e-02,
#        -1.10204042e-02, -1.10204042e-02]), array([-3.36463441e+01, -3.54562404e+01, -1.04582887e-02, -1.04582887e-02,
#        -1.04582887e-02, -1.04582887e-02]), array([ 1.01627767e+01,  1.06376341e+01, -7.03071616e-03, -7.03071616e-03,
#        -7.03071616e-03, -7.03071616e-03]), array([ 2.71405889e+01,  2.80947249e+01, -6.41907884e-03, -6.41907884e-03,
#        -6.41907884e-03, -6.41907884e-03]), array([-0.47180382, -0.3895867 , -0.00927304, -0.00927304, -0.00927304,
#        -0.00927304]), array([-2.79346208e+01, -2.93165921e+01, -5.29550306e-03, -5.29550306e-03,
#        -5.29550306e-03, -5.29550306e-03]), array([ 1.20978778e+01,  1.22765072e+01, -2.08731707e-03, -2.08731707e-03,
#        -2.08731707e-03, -2.08731707e-03]), array([ 2.49318552e+01,  2.48976646e+01, -1.56991838e-03, -1.56991838e-03,
#        -1.56991838e-03, -1.56991838e-03]), array([-6.35723542e+00, -6.56710454e+00, -5.02495410e-03, -5.02495410e-03,
#        -5.02495410e-03, -5.02495410e-03]), array([-1.63313260e+01, -1.68048085e+01, -1.85042608e-03, -1.85042608e-03,
#        -1.85042608e-03, -1.85042608e-03]), array([-2.23018943e+01, -2.22230830e+01, -1.62112204e-03, -1.62112204e-03,
#        -1.62112204e-03, -1.62112204e-03]), array([-2.86834286e+01, -2.85776570e+01, -4.89703812e-03, -4.89703812e-03,
#        -4.89703812e-03, -4.89703812e-03]), array([-5.90328614, -5.52211422, -0.0071188 , -0.0071188 , -0.0071188 ,
#        -0.0071188 ]), array([ 2.70931829e+01,  2.66371081e+01, -4.48698121e-03, -4.48698121e-03,
#        -4.48698121e-03, -4.48698121e-03]), array([ 2.14203603e+01,  2.13685475e+01, -4.13468973e-03, -4.13468973e-03,
#        -4.13468973e-03, -4.13468973e-03]), array([-1.25965691e+01, -1.28988690e+01, -1.28773939e-02, -1.28773939e-02,
#        -1.28773939e-02, -1.28773939e-02]), array([-3.27934609, -3.30954849, -0.01320496, -0.01320496, -0.01320496,
#        -0.01320496]), array([ 1.66579563e+01,  1.69639640e+01, -1.22907748e-02, -1.22907748e-02,
#        -1.22907748e-02, -1.22907748e-02]), array([ 2.51726939e+01,  2.58511040e+01, -1.16902181e-02, -1.16902181e-02,
#        -1.16902181e-02, -1.16902181e-02]), array([ 2.0014325 ,  2.05273049, -0.01368565, -0.01368565, -0.01368565,
#        -0.01368565]), array([ 0.33712857,  0.34984825, -0.01394042, -0.01394042, -0.01394042,
#        -0.01394042]), array([-1.26934369e+01, -1.31083582e+01, -1.30892014e-02, -1.30892014e-02,
#        -1.30892014e-02, -1.30892014e-02]), array([-7.01400568, -7.22671791, -0.01319524, -0.01319524, -0.01319524,
#        -0.01319524]), array([ 2.50370472,  2.57067048, -0.01385171, -0.01385171, -0.01385171,
#        -0.01385171]), array([-2.6289081 , -2.70287737, -0.01400201, -0.01400201, -0.01400201,
#        -0.01400201]), array([-6.89184203, -7.09853286, -0.01366262, -0.01366262, -0.01366262,
#        -0.01366262]), array([ 2.99118192,  3.06602381, -0.01199471, -0.01199471, -0.01199471,
#        -0.01199471]), array([ 7.21565012,  7.31577903, -0.01144358, -0.01144358, -0.01144358,
#        -0.01144358]), array([-4.57312185, -4.6993536 , -0.01262107, -0.01262107, -0.01262107,
#        -0.01262107]), array([-1.59617981e+01, -1.64139100e+01, -9.87464286e-03, -9.87464286e-03,
#        -9.87464286e-03, -9.87464286e-03]), array([-1.33211904e+01, -1.36044811e+01, -9.32977078e-03, -9.32977078e-03,
#        -9.32977078e-03, -9.32977078e-03]), array([-1.17354102, -1.20522363, -0.01282398, -0.01282398, -0.01282398,
#        -0.01282398]), array([-5.79976721, -5.87566489, -0.01317335, -0.01317335, -0.01317335,
#        -0.01317335]), array([-8.72425941, -8.8382313 , -0.01229987, -0.01229987, -0.01229987,
#        -0.01229987]), array([5.24257914e+01, 5.27528484e+01, 8.37453560e-03, 8.37453560e-03,
#        8.37453560e-03, 8.37453560e-03]), array([ 1.61187299e+01,  1.55374904e+01, -1.21188290e-03, -1.21188290e-03,
#        -1.21188290e-03, -1.21188290e-03]), array([-4.32402496e+00, -4.45547604e+00, -4.30838717e-03, -4.30838717e-03,
#        -4.30838717e-03, -4.30838717e-03]), array([-9.49472879e+00, -9.61458557e+00, -1.54118932e-03, -1.54118932e-03,
#        -1.54118932e-03, -1.54118932e-03]), array([-1.15638871e+01, -1.11939984e+01, -1.47709243e-03, -1.47709243e-03,
#        -1.47709243e-03, -1.47709243e-03]), array([-1.96576220e+01, -1.84976798e+01, -7.81762700e-03, -7.81762700e-03,
#        -7.81762700e-03, -7.81762700e-03]), array([-7.97158082e+00, -7.26169642e+00, -7.49388244e-03, -7.49388244e-03,
#        -7.49388244e-03, -7.49388244e-03]), array([ 6.1296837 ,  6.00228663, -0.01108162, -0.01108162, -0.01108162,
#        -0.01108162]), array([-5.04142911e+01, -4.89316834e+01,  2.55896307e-03,  2.55896307e-03,
#         2.55896307e-03,  2.55896307e-03]), array([-2.30348000e+01, -2.30141830e+01, -2.37662922e-03, -2.37662922e-03,
#        -2.37662922e-03, -2.37662922e-03]), array([-2.22014091, -1.86202555, -0.00496447, -0.00496447, -0.00496447,
#        -0.00496447]), array([ 1.81530674e+01,  1.76256005e+01, -2.29553564e-03, -2.29553564e-03,
#        -2.29553564e-03, -2.29553564e-03]), array([ 2.12487788e+01,  2.14560333e+01, -1.87247983e-03, -1.87247983e-03,
#        -1.87247983e-03, -1.87247983e-03]), array([ 1.85171125e+01,  1.86632102e+01, -4.50813077e-03, -4.50813077e-03,
#        -4.50813077e-03, -4.50813077e-03]), array([-4.96787325, -5.13457922, -0.00802951, -0.00802951, -0.00802951,
#        -0.00802951]), array([-1.81938354e+01, -1.88188367e+01, -3.61118687e-03, -3.61118687e-03,
#        -3.61118687e-03, -3.61118687e-03]), array([4.00313236e+01, 4.00483950e+01, 2.05533553e-03, 2.05533553e-03,
#        2.05533553e-03, 2.05533553e-03]), array([ 1.74225396e+01,  1.64838683e+01, -5.69407120e-05, -5.69407120e-05,
#        -5.69407120e-05, -5.69407120e-05]), array([-3.29338137e+00, -3.41478114e+00, -1.72559400e-03, -1.72559400e-03,
#        -1.72559400e-03, -1.72559400e-03]), array([-7.19581151e+00, -7.23598540e+00, -5.21918804e-04, -5.21918804e-04,
#        -5.21918804e-04, -5.21918804e-04]), array([-1.28932731e+01, -1.20561018e+01, -3.59886589e-04, -3.59886589e-04,
#        -3.59886589e-04, -3.59886589e-04]), array([-1.73583833e+01, -1.70601834e+01, -2.25844295e-04, -2.25844295e-04,
#        -2.25844295e-04, -2.25844295e-04]), array([-0.49207745, -0.0116255 , -0.00120415, -0.00120415, -0.00120415,
#        -0.00120415]), array([ 1.05310716e+01,  9.72764102e+00, -4.45236501e-04, -4.45236501e-04,
#        -4.45236501e-04, -4.45236501e-04]), array([ 1.09352522e+01,  1.08068355e+01, -3.92983856e-04, -3.92983856e-04,
#        -3.92983856e-04, -3.92983856e-04]), array([ 1.93699555e+01,  1.99685141e+01, -9.19626945e-03, -9.19626945e-03,
#        -9.19626945e-03, -9.19626945e-03]), array([-0.9091689 , -0.89807529, -0.01130966, -0.01130966, -0.01130966,
#        -0.01130966]), array([-2.70103902e+01, -2.81573325e+01, -7.47818842e-03, -7.47818842e-03,
#        -7.47818842e-03, -7.47818842e-03]), array([-2.91932176e+01, -3.01352929e+01, -7.22078526e-03, -7.22078526e-03,
#        -7.22078526e-03, -7.22078526e-03]), array([-5.40664986, -5.54951734, -0.01394482, -0.01394482, -0.01394482,
#        -0.01394482]), array([-2.71298009, -2.78074915, -0.0140638 , -0.0140638 , -0.0140638 ,
#        -0.0140638 ]), array([ 9.06129965,  9.29213057, -0.01376619, -0.01376619, -0.01376619,
#        -0.01376619]), array([ 2.15242889e+01,  2.22037522e+01, -1.22181905e-02, -1.22181905e-02,
#        -1.22181905e-02, -1.22181905e-02]), array([10.19524254, 10.41900107, -0.01124664, -0.01124664, -0.01124664,
#        -0.01124664]), array([-4.01934851, -4.13900378, -0.01264046, -0.01264046, -0.01264046,
#        -0.01264046]), array([-1.94907693e+01, -2.01453659e+01, -9.57493441e-03, -9.57493441e-03,
#        -9.57493441e-03, -9.57493441e-03]), array([-1.56511066e+01, -1.60731116e+01, -9.23792467e-03, -9.23792467e-03,
#        -9.23792467e-03, -9.23792467e-03]), array([ 0.07302433,  0.05663176, -0.01305416, -0.01305416, -0.01305416,
#        -0.01305416]), array([-5.00386177, -5.10397044, -0.01339335, -0.01339335, -0.01339335,
#        -0.01339335]), array([-10.80811516, -11.01578827,  -0.01253052,  -0.01253052,
#         -0.01253052,  -0.01253052]), array([ 8.16361988,  8.24138518, -0.00875771, -0.00875771, -0.00875771,
#        -0.00875771]), array([ 7.62120502,  7.50692127, -0.00795384, -0.00795384, -0.00795384,
#        -0.00795384]), array([ 1.45199505,  1.26328631, -0.00919057, -0.00919057, -0.00919057,
#        -0.00919057]), array([-1.20991340e+01, -1.23952398e+01, -5.39982508e-03, -5.39982508e-03,
#        -5.39982508e-03, -5.39982508e-03]), array([-2.84845689e+01, -2.81968326e+01, -4.41947064e-03, -4.41947064e-03,
#        -4.41947064e-03, -4.41947064e-03]), array([-2.05095210e+01, -2.05533223e+01, -4.59502520e-03, -4.59502520e-03,
#        -4.59502520e-03, -4.59502520e-03]), array([9.18335469e+01, 9.23971796e+01, 2.50489660e-02, 2.50489660e-02,
#        2.50489660e-02, 2.50489660e-02]), array([ 1.07761857e+01,  1.01626276e+01, -7.26767230e-05, -7.26767230e-05,
#        -7.26767230e-05, -7.26767230e-05]), array([-7.03636875e+00, -6.07620256e+00, -6.34739652e-04, -6.34739652e-04,
#        -6.34739652e-04, -6.34739652e-04]), array([-6.05561415e+00, -6.16938712e+00, -2.49025400e-04, -2.49025400e-04,
#        -2.49025400e-04, -2.49025400e-04]), array([-4.68012082e+00, -4.44336892e+00, -2.50734395e-04, -2.50734395e-04,
#        -2.50734395e-04, -2.50734395e-04]), array([ 9.21013290e+00,  8.03058969e+00, -7.07318696e-04, -7.07318696e-04,
#        -7.07318696e-04, -7.07318696e-04]), array([ 1.09743660e+01,  1.05147349e+01, -6.33707497e-04, -6.33707497e-04,
#        -6.33707497e-04, -6.33707497e-04]), array([ 2.57312440e+01,  2.59960697e+01, -6.66786808e-03, -6.66786808e-03,
#        -6.66786808e-03, -6.66786808e-03]), array([ 2.54738952e+01,  2.60534772e+01, -6.15783636e-03, -6.15783636e-03,
#        -6.15783636e-03, -6.15783636e-03]), array([-8.44206584, -8.81914732, -0.01159403, -0.01159403, -0.01159403,
#        -0.01159403]), array([-1.87156726e+01, -1.92770194e+01, -1.20186207e-02, -1.20186207e-02,
#        -1.20186207e-02, -1.20186207e-02]), array([-1.69441551e+01, -1.74262703e+01, -1.18847673e-02, -1.18847673e-02,
#        -1.18847673e-02, -1.18847673e-02]), array([-2.93778579, -3.00145912, -0.01074094, -0.01074094, -0.01074094,
#        -0.01074094]), array([ 9.66775731,  9.81083504, -0.01150619, -0.01150619, -0.01150619,
#        -0.01150619]), array([-6.54524616, -6.61598124, -0.01252365, -0.01252365, -0.01252365,
#        -0.01252365]), array([-1.96625530e+01, -2.01490490e+01, -9.84410881e-03, -9.84410881e-03,
#        -9.84410881e-03, -9.84410881e-03]), array([-1.52343454e+01, -1.55064189e+01, -9.61308492e-03, -9.61308492e-03,
#        -9.61308492e-03, -9.61308492e-03]), array([ 9.44246016,  9.55092795, -0.01335854, -0.01335854, -0.01335854,
#        -0.01335854])]

def test_gradient_s():
    arch = Arch()
    x = y_streamflow_395
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha = [35.19315819, 0.9220255, 0., 3.8679039]
    theta = phi + alpha
    gradient = arch.gradient_s(x, theta, p, q)
    print("gradient")
    print(gradient)
# gradient
# [-1619.12801894 -1640.28632029    -3.43881184    -3.4317577
#     -3.44010076    -3.45012194]

def test_residual_divide_delta_mean_std():
    arch = Arch()
    residual = y_residual_streamflow_395
    phi = [1.86818005, -0.87194949]
    alpha = [35.19315819, 0.9220255, 0., 3.8679039]
    theta = phi + alpha
    delta_2 = arch.delta_2(y_residual_2_streamflow_395, alpha)
    delta = np.sqrt(delta_2)
    mean, std = arch.residual_divide_delta_mean_std(residual, delta)
    print("mean")
    print(mean)
    print("std")
    print(std)
# mean
# 0.161609753502022
# std
# 0.829115257619602

def test_arima_arch():
    arch = Arch()
    x = y_streamflow_395
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [35.19315819, 0.9220255, 0., 3.8679039]
    theta = phi + alpha
    mean, std = arch.arima_arch(x, theta, p, q)
    print("mean")
    print(mean)
    print("std")
    print(std)
# mean
# 0.16160932078025916
# std
# 0.8291152060653459

def test_log_likelihood_gamma():
    arch = Arch()
    x = y_streamflow_395
    p = 2
    q = 3
    v = 3
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    theta = phi + alpha
    residual_2 = y_residual_2_streamflow_395
    L_theta = arch.log_likelihood_gamma(v, residual_2, theta, p, q)
    print("L_theta")
    print(L_theta)
# L_theta
# -932.9348379994717

def test_mL_estimation():
    arch = Arch()
    x = 0
    y = 0
    e = 0.05
    lnLt = arch.mL_estimation(x, y, e)
    print("lnLt")
    print(lnLt)


def test_garch_one_step():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    h = [1, 2]
    arch = Arch()
    y_residual_2 = np.power(y_residual, 2)
    eta = [0.5, 0.5]
    alpha = [1.1, 0.5, -0.5]
    epsilon_t, h_t = arch.garch_one_step(h, y_residual_2, eta, alpha, e)
    print("epsilon_t")
    print(epsilon_t)
    print("h_t")
    print(h_t)

def test_garch():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    y_residual_2 = np.power(y_residual, 2)
    p = 2
    q = 2
    eta = [0.5, 0.5]
    alpha = [1.1, 0.5, -0.5]
    epsilon_t = arch.garch(y_residual_2, e, eta, alpha, p, q)
    print("epsilon_t")
    print(epsilon_t)

def test_garch_least_squares_estimation():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    h = [1, 1]
    y_residual_2 = np.power(y_residual, 2)
    y_residual_2 = y_residual_2.tolist()
    p = 2
    q = 2
    a, R_2 = arch.garch_least_squares_estimation(h, y_residual_2, e, p, q)
    print("a")
    print(a)
    print("R_2")
    print(R_2)

def ar1(
    x,
    phi,
    c,
    e,
):
    """AR(1)"""
    x_t = c + phi * x + e

    return x_t

def arch_ordinary_least_squares_estimation():
    """
    estimation of ARCH(q) models by ordinary least squares.
    Returns
    -------

    """


def test_ar1():
    x = [0.8, 0.2, -1.2, -0.4, 0.0]

