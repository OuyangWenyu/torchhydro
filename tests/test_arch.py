import numpy as np
from hydrodataset import CamelsYstl
from torchhydro.datasets.arch import Arch
from tests.test_arch_data import (
    e_42, e_42_original, e_60, e_100, e_395, e_500, e_1000, e_1460,
    y_arma_3_100, y_residual_arma_3_p3d0q3_100,
    y_streamflow_100, y_streamflow_395, y_residual_streamflow_395, y_residual_2_streamflow_395,
    y_streamflow_1460, y_residual_streamflow_1460, y_residual_2_streamflow_1460,
    y_streamflow_395_itp,
    y_streamflow_395_Omege, y_streamflow_1460_Omege,
    y_residual_2_streamflow_395_1,
)

class Ystl(object):
    def __init__(self):
        self.datasource = CamelsYstl()
        self.basin = ["1000",]
        self.time_range = ["1990-01-01","1994-01-01"]
        self.var_list = ["streamflow", "discharge_vol1", "discharge_vol2", "discharge_vol3",]
        self.pet_list = ["pet"]
        self.prcp_list = ["prcp"]
        self.streamflow = None
        self.prcp = None
        self.pet = None
        self.read_streamflow()
        # self.read_prcp()
        # self.read_pet()

    def read_streamflow(self):
        data = self.datasource.read_ts_xrdataset(
            self.basin,
            self.time_range,
            self.var_list,
        )
        data1 = data.streamflow.to_dataframe()
        # data2 = data.discharge_vol1.to_dataframe()
        # data3 = data.discharge_vol2.to_dataframe()
        # data4 = data.discharge_vol3.to_dataframe()
        # data1.drop(axis=0, index=("1000", "1992-02-29"), inplace=True)
        # data2.drop(axis=0, index=("1000", "1992-02-29"), inplace=True)
        # data3.drop(axis=0, index=("1000", "1992-02-29"), inplace=True)
        # data4.drop(axis=0, index=("1000", "1992-02-29"), inplace=True)
        data1 = data1.values[:, 0]
        # data2 = data2.values[:, 0]
        # data3 = data3.values[:, 0]
        # data4 = data4.values[:, 0]
        data_ = data1.tolist()  # + data2.tolist() + data3.tolist() + data4.tolist()
        self.streamflow = data_  # + data_

def test_cov():
    x = [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25]
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]
    arch = Arch()
    cov_xy = arch.cov(x, y)
    print(cov_xy)
# 112.0

def test_correlation_coefficient():
    x = [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25]
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]
    arch = Arch()
    cf_xy = arch.correlation_coefficient(x, y)
    print(cf_xy)
# 1.0

def test_autocorrelation_coefficient():
    x = [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25]
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]
    arch = Arch()
    acf_x = arch.autocorrelation_coefficient(x, 0)
    acf_y = arch.autocorrelation_coefficient(y, 0)
    print("acf_x")
    print(acf_x)
    print("acf_y")
    print(acf_y)
# acf_x  p=0
# 1.0
# acf_y
# 1.0
# acf_x  p=1
# 0.7692307692307692
# acf_y
# 0.7692307692307692
# acf_x  p=2
# 0.543956043956044
# acf_y
# 0.543956043956044

def test_autocorrelation_function():
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]  # 13
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    y_non_stationary = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49,
                        47, 53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    acf_y = arch.autocorrelation_function(y_residual_streamflow_1460, 500)
    print("acf_y")
    print(acf_y)
# acf_y  y_streamflow_100
# [1.0, 0.4890217866079111, 0.3730435325796203, 0.30943171756125193, 0.2903743490414458, 0.2527380292429242,
#  0.22716180864275232, 0.201260054027222, 0.17799776823752736, 0.161526129486014, 0.15922140814570662,
#  0.16479811526698018, 0.14814069021275406, 0.10396022090655761, 0.10756174327598879, 0.1159200114033717,
#  0.09532994462046454, 0.0737327012245338, 0.0607135930433197, 0.04689502511205941, 0.04358534730555633,
#  0.05028332135152962, 0.06620434569109297, 0.08901400134251614, 0.12600021297823052, 0.1497104874726196,
#  0.14870136607406342, 0.08687728972936505, -0.02465822041046203, -0.035884808206033784, -0.04764973197177684,
#  -0.060146343023873776, -0.07080382545122141, -0.07734197898525726, -0.07731508598397653, -0.07019732141743823,
#  -0.060750990224451414, -0.06066294530597317, -0.0572185180396532, -0.04266840328598805, -0.03843981978902132,
#  -0.04537584163326208, -0.055028190390885426, -0.06126381760750669, -0.06359274253763472, -0.05978966182367262,
#  -0.055868205441495414, -0.057661770678519936, -0.05435524208488426, -0.020390510188813268, 0.0695531457689958,
#  0.15828655265323596, -0.002858335965718018, -0.09195051913397304, -0.10091445816022428, -0.09354964960831892,
#  -0.08774669254716466, -0.08653614399035475, -0.09262396398096126, -0.10651991047714839, -0.112897773677954,
#  -0.11353825607086294, -0.11371448284625305, -0.11159937429155692, -0.10999820143057237, -0.10632281858930692,
#  -0.1008519196022209, -0.09532138652502058, -0.0935769126031454, -0.10788807665553737, -0.1248659979494118,
#  -0.12465016794812338, -0.12351870226452377, -0.11683269270392024, -0.10821073552044914, -0.10173997072560591,
#  -0.09709867000494606]

def test_partial_autocorrelation_coefficient():
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]  # 13
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    y_non_stationary = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49,
                        47, 53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    r_k = [1, 0.909385243, 0.858581821, 0.769086258, 0.718442721, 0.630705892, 0.58086178, 0.495523223, 0.447118075,
           0.364817332, 0.318490687, 0.239867296, 0.196258694, 0.121952194, 0.081701175, 0.012351107, -0.02390279,
           -0.087656887, -0.119274123, -0.176792709, -0.203133744, -0.25377728, -0.274202574, -0.317331521,
           -0.331201535, -0.366176353, -0.372851547, -0.399032696, -0.397873531, -0.414621473, -0.404988408,
           -0.411663602]
    r_k_1 = r_k[:1]
    pacc_k = arch.partial_autocorrelation_coefficient(r_k_1)
    print("pacc_k")
    print(pacc_k)
# pacc_k k=1
# 0.909385243

def test_partial_autocorrelation_function():
    y = [3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51]  # 13
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    y_non_stationary = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49,
                        47, 53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    pacf_y= arch.partial_autocorrelation_function(y_residual_streamflow_1460, 500)
    print("pacf_y")
    print(pacf_y)
# pacf_y  y_streamflow_100
# [ 1.00000000e+00  4.89021787e-01  1.75987213e-01  9.31707703e-02
#   8.74213878e-02  3.96493886e-02  3.02744689e-02  1.69247427e-02
#   8.81097249e-03  9.87713548e-03  2.16151652e-02  3.02773406e-02
#   5.53302329e-03 -3.16597373e-02  1.09679441e-02  1.98711211e-02
#  -9.17391470e-03 -1.33746584e-02 -8.30007167e-03 -1.01007508e-02
#   3.86111484e-04  1.13989368e-02  2.30387193e-02  3.45720381e-02
#   5.33592269e-02  4.25830310e-02  1.37520316e-02 -5.80584156e-02
#  -1.24166931e-01 -3.17693461e-02 -2.09489384e-02 -1.47528068e-02
#  -7.93819775e-03 -6.81790754e-03 -1.80482597e-03  3.00300090e-03
#   5.91434517e-03  1.65269969e-03  8.79113146e-03  2.04966292e-02
#   6.34297204e-03 -8.28148541e-03 -5.38688499e-03 -2.81345233e-03
#  -5.72683777e-03 -4.44123033e-03 -7.22476478e-03 -1.49303173e-02
#  -9.40180699e-03  2.39935568e-02  9.07354248e-02  1.19926563e-01
#  -1.32628916e-01 -8.55978421e-02 -1.62353922e-02 -7.76425574e-03
#  -2.53344343e-03 -1.62209507e-03 -9.26597998e-03 -2.16341430e-02
#  -2.37341242e-02 -2.28490757e-02 -1.42089767e-02  4.89734415e-03
#   7.52019068e-03 -7.86979126e-03 -3.42187775e-04  1.67428851e-02
#   1.19367100e-02 -1.16136354e-02 -2.12515114e-02 -1.37671123e-02
#  -1.77814042e-02 -1.53637871e-02 -1.58891374e-02 -1.69086598e-02
#  -5.92238178e-04]

def test_autocorrelation_function_streamflow():
    ystl = Ystl()
    y = ystl.streamflow[:60]
    arch = Arch()
    acf_y = arch.autocorrelation_function(y)
    print("acf_y")
    print(acf_y)
# acf_y_60
# [1.0, 0.8572761620454818, 0.6385768912931514, 0.5050825841013289, 0.44653638403995016, 0.4185441902455531,
#  0.3865704425932139, 0.33706325563399486, 0.2718288785083308, 0.20527471190164556, 0.14627775907318724,
#  0.090195274986454, 0.040649454864340455, 0.020467989378790626, 0.01871623720512344, 0.02399900366360696,
#  0.027130568269475144, 0.015336252842722938, -0.021977685513096576, -0.06831296879203817, -0.09906441374961863,
#  -0.11806218551925013, -0.132441375577407, -0.14502085223578084, -0.1573314825368771, -0.16912342792631613,
#  -0.17980271594051625, -0.1887652012662332, -0.19558386433073563, -0.19946329936429272, -0.19970940673656967,
#  -0.1975305617182452, -0.19417913728434713, -0.19175009440569452, -0.18961722932044892, -0.18499561862816008,
#  -0.17966357456806203, -0.17630856571184267, -0.17379043482347045, -0.17116897410859383, -0.16708284501733178,
#  -0.1610971603858868, -0.15233855973691007, -0.13961232833549037, -0.12670635326968843, -0.11743191106285727,
#  -0.10899764449240897]

def test_partial_autocorrelation_function_streamflow():
    ystl = Ystl()
    y = ystl.streamflow[:60]
    arch = Arch()
    pacf_y = arch.partial_autocorrelation_function(y)
    print("pacf_y")
    print(pacf_y)
# pacf_y
# [ 1.          0.85727616 -0.36346162  0.14466159  0.03550953  0.02535685
#   0.00402063 -0.01184719 -0.02137158 -0.01608567 -0.01363453 -0.01709839
#  -0.0078693   0.01670959  0.00863855  0.01060163  0.00506393 -0.00937222
#  -0.02521926 -0.01812237 -0.00528659 -0.0082928  -0.00440002 -0.00168579
#  -0.00162665 -0.00201446 -0.00368665 -0.00513423 -0.00627972 -0.00661231
#  -0.00595238 -0.00528904 -0.0041184  -0.00481954 -0.00415041 -0.00309347
#  -0.00606696 -0.00870686 -0.0085929  -0.00935203 -0.00885177 -0.00871088
#  -0.00762783 -0.00628375 -0.00953454 -0.01308311 -0.01263496]

def test_std_2_range_acc_pacc():
    arch = Arch()
    x = y_streamflow_395
    n_x = len(x)
    acf = arch.autocorrelation_function(x)
    pacf = arch.partial_autocorrelation_function(x)
    std_rho_2_range_acf = arch.std_2_range_acc_pacc(n_x, acf)
    std_rho_2_range_pacf = arch.std_2_range_acc_pacc(n_x, pacf)
    print("std_rho_2_range_acf")
    print(std_rho_2_range_acf)
    print("std_rho_2_range_pacf")
    print(std_rho_2_range_pacf)
# std_rho_2_range_acf
# [[-0.1727505  -0.21971545 -0.25480536 -0.2821248  -0.30383339 -0.32135344
#   -0.33572031 -0.34770842 -0.35790148 -0.36674385 -0.37457126 -0.3816282
#   -0.38808859 -0.39407868 -0.39968735 -0.4049732  -0.40996821 -0.41469361
#   -0.41917792 -0.42344413 -0.42750121 -0.43135354 -0.43500526 -0.43846026
#   -0.44172255 -0.4447943  -0.44767407 -0.45035701 -0.45283744 -0.45511334
#   -0.45718875 -0.45907471 -0.46078814 -0.46234845 -0.46377539 -0.46508874
#   -0.46630727 -0.46744747 -0.46852294 -0.46954381 -0.47051716 -0.47144709
#   -0.47233439 -0.47317723 -0.47396951 -0.47470559 -0.47538439 -0.47600671
#   -0.47657696 -0.47710247 -0.47759148 -0.47805422 -0.47850228 -0.47894657
#   -0.47939618 -0.47985896 -0.48033985 -0.48083988 -0.4813564  -0.48188213
#   -0.48240696 -0.48292251 -0.48342443 -0.48391205 -0.48438722 -0.4848502
#   -0.48529742 -0.48572273 -0.48611881 -0.486479   -0.48679859 -0.48707556
#   -0.48731077 -0.48750741 -0.48766998 -0.48780349 -0.48791288 -0.48800267
#   -0.48807682 -0.48813891 -0.48819206 -0.48823873 -0.48828077 -0.48831957
#   -0.48835641 -0.48839316 -0.48843236 -0.48847675 -0.48852925 -0.48859409
#   -0.48867872 -0.48879626 -0.48896726 -0.48921655 -0.48956452 -0.49001368
#   -0.49054075 -0.49110213 -0.49164671 -0.49213222 -0.49253383 -0.4928436
#   -0.49306704 -0.49321869 -0.49331382 -0.49336753 -0.49339452 -0.49340583
#   -0.49340954 -0.49341028 -0.49341028 -0.49341084 -0.49341299 -0.49341791
#   -0.49342713 -0.49344269 -0.49346713 -0.4935034  -0.49355441 -0.49362256
#   -0.49370956 -0.4938166  -0.49394468 -0.49409485 -0.49426799 -0.49446455
#   -0.49468439 -0.49492683 -0.49519041 -0.49547273 -0.49577038 -0.49607911
#   -0.49639409 -0.49670988 -0.49702052 -0.49732003 -0.49760273 -0.49786395
#   -0.49810082 -0.49831294 -0.49850226 -0.49867263 -0.49882912 -0.49897754
#   -0.4991238  -0.49927291 -0.49942824 -0.49959069 -0.49975844 -0.49992748
#   -0.50009232 -0.50024675 -0.50038525 -0.5005048  -0.50060583 -0.5006923
#   -0.50077041 -0.50084703 -0.50092902 -0.50102249 -0.50113272 -0.50126438
#   -0.50142148 -0.50160739 -0.50182497 -0.5020769  -0.5023661  -0.50269548
#   -0.50306732 -0.50348223 -0.50393854 -0.50443243 -0.50495876 -0.50551219
#   -0.50608761 -0.50667942 -0.50728148 -0.50788801 -0.50849396 -0.50909464
#   -0.50968615 -0.51026562 -0.51083106 -0.51138299 -0.51192566 -0.51246845
#   -0.51302232 -0.51359457 -0.51418871 -0.51480574 -0.51544227 -0.51608923
#   -0.51673778 -0.51738223 -0.518021   -0.51865486 -0.51928182 -0.51989937
#   -0.5205057  -0.52109721 -0.52167427 -0.52223812 -0.52279243 -0.52334217
#   -0.52388355 -0.52441323 -0.52493144 -0.52543906 -0.52593421 -0.52641471
#   -0.52688139 -0.52733518 -0.52777658 -0.5282062  -0.5286256  -0.52903654
#   -0.52944048 -0.52983849 -0.53023112 -0.53061826 -0.53099958 -0.53137493
#   -0.53174452 -0.53210909 -0.5324698  -0.53282815 -0.53318599 -0.53354544
#   -0.53390891 -0.53427839 -0.53465468 -0.53503779 -0.535427   -0.53582132
#   -0.5362198  -0.53662135 -0.53702462 -0.53742841 -0.53783198 -0.53823477
#   -0.53863649 -0.53903689 -0.53943569 -0.53983261 -0.54022733 -0.5406196
#   -0.54100931 -0.54139642 -0.54178098 -0.54216307 -0.5425428  -0.54292057
#   -0.54329691 -0.5436723  -0.54404718 -0.54442205 -0.54479746 -0.54517405
#   -0.54555239 -0.54593253 -0.54631408 -0.54669635]
#  [ 0.1727505   0.21971545  0.25480536  0.2821248   0.30383339  0.32135344
#    0.33572031  0.34770842  0.35790148  0.36674385  0.37457126  0.3816282
#    0.38808859  0.39407868  0.39968735  0.4049732   0.40996821  0.41469361
#    0.41917792  0.42344413  0.42750121  0.43135354  0.43500526  0.43846026
#    0.44172255  0.4447943   0.44767407  0.45035701  0.45283744  0.45511334
#    0.45718875  0.45907471  0.46078814  0.46234845  0.46377539  0.46508874
#    0.46630727  0.46744747  0.46852294  0.46954381  0.47051716  0.47144709
#    0.47233439  0.47317723  0.47396951  0.47470559  0.47538439  0.47600671
#    0.47657696  0.47710247  0.47759148  0.47805422  0.47850228  0.47894657
#    0.47939618  0.47985896  0.48033985  0.48083988  0.4813564   0.48188213
#    0.48240696  0.48292251  0.48342443  0.48391205  0.48438722  0.4848502
#    0.48529742  0.48572273  0.48611881  0.486479    0.48679859  0.48707556
#    0.48731077  0.48750741  0.48766998  0.48780349  0.48791288  0.48800267
#    0.48807682  0.48813891  0.48819206  0.48823873  0.48828077  0.48831957
#    0.48835641  0.48839316  0.48843236  0.48847675  0.48852925  0.48859409
#    0.48867872  0.48879626  0.48896726  0.48921655  0.48956452  0.49001368
#    0.49054075  0.49110213  0.49164671  0.49213222  0.49253383  0.4928436
#    0.49306704  0.49321869  0.49331382  0.49336753  0.49339452  0.49340583
#    0.49340954  0.49341028  0.49341028  0.49341084  0.49341299  0.49341791
#    0.49342713  0.49344269  0.49346713  0.4935034   0.49355441  0.49362256
#    0.49370956  0.4938166   0.49394468  0.49409485  0.49426799  0.49446455
#    0.49468439  0.49492683  0.49519041  0.49547273  0.49577038  0.49607911
#    0.49639409  0.49670988  0.49702052  0.49732003  0.49760273  0.49786395
#    0.49810082  0.49831294  0.49850226  0.49867263  0.49882912  0.49897754
#    0.4991238   0.49927291  0.49942824  0.49959069  0.49975844  0.49992748
#    0.50009232  0.50024675  0.50038525  0.5005048   0.50060583  0.5006923
#    0.50077041  0.50084703  0.50092902  0.50102249  0.50113272  0.50126438
#    0.50142148  0.50160739  0.50182497  0.5020769   0.5023661   0.50269548
#    0.50306732  0.50348223  0.50393854  0.50443243  0.50495876  0.50551219
#    0.50608761  0.50667942  0.50728148  0.50788801  0.50849396  0.50909464
#    0.50968615  0.51026562  0.51083106  0.51138299  0.51192566  0.51246845
#    0.51302232  0.51359457  0.51418871  0.51480574  0.51544227  0.51608923
#    0.51673778  0.51738223  0.518021    0.51865486  0.51928182  0.51989937
#    0.5205057   0.52109721  0.52167427  0.52223812  0.52279243  0.52334217
#    0.52388355  0.52441323  0.52493144  0.52543906  0.52593421  0.52641471
#    0.52688139  0.52733518  0.52777658  0.5282062   0.5286256   0.52903654
#    0.52944048  0.52983849  0.53023112  0.53061826  0.53099958  0.53137493
#    0.53174452  0.53210909  0.5324698   0.53282815  0.53318599  0.53354544
#    0.53390891  0.53427839  0.53465468  0.53503779  0.535427    0.53582132
#    0.5362198   0.53662135  0.53702462  0.53742841  0.53783198  0.53823477
#    0.53863649  0.53903689  0.53943569  0.53983261  0.54022733  0.5406196
#    0.54100931  0.54139642  0.54178098  0.54216307  0.5425428   0.54292057
#    0.54329691  0.5436723   0.54404718  0.54442205  0.54479746  0.54517405
#    0.54555239  0.54593253  0.54631408  0.54669635]]
# std_rho_2_range_pacf
# [[-0.1727505  -0.20198339 -0.20199754 -0.20200667 -0.20201241 -0.20201502
#   -0.20201642 -0.20201702 -0.20201736 -0.20201768 -0.2020179  -0.20201799
#   -0.20201804 -0.20201811 -0.20201816 -0.20201817 -0.20201817 -0.20201819
#   -0.20201831 -0.20201833 -0.20201834 -0.20201834 -0.20201834 -0.20201834
#   -0.20201834 -0.20201834 -0.20201836 -0.20201839 -0.20201841 -0.20201843
#   -0.20201843 -0.20201843 -0.20201843 -0.20201843 -0.20201843 -0.20201843
#   -0.20201844 -0.20201844 -0.20201844 -0.20201844 -0.20201844 -0.20201844
#   -0.20201844 -0.20201845 -0.20201847 -0.20201848 -0.20201848 -0.20201848
#   -0.20201848 -0.20201849 -0.2020185  -0.20201852 -0.20201856 -0.20201858
#   -0.20201859 -0.2020186  -0.20201861 -0.20201861 -0.20201861 -0.20201862
#   -0.20201863 -0.20201863 -0.20201864 -0.20201865 -0.20201865 -0.20201866
#   -0.20201869 -0.20201871 -0.20201874 -0.20201876 -0.20201878 -0.20201879
#   -0.20201879 -0.20201879 -0.20201879 -0.2020188  -0.2020188  -0.2020188
#   -0.2020188  -0.2020188  -0.2020188  -0.2020188  -0.2020188  -0.2020188
#   -0.20201881 -0.20201884 -0.20201888 -0.2020189  -0.20201891 -0.20201897
#   -0.20201914 -0.20201943 -0.20201976 -0.20201985 -0.20201985 -0.20202004
#   -0.20202046 -0.2020208  -0.20202105 -0.20202114 -0.20202117 -0.2020212
#   -0.20202122 -0.20202122 -0.20202128 -0.20202132 -0.20202132 -0.20202132
#   -0.20202133 -0.20202133 -0.20202137 -0.20202138 -0.20202139 -0.2020214
#   -0.20202141 -0.20202141 -0.20202142 -0.20202142 -0.20202142 -0.20202142
#   -0.20202142 -0.20202142 -0.20202143 -0.20202143 -0.20202143 -0.20202143
#   -0.20202143 -0.20202143 -0.20202143 -0.20202143 -0.20202143 -0.20202143
#   -0.20202143 -0.20202144 -0.20202144 -0.20202145 -0.20202147 -0.20202148
#   -0.20202148 -0.20202148 -0.20202148 -0.20202149 -0.20202149 -0.20202151
#   -0.20202152 -0.20202153 -0.20202153 -0.20202153 -0.20202153 -0.20202154
#   -0.20202154 -0.20202155 -0.20202156 -0.20202156 -0.20202156 -0.20202159
#   -0.20202163 -0.20202166 -0.20202168 -0.20202168 -0.20202168 -0.20202168
#   -0.20202168 -0.20202169 -0.20202169 -0.20202169 -0.2020217  -0.2020217
#   -0.2020217  -0.2020217  -0.2020217  -0.2020217  -0.2020217  -0.2020217
#   -0.2020217  -0.2020217  -0.2020217  -0.2020217  -0.2020217  -0.2020217
#   -0.2020217  -0.2020217  -0.2020217  -0.20202171 -0.20202172 -0.20202176
#   -0.20202178 -0.20202178 -0.20202178 -0.20202178 -0.20202179 -0.20202181
#   -0.20202182 -0.20202182 -0.20202182 -0.20202182 -0.20202183 -0.20202184
#   -0.20202184 -0.20202185 -0.20202185 -0.20202185 -0.20202185 -0.20202186
#   -0.2020219  -0.2020219  -0.20202191 -0.20202191 -0.20202192 -0.20202192
#   -0.20202192 -0.20202192 -0.20202193 -0.20202193 -0.20202193 -0.20202193
#   -0.20202193 -0.20202193 -0.20202193 -0.20202193 -0.20202193 -0.20202193
#   -0.20202193 -0.20202193 -0.20202193 -0.20202193 -0.20202194 -0.20202194
#   -0.20202195 -0.20202195 -0.20202196 -0.20202196 -0.20202196 -0.20202196
#   -0.20202196 -0.20202197 -0.20202197 -0.20202197 -0.20202197 -0.20202197
#   -0.20202197 -0.20202197 -0.20202197 -0.20202197 -0.20202197 -0.20202197
#   -0.20202197 -0.20202197 -0.20202197 -0.20202197 -0.20202197 -0.20202197
#   -0.20202197 -0.20202197 -0.20202197 -0.20202197 -0.20202197 -0.20202197
#   -0.20202197 -0.20202197 -0.20202197 -0.20202197]
#  [ 0.1727505   0.20198339  0.20199754  0.20200667  0.20201241  0.20201502
#    0.20201642  0.20201702  0.20201736  0.20201768  0.2020179   0.20201799
#    0.20201804  0.20201811  0.20201816  0.20201817  0.20201817  0.20201819
#    0.20201831  0.20201833  0.20201834  0.20201834  0.20201834  0.20201834
#    0.20201834  0.20201834  0.20201836  0.20201839  0.20201841  0.20201843
#    0.20201843  0.20201843  0.20201843  0.20201843  0.20201843  0.20201843
#    0.20201844  0.20201844  0.20201844  0.20201844  0.20201844  0.20201844
#    0.20201844  0.20201845  0.20201847  0.20201848  0.20201848  0.20201848
#    0.20201848  0.20201849  0.2020185   0.20201852  0.20201856  0.20201858
#    0.20201859  0.2020186   0.20201861  0.20201861  0.20201861  0.20201862
#    0.20201863  0.20201863  0.20201864  0.20201865  0.20201865  0.20201866
#    0.20201869  0.20201871  0.20201874  0.20201876  0.20201878  0.20201879
#    0.20201879  0.20201879  0.20201879  0.2020188   0.2020188   0.2020188
#    0.2020188   0.2020188   0.2020188   0.2020188   0.2020188   0.2020188
#    0.20201881  0.20201884  0.20201888  0.2020189   0.20201891  0.20201897
#    0.20201914  0.20201943  0.20201976  0.20201985  0.20201985  0.20202004
#    0.20202046  0.2020208   0.20202105  0.20202114  0.20202117  0.2020212
#    0.20202122  0.20202122  0.20202128  0.20202132  0.20202132  0.20202132
#    0.20202133  0.20202133  0.20202137  0.20202138  0.20202139  0.2020214
#    0.20202141  0.20202141  0.20202142  0.20202142  0.20202142  0.20202142
#    0.20202142  0.20202142  0.20202143  0.20202143  0.20202143  0.20202143
#    0.20202143  0.20202143  0.20202143  0.20202143  0.20202143  0.20202143
#    0.20202143  0.20202144  0.20202144  0.20202145  0.20202147  0.20202148
#    0.20202148  0.20202148  0.20202148  0.20202149  0.20202149  0.20202151
#    0.20202152  0.20202153  0.20202153  0.20202153  0.20202153  0.20202154
#    0.20202154  0.20202155  0.20202156  0.20202156  0.20202156  0.20202159
#    0.20202163  0.20202166  0.20202168  0.20202168  0.20202168  0.20202168
#    0.20202168  0.20202169  0.20202169  0.20202169  0.2020217   0.2020217
#    0.2020217   0.2020217   0.2020217   0.2020217   0.2020217   0.2020217
#    0.2020217   0.2020217   0.2020217   0.2020217   0.2020217   0.2020217
#    0.2020217   0.2020217   0.2020217   0.20202171  0.20202172  0.20202176
#    0.20202178  0.20202178  0.20202178  0.20202178  0.20202179  0.20202181
#    0.20202182  0.20202182  0.20202182  0.20202182  0.20202183  0.20202184
#    0.20202184  0.20202185  0.20202185  0.20202185  0.20202185  0.20202186
#    0.2020219   0.2020219   0.20202191  0.20202191  0.20202192  0.20202192
#    0.20202192  0.20202192  0.20202193  0.20202193  0.20202193  0.20202193
#    0.20202193  0.20202193  0.20202193  0.20202193  0.20202193  0.20202193
#    0.20202193  0.20202193  0.20202193  0.20202193  0.20202194  0.20202194
#    0.20202195  0.20202195  0.20202196  0.20202196  0.20202196  0.20202196
#    0.20202196  0.20202197  0.20202197  0.20202197  0.20202197  0.20202197
#    0.20202197  0.20202197  0.20202197  0.20202197  0.20202197  0.20202197
#    0.20202197  0.20202197  0.20202197  0.20202197  0.20202197  0.20202197
#    0.20202197  0.20202197  0.20202197  0.20202197  0.20202197  0.20202197
#    0.20202197  0.20202197  0.20202197  0.20202197]]

def test_aic_degree():
    arch = Arch()
    x = y_streamflow_395
    x = y_streamflow_1460
    L = 5
    b_aic = True
    degree, aic_min, phi_min, R_2_min, aic, delta_2, phi, R_2 = arch.aic_degree(x, L, b_aic)
    print("degree = " + str(degree))
    print("aic_min = " + str(aic_min))
    print("phi_min = " + str(phi_min))
    print("R_2_min = " + str(R_2_min))
    print("aic = " + str(aic))
    print("delta_2 = " + str(delta_2))
    print("phi = " + str(phi))
    print("R_2 = " + str(R_2))
# y_streamflow_395  L=10
# degree = 1
# aic_min = -7.469255871877037
# phi_min = [0.99865605]
# R_2_min = 0.9751437840495106
# aic = [-7.46925587 -2.93823127 -0.25179433  1.7764137   3.85872636  5.87582535
#   7.92969156  9.94579587 12.00602762 14.01351739]
# delta_2 = [309.39783352676676, 87.27950187036832, 61.9233398279354, 61.05610223616195, 58.594264736826744,
#            58.095448623010306, 56.55164093766554, 56.0981066563058, 54.433849406088115, 54.23038211775148]
# phi = [array([0.99865605]),
#        array([ 1.86818005, -0.87194949]),
#        array([ 2.40237309, -2.01357576,  0.61026411]),
#        array([ 2.4880255 , -2.29792694,  0.95041479, -0.14172344]),
#        array([ 2.52396938, -2.53018686,  1.50711054, -0.74307103,  0.24149585]),
#        array([ 2.55089649, -2.61393635,  1.67693701, -1.02715851,  0.52438353, -0.11199447]),
#        array([ 2.57395417, -2.71987789,  1.88375246, -1.36278796,  1.04447863, -0.61826498,  0.19825179]),
#        array([ 2.59364679, -2.78287971,  1.99379553, -1.5100724 ,  1.25002605, -0.91560302,  0.47974263, -0.10932221]),
#        array([ 2.61883439, -2.88580653,  2.18403406, -1.76995998,  1.56830559, -1.33761714,  1.06800138, -0.65709416,  0.21101092]),
#        array([ 2.63446178, -2.93539286,  2.26437211, -1.86910704,  1.68460676, -1.47044455,  1.23272233, -0.87471668,  0.40841733, -0.07531736])]
# R_2 = [0.9751437840495106, 0.9933629294169934, 0.9950663164644005, 0.9951535859552687, 0.9953131373811855,
#        0.9953627853246236, 0.9954625978732593, 0.9955061966709884, 0.9956181509501223, 0.9956366851123055]

def test_aic_c_degree():
    arch = Arch()
    x = y_streamflow_395
    L = 10
    N = len(x)
    aic = [-7.46925587, -2.93823127, -0.25179433, 1.7764137, 3.85872636]
    aic = [-7.46925587, -2.93823127, -0.25179433, 1.7764137, 3.85872636, 5.87582535, 7.92969156, 9.94579587, 12.00602762, 14.01351739]
    degree, aic_c_min, aic_c = arch.aic_c_degree(aic, N, L, b_aic_c=True)
    print("degree = " + str(degree))
    print("aic_c_min = " + str(aic_c_min))
    print("aic_c = " + str(aic_c))
# y_streamflow_395  L = 5
# degree = 1
# aic_c_min = -7.43864362510204
# aic_c = [-7.43864363 -2.8768502  -0.14923023  1.93065535  4.07522121]
# y_streamflow_395  L = 10
# degree = 1
# aic_c_min = -7.43864362510204
# aic_c = [-7.43864363 -2.8768502  -0.14923023  1.93065535  4.07522121  6.16523103
#   8.30274855 10.41332834 12.57894429 14.70281243]

def test_bic_degree():
    arch = Arch()
    x = y_streamflow_395
    x = y_streamflow_1460
    L = 5
    N = len(x)
    delta_2 = [309.39783352676676, 87.27950187036832, 61.9233398279354, 61.05610223616195, 58.594264736826744]
    delta_2 = [309.39783352676676, 87.27950187036832, 61.9233398279354, 61.05610223616195, 58.594264736826744,
               58.095448623010306, 56.55164093766554, 56.0981066563058, 54.433849406088115, 54.23038211775148]
    delta_2_1460 = [34278.09777412344, 21374.47966066487, 17281.76516553596, 16763.881187152878, 16117.50188119964]
    degree, bic_min, bic = arch.bic_degree(delta_2_1460, N, L, b_bic=True)
    print("degree = " + str(degree))
    print("bic_min = " + str(bic_min))
    print("bic = " + str(bic))
# y_streamflow_1460  L = 5
# degree = 1
# bic_min = -13.598332045968625
# bic = [-13.59833205  -5.36752247   2.34376077   9.69080302  17.05563651]
# y_streamflow_1460  L = 5
# degree = 1
# bic_min = -3.156070165633122
# bic = [-3.15607017  4.60243048 12.10116796 19.41778494 26.74329754]

def test_arma_degree():
    arch = Arch()
    x = y_streamflow_395
    x = y_streamflow_1460
    L = 5
    degree_aic, aic_min, phi_min, R_2_min, degree_bic, bic_min, degree_aic_c, aic_c_min = arch.arma_degree(x, L)
    print("degree_aic = " + str(degree_aic))
    print("aic_min = " + str(aic_min))
    print("phi_min = " + str(phi_min))
    print("R_2_min = " + str(R_2_min))
    print("degree_bic = " + str(degree_bic))
    print("bic_min = " + str(bic_min))
    print("degree_aic_c = " + str(degree_aic_c))
    print("aic_c_min = " + str(aic_c_min))
# y_streamflow_1460  L=5
# degree_aic = 1
# aic_min = -16.88452376067101
# phi_min = [0.95016204]
# R_2_min = 0.8692131382820829
# degree_bic = 1
# bic_min = -13.598332045968625
# degree_aic_c = 1
# aic_c_min = -16.876287659092423

def test_ar_least_squares_estimation():
    y_42 = [1, 1.1, 1.21, 1.331, 1.4641, 1.61051, 1.771561, 1.9487171, 2.14358881, 2.357947691, 2.59374246,
            2.853116706, 3.138428377, 3.452271214, 3.797498336, 4.177248169, 4.594972986, 5.054470285, 5.559917313,
            6.115909045, 6.727499949, 7.400249944, 8.140274939, 8.954302433, 9.849732676, 10.83470594, 11.91817654,
            13.10999419, 14.42099361, 15.86309297, 17.44940227, 19.1943425, 21.11377675, 23.22515442, 25.54766986,
            28.10243685, 30.91268053, 34.00394859, 37.40434344, 41.14477779, 45.25925557, 49.78518112]
    arch = Arch()
    phi = arch.ar_least_squares_estimation(y_42, 1)
    print("phi")
    print(phi)
# phi
# (array([1.1]), 1.0000000000000004)

def test_adf_least_squares_estimation():
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    arch = Arch()
    rho, s_rho = arch.adf_least_squares_estimation(dy2_c, 3)
    print("rho")
    print(rho)
    print("s_rho")
    print(s_rho)
# rho
# -3.1784358068686576
# s_rho
# 0.40833351710609556

def test_tau_statistic():
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    arch = Arch()
    t_y = arch.tau_statistic(dy2_c, 3)
    print("t_y")
    print(t_y)
# t_y
# -7.7839209217861445

def test_get_tau_critical():
    arch = Arch()
    case = "case 2"
    p = 0.05
    n_sample = 42
    tau_critical = arch.get_tau_critical(case, n_sample, p)
    print("tau_critical")
    print(tau_critical)
# tau_critical
# -1.95
# tau_critical
# -2.9524

def test_adf_test():
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    dx_c_42 = [-8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0,
               -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0,
               -8.0, 8.0, -8.0, 8.0]
    arch = Arch()
    case = "case 1"
    significance_level = 0.05
    b_stability = arch.adf_test(y_residual_2_streamflow_395, 3, case, significance_level)
    print("b_stability")
    print(b_stability)
# b_stability  e_60
# True
# b_stability  e_42
# True
# b_stability  y_streamflow_100
# False
# b_stability  y_streamflow_395
# False
# b_stability  y_streamflow_1460
# True
# b_stability  y_residual_2_streamflow_1460
# True
# b_stability  y_residual_2_streamflow_395
# True

def test_integrated_one_degree():
    y_non_stationary = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49,
                        47, 53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    y_integrated, y_trend = arch.integrate_one_degree(y_non_stationary)
    p = 4
    case = "case 1"
    significance_level = 0.05
    b_stability = arch.adf_test(y_integrated, p, case, significance_level)
    print("y_integrated")
    print(y_integrated)
    print("y_trend")
    print(y_trend)
    print("b_stability")
    print(b_stability)
# y_integrated
# [ 6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.
#   6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.  6. -2.
#   6. -2.  6. -2.  6.]
# y_trend
# [-1. -1.  5.  3.  9.  7. 13. 11. 17. 15. 21. 19. 25. 23. 29. 27. 33. 31.
#  37. 35. 41. 39. 45. 43. 49. 47. 53. 51. 57. 55. 61. 59. 65. 63. 69. 67.
#  73. 71. 77. 75. 81. 79.]
# b_stability
# False

def test_integrate_d_degree():
    y_non_stationary_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49,
                        47, 53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    y_integrated, y_trend = arch.integrate_d_degree(y_non_stationary_42, 2)
    p = 1
    case = "case 1"
    significance_level = 0.05
    b_stability = arch.adf_test(y_integrated, p, case, significance_level)
    print("y_integrated")
    print(y_integrated)
    print("y_trend")
    print(y_trend)
    print("b_stability")
    print(b_stability)
# y_non_stationary_42 p=1
# y_integrated
# [-8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8.
#  -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8. -8.  8.
#  -8.  8. -8.  8.]
# y_trend
# [-1.  5. 11.  1. 15.  5. 19.  9. 23. 13. 27. 17. 31. 21. 35. 25. 39. 29.
#  43. 33. 47. 37. 51. 41. 55. 45. 59. 49. 63. 53. 67. 57. 71. 61. 75. 65.
#  79. 69. 83. 73. 87. 77.]
# b_stability
# False

def test_integration_streamflow():
    arch = Arch()
    d = 3
    y_integrated, y_trend = arch.integration(x=y_streamflow_395, d=d)
    p = 1
    case = "case 1"
    significance_level = 0.05
    b_stability = arch.adf_test(y_integrated, p, case, significance_level)
    print("y_integrated")
    print(y_integrated)
    print("y_trend")
    print(y_trend)
    print("b_stability")
    print(b_stability)
# y_streamflow_395  d=3
# y_integrated
# [-0.1999999999999602, -0.8000000000000114, 0.0, -0.9000000000000057, 2.842170943040401e-14, 0.9999999999999432,
#  -0.1999999999999318, 1.0999999999999375, -0.1999999999999602, -0.8000000000000114, 0.0, 0.0, 0.0, 0.0, 0.0,
#  -1.8000000000000114, 0.10000000000002274, 1.6999999999999886, 0.0, 0.9000000000000057, -0.09999999999999432,
# y_trend
# [167.6 165.8 165.  165.2 165.8 165.  165.  162.3 159.6 159.  156.9 158.2
#  158.8 158.  158.  158.  158.  158.  158.  152.6 147.5 145.7 142.2 141.4
#  140.3 138.  135.9 136.3 136.3 135.2 134.7 133.  131.6 130.4 129.5 129.1
# b_stability
# False


def test_ar_one_step():
    arch = Arch()
    x = [-1, 5, 3]
    phi = [1,  1, -1]
    y_ar = arch.ar_one_step(x, phi)
    print("y_ar")
    print(y_ar)
# y_ar
# 1.0

def test_ma_one_step():
    arch = Arch()
    theta = [0.5, 0.5]
    e_ = [0.2, -0.6, 0.4]
    y_ma = arch.ma_one_step(e_, theta)
    print("y_ma")
    print(y_ma)
# y_ma
# 0.20000000000000004

def test_arma():
    y_ar = [1, 1.1, 1.21, 1.331, 1.4641, 1.61051, 1.771561, 1.9487171, 2.14358881, 2.357947691, 2.59374246,
            2.853116706, 3.138428377, 3.452271214, 3.797498336, 4.177248169, 4.594972986, 5.054470285, 5.559917313,
            6.115909045, 6.727499949, 7.400249944, 8.140274939, 8.954302433, 9.849732676, 10.83470594, 11.91817654,
            13.10999419, 14.42099361, 15.86309297, 17.44940227, 19.1943425, 21.11377675, 23.22515442, 25.54766986,
            28.10243685, 30.91268053, 34.00394859, 37.40434344, 41.14477779, 45.25925557, 49.78518112]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_ma = [1.7353783, -1.36841262, -0.166777075, -0.753366275, 1.45740841, -2.678726045, 2.95109758, -1.57809631,
            0.75515902, -0.35337346, 1.6423096, -2.73567821, 0.763169625, -0.16732928, 1.381313085, -1.61125952,
            0.433033895, -0.736127845, 0.53665943, 0.617224805, -1.336510315, 1.75054977, 0.384745335, 0.10721545,
            0.70512525, -1.078639365, 0.27449017, -0.818807845, 0.255513105, 0.71981598, -0.901322015, 0.004593315,
            -0.433279465, -0.44610282, -0.19312684, 0.378474935, -1.05546158, 0.848587345, 1.5981108, -0.03234046,
            -0.50734116, -0.736194715]
    y_ma_3 = [1.7353783, -0.50072347, -0.41713881, -0.910187173, 1.398521383, -2.249336914, 2.413901882,
              -0.866470275, 0.473005864, -0.32290873, 1.5936451, -2.43638975, 0.072553639, 0.022901334,
              1.563896432, -1.286556336, 0.013603894, -0.675115471, 0.494459221, 0.807378766, -1.151707475,
              1.398538223, 0.764429098, 0.157547476, 0.499730309, -1.100229409, -0.10377932, -0.807829208,
              0.150206757, 0.854577979, -0.659199656, -0.224124415, -0.438436862, -0.446123873, -0.196161369,
              0.470880813, -0.850328004, 0.683679514, 1.858619176, 0.353364577, -0.725437628, -1.100054169]
    y_arma_ = [1, -0.26841262, -0.462030957, -1.261600327, 0.06964805, -2.60211319, 0.088773071, -1.480445931,
              -0.873331504, -1.314038115, 0.196867674, -2.519123769, -2.00786652, -2.375982452, -1.232267612,
              -2.966753893, -2.830395388, -3.849562771, -3.697859618, -3.450420775, -5.131973167, -3.894620714,
              -3.89933745, -4.182055745, -3.89513607, -5.363289042, -5.625127776, -7.006448398, -7.451580133,
              -7.476922166, -9.125936397, -10.03393672, -11.47060986, -13.06377366, -14.56327787, -15.64113072,
              -18.26070538, -19.23818857, -19.56389662, -21.55262675, -24.21523058, -27.37294835]
    y_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49, 47,
            53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    y_arma_3 = [1.7353783, -0.50072347, -0.41713881, -0.92181951, 0.36780299, -1.743817484, 0.237778149, -0.182590216,
                -0.1241625, -0.375413807, 1.169004369, -1.100234682, -1.446588147, -1.114497817, 0.407219526,
                -0.905032923, -1.28627579, -1.82756835, -1.43961739, -0.667941851, -1.964033703, -0.916233958,
                0.015790115, -0.034643347, 0.275217813, -0.787403122, -1.031894986, -1.730389506, -1.704323326,
                -0.880478776, -1.632939545, -2.185126825, -2.691584215, -3.296429054, -3.72094185, -3.501186254,
                -4.616730324, -4.438674962, -2.800814468, -2.76314241, -4.092466378, -5.609301596]
    arch = Arch()
    phi = [1.1, -0.2, 0.2]
    theta = [0.3, 0.2, 0.1]
    # phi = [1.1]
    # theta = [0.5]
    p = 3
    q = 3
    y_arma = arch.arma(x=y_arma_3, e=e, phi=phi, theta=theta, p=p, q=q)
    error = np.array(y_arma_3) - y_arma
    print("y_arma")
    print(y_arma)
    print("error")
    print(error)
# y_ar
# [ 1.          1.1         1.21        1.331       1.4641      1.61051
#   1.771561    1.9487171   2.14358881  2.35794769  2.59374246  2.85311671
#   3.13842838  3.45227121  3.79749834  4.17724817  4.59497299  5.05447028
#   5.55991731  6.11590904  6.72749995  7.40024994  8.14027494  8.95430243
#   9.84973268 10.83470594 11.91817653 13.10999419 14.42099361 15.86309297
#  17.44940227 19.1943425  21.11377675 23.22515443 25.54766986 28.10243685
#  30.91268054 34.00394858 37.40434345 41.14477778 45.25925557 49.78518113]
# error
# [ 0.00000000e+00  0.00000000e+00 -2.22044605e-16  0.00000000e+00
#  -2.22044605e-16  0.00000000e+00 -2.22044605e-16  0.00000000e+00
#  -4.44089210e-16  0.00000000e+00 -1.00000452e-10 -4.44089210e-16
#   4.00000033e-10 -7.00000058e-10  5.99999606e-10 -6.00000050e-10
#   9.99991201e-11  3.99999145e-10 -5.00000930e-10  7.00000058e-10
#  -5.00000930e-10  9.99991201e-11  5.99998273e-10  1.00000008e-10
#  -3.00001801e-10 -3.60000207e-09  5.99999872e-09 -4.00000033e-09
#   9.99998306e-10 -1.00000186e-09  3.00000025e-09  3.00000025e-09
#  -3.55271368e-15 -5.00000397e-09 -2.00000017e-09  4.00000033e-09
#  -5.00000397e-09  6.99999703e-09 -9.00000430e-09  6.00000050e-09
#   9.99996530e-10 -7.00000413e-09]
# y_ma  p=0,q=1
# [ 1.7353783  -1.36841262 -0.16677708 -0.75336627  1.45740841 -2.67872605
#   2.95109758 -1.57809631  0.75515902 -0.35337346  1.6423096  -2.73567821
#   0.76316962 -0.16732928  1.38131309 -1.61125952  0.4330339  -0.73612784
#   0.53665943  0.6172248  -1.33651031  1.75054977  0.38474534  0.10721545
#   0.70512525 -1.07863936  0.27449017 -0.81880785  0.25551311  0.71981598
#  -0.90132201  0.00459331 -0.43327947 -0.44610282 -0.19312684  0.37847494
#  -1.05546158  0.84858734  1.5981108  -0.03234046 -0.50734116 -0.73619472]
# error
# [ 0.00000000e+00  0.00000000e+00  5.55111512e-17  0.00000000e+00
#   0.00000000e+00  4.44089210e-16  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  5.55111512e-17  0.00000000e+00 -4.44089210e-16
#   0.00000000e+00  2.77555756e-17 -2.22044605e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  1.11022302e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00 -5.55111512e-17  1.38777878e-17
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.30104261e-17
#   5.55111512e-17  0.00000000e+00  2.77555756e-17  0.00000000e+00
#   0.00000000e+00  0.00000000e+00 -2.22044605e-16  1.38777878e-17
#   0.00000000e+00  1.11022302e-16]
# y_arma  p=1,q=1
# [  1.          -0.26841262  -0.46203096  -1.26160033   0.06964805
#   -2.60211319   0.08877307  -1.48044593  -0.8733315   -1.31403811
#    0.19686767  -2.51912377  -2.00786652  -2.37598245  -1.23226761
#   -2.96675389  -2.83039539  -3.84956277  -3.69785962  -3.45042077
#   -5.13197317  -3.89462071  -3.89933745  -4.18205575  -3.89513607
#   -5.36328904  -5.62512778  -7.0064484   -7.45158013  -7.47692217
#   -9.1259364  -10.03393672 -11.47060986 -13.06377367 -14.56327787
#  -15.64113072 -18.26070537 -19.23818857 -19.56389663 -21.55262674
#  -24.21523059 -27.37294835]
# error
# [ 0.00000000e+00 -1.11022302e-16  5.55111512e-17  7.00000058e-10
#  -2.99999872e-10  4.44089210e-16  1.24900090e-16  9.00000074e-10
#   1.00000008e-10 -5.99999828e-10  5.00000097e-10 -4.00000477e-10
#   9.00000519e-10  0.00000000e+00  2.00000017e-10  2.00000017e-10
#  -6.99999614e-10  8.00000066e-10  1.00000452e-10 -2.00000461e-10
#   5.00000041e-10 -3.00000025e-10  4.00000921e-10  0.00000000e+00
#  -4.99998709e-10  0.00000000e+00  2.00000017e-10  6.00000938e-10
#  -2.00000017e-10  3.00001801e-10  6.00000050e-10  1.70000192e-09
#  -2.99999847e-09  6.00000050e-09 -3.99999855e-09  2.00000372e-09
#  -8.00000066e-09  3.00000735e-09  6.99999703e-09 -7.99999711e-09
#   5.00000397e-09  3.00000025e-09]
# y_42 p=3,q=0
# [-1.  5.  3.  9.  7. 13. 11. 17. 15. 21. 19. 25. 23. 29. 27. 33. 31. 37.
#  35. 41. 39. 45. 43. 49. 47. 53. 51. 57. 55. 61. 59. 65. 63. 69. 67. 73.
#  71. 77. 75. 81. 79. 85.]
# error
# [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
#  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
# y_ma_3  p=0,q=3
# [ 1.7353783  -0.50072347 -0.41713881 -0.91018717  1.39852138 -2.24933691
#   2.41390188 -0.86647027  0.47300586 -0.32290873  1.5936451  -2.43638975
#   0.07255364  0.02290133  1.56389643 -1.28655634  0.01360389 -0.67511547
#   0.49445922  0.80737877 -1.15170747  1.39853822  0.7644291   0.15754748
#   0.49973031 -1.10022941 -0.10377932 -0.80782921  0.15020676  0.85457798
#  -0.65919966 -0.22412442 -0.43843686 -0.44612387 -0.19616137  0.47088081
#  -0.850328    0.68367951  1.85861918  0.35336458 -0.72543763 -1.10005417]
# error
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   2.22044605e-16  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   5.55111512e-17  5.89805982e-17 -2.22044605e-16  0.00000000e+00
#   5.03069808e-17  0.00000000e+00  5.55111512e-17  0.00000000e+00
#  -2.22044605e-16  2.22044605e-16 -1.11022302e-16  2.77555756e-17
#  -5.55111512e-17  0.00000000e+00  1.38777878e-17  0.00000000e+00
#   2.77555756e-17 -1.11022302e-16  0.00000000e+00  2.77555756e-17
#   0.00000000e+00  0.00000000e+00  2.77555756e-17 -5.55111512e-17
#   1.11022302e-16  0.00000000e+00 -2.22044605e-16  5.55111512e-17
#   1.11022302e-16  0.00000000e+00]
# y_arma  p=3,q=3
# [ 1.7353783  -0.50072347 -0.41713881 -0.92181951  0.36780299 -1.74381749
#   0.23777815 -0.18259022 -0.1241625  -0.37541381  1.16900437 -1.10023468
#  -1.44658815 -1.11449782  0.40721953 -0.90503292 -1.28627579 -1.82756835
#  -1.43961739 -0.66794185 -1.9640337  -0.91623396  0.01579011 -0.03464335
#   0.27521781 -0.78740312 -1.03189499 -1.73038951 -1.70432333 -0.88047878
#  -1.63293955 -2.18512682 -2.69158422 -3.29642905 -3.72094185 -3.50118625
#  -4.61673032 -4.43867496 -2.80081447 -2.76314241 -4.09246638 -5.6093016 ]
# error
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.11022302e-16
#   2.77555756e-16  1.00000008e-09 -5.99999994e-10  2.99999942e-10
#   2.00000086e-10  0.00000000e+00 -1.00000008e-10  6.99999836e-10
#  -5.99999828e-10  5.00000041e-10 -3.00000025e-10  4.00000033e-10
#  -1.00000008e-10  2.00000239e-10  6.00000050e-10 -1.11022302e-16
#   1.00000008e-10  1.00000563e-10  3.99999874e-10 -4.99999993e-10
#   2.99999969e-10  3.00000025e-10  2.00000239e-10 -3.99999811e-10
#   8.00000066e-10 -3.99999922e-10  6.00000272e-10 -5.00000041e-10
#   7.00000502e-10 -5.00000041e-10  4.00000033e-10  2.00000017e-10
#   2.00000905e-10 -4.00000033e-10  2.00000461e-10  2.00000461e-10
#  -2.00000017e-10  4.00000921e-10]

def test_integration():
    y_42_e = [2.62434536, 1.30041627, 0.375950045, -0.006054495, 1.79302332, -0.258324885, 2.36560341, 2.05991608,
              2.08202446, 2.268096861, 3.93116521, 1.524029966, 1.785940822, 2.907008264, 4.739240601, 3.644241619,
              3.872599141, 4.09039776, 5.163201853, 6.71983113, 5.918288374, 7.994664064, 9.614227514, 9.907592133,
              11.0018358, 10.60140606, 11.45342238, 12.11277965, 13.68522082, 16.2595044, 17.02291925, 18.45175859,
              20.22822728, 22.03636243, 24.45382091, 27.75414918, 29.78903788, 33.67970911, 39.18135347, 42.71672304,
              45.4384421, 48.80163439]
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    dy2_center = 0.117178035
    ty2 = [2.62434536, 1.30041627, -0.02351282, -0.54851618, -0.388059035, 3.592101135, -2.30967309, 4.989531705,
           1.75422875, 2.10413284, 2.454169262, 5.594233559, -0.883105278, 2.047851677, 4.028075707, 6.571472937,
           2.549242638, 4.100956663, 4.308196379, 6.236005947, 8.276460406, 5.116745619, 10.07103975, 11.23379096,
           10.20095675, 12.09607946, 10.20097632, 12.3054387, 12.77213692, 15.25766198, 18.83378799, 17.78633411,
           19.88059793, 22.00469597, 23.84449758, 26.87127939, 31.05447745, 31.82392658, 37.57038034, 44.68299784,
           46.2520926, 48.16016116]
    y_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49, 47,
            53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    arch = Arch()
    d = 2
    dx_c, mean_dx, tx = arch.integration(x=y_42, d=d)
    # error_dx_c = np.array(dy2_c) - dx_c
    # error_tx = np.array(ty2) - tx
    print("dx_c")
    print(dx_c)
    # print("error_dx_c")
    # print(error_dx_c)
    print("tx")
    print(tx)
    # print("error_tx")
    # print(error_tx)
    print("mean_dx")
    print(mean_dx)
# dx_c
# [0.28228483050000025, 0.4252836505000001, 2.0639043205000003, -3.9676040545, 4.5580984655, -3.0467936594999996,
#  0.21061767550000038, 0.04678598650000014, 1.3598179135000001, -4.187381627500001, 2.5518680655000003,
#  0.7419785515000002, 0.5939868604999999, -3.044409353499999, 1.2061784694999993, -0.1277369374999991,
#  0.7378274395000001, 0.3666471494999998, -2.4753500674999995, 2.7607404115, -0.5739902745000004, -1.443376865499999,
#  0.6837010135000007, -1.6118514415000003, 1.135268025499999, -0.30983708449999764, 0.7959058654999985,
#  0.884664375500002, -1.9280467645000008, 0.5482464554999996, 0.23045131549999848, -0.08551157449999598,
#  0.4921452954999989, 0.7656917554999975, -1.3826176044999978, 1.7386044954999993, 1.4937950955000017,
#  -2.0834528244999997, -0.930828544499995, 0.5242951954999885]
# error_dx_c
# [-5.00000263e-10 -5.00000097e-10 -5.00000485e-10 -4.99999597e-10
#  -5.00000041e-10 -5.00000485e-10 -5.00000374e-10 -5.00000139e-10
#   4.99999819e-10 -4.99999153e-10 -5.00000485e-10  1.49999979e-09
#  -1.49999990e-09  1.49999879e-09 -4.99999375e-10 -5.00000902e-10
#   4.99999930e-10 -1.49999985e-09  1.49999968e-09 -5.00000041e-10
#  -4.99999597e-10  4.99998931e-10 -3.50000062e-09  6.50000032e-09
#  -3.49999896e-09 -5.00002373e-10  5.00001485e-10  6.49999798e-09
#  -3.49999918e-09 -5.49999957e-09  2.50000151e-09 -5.00004024e-10
#   2.50000110e-09 -4.99997488e-10 -1.50000212e-09 -1.49999924e-09
#   5.49999823e-09 -9.50000034e-09  4.49999493e-09  2.50001153e-09]
# tx
# [ 2.62434536e+00  1.30041627e+00 -2.35128200e-02 -5.48516180e-01
#  -3.88059035e-01  3.59210114e+00 -2.30967309e+00  4.98953170e+00
#   1.75422875e+00  2.10413284e+00  2.45416926e+00  5.59423356e+00
#  -8.83105278e-01  2.04785168e+00  4.02807571e+00  6.57147294e+00
#   2.54924264e+00  4.10095666e+00  4.30819638e+00  6.23600595e+00
#   8.27646041e+00  5.11674562e+00  1.00710398e+01  1.12337910e+01
#   1.02009568e+01  1.20960795e+01  1.02009763e+01  1.23054387e+01
#   1.27721369e+01  1.52576620e+01  1.88337880e+01  1.77863341e+01
#   1.98805979e+01  2.20046960e+01  2.38444976e+01  2.68712794e+01
#   3.10544774e+01  3.18239266e+01  3.75703803e+01  4.46829978e+01
#   4.62520926e+01  4.81601612e+01]
# error_tx
# [ 0.00000000e+00  0.00000000e+00  1.00613962e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  8.88178420e-16
#   2.22044605e-16  0.00000000e+00  0.00000000e+00  0.00000000e+00
#  -1.11022302e-16 -9.99999639e-10  1.00000008e-09 -9.99999195e-10
#   9.99999195e-10  0.00000000e+00  0.00000000e+00  9.99999195e-10
#  -1.00000008e-09  9.99999195e-10 -4.00000033e-09 -3.99999855e-09
#  -2.00000017e-09 -7.00000058e-09  0.00000000e+00  1.77635684e-15
#  -1.77635684e-15 -9.99999905e-09  9.99999727e-09  9.99999727e-09
#   0.00000000e+00  3.55271368e-15 -3.55271368e-15  0.00000000e+00
#   3.55271368e-15  0.00000000e+00  0.00000000e+00  1.00000008e-08
#  -1.00000008e-08 -7.10542736e-15]
# mean_dx
# 0.11717803449999982

def test_generate_white_noise():
    np.random.seed(1)
    e = np.random.standard_normal(size=1460)
    # e = e.tolist()
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\e.txt', e)
    # print("e")
    # print(e)

def test_streamflow():
    ystl = Ystl()
    y_streamflow = ystl.streamflow
    print("y_streamflow")
    print(y_streamflow)


def test_Q_statistic():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    m = 6
    arch = Arch()
    Q = arch.Q_statistic(x=e, m=m)
    print("e")
    print(e)
    print("Q")
    print(Q)
# Q
# 3.407046110144282
# Q  m=1
# 0.17031960620512743

def test_white_noise_test():
    m = 6
    significant = 0.05
    arch = Arch()
    b_white_noise = arch.white_noise_test(x=e_100, m=m, significance_level=significant)
    print("b_white_noise")
    print(b_white_noise)
# b_white_noise  m=1
# True
# b_white_noise  m=6
# True
# b_white_noise  m=12
# True
# b_white_noise  m=18
# True
# b_white_noise  m=6  e_1000
# True
# b_white_noise  m=6  e_42
# False
# b_white_noise  m=6  e_60
# False
# b_white_noise  m=6  e_100
# True

def test_arima():
    y_ar = [1, 1.1, 1.21, 1.331, 1.4641, 1.61051, 1.771561, 1.9487171, 2.14358881, 2.357947691, 2.59374246,
              2.853116706, 3.138428377, 3.452271214, 3.797498336, 4.177248169, 4.594972986, 5.054470285,
              5.559917313, 6.115909045, 6.727499949, 7.400249944, 8.140274939, 8.954302433, 9.849732676,
              10.83470594, 11.91817654, 13.10999419, 14.42099361, 15.86309297, 17.44940227, 19.1943425,
              21.11377675, 23.22515442, 25.54766986, 28.10243685, 30.91268053, 34.00394859, 37.40434344,
              41.14477779, 45.25925557, 49.78518112]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_ma = [1.7353783, -1.36841262, -0.166777075, -0.753366275, 1.45740841, -2.678726045, 2.95109758, -1.57809631,
            0.75515902, -0.35337346, 1.6423096, -2.73567821, 0.763169625, -0.16732928, 1.381313085, -1.61125952,
            0.433033895, -0.736127845, 0.53665943, 0.617224805, -1.336510315, 1.75054977, 0.384745335, 0.10721545,
            0.70512525, -1.078639365, 0.27449017, -0.818807845, 0.255513105, 0.71981598, -0.901322015, 0.004593315,
            -0.433279465, -0.44610282, -0.19312684, 0.378474935, -1.05546158, 0.848587345, 1.5981108, -0.03234046,
            -0.50734116, -0.736194715]
    y_ma_3 = [1.7353783, -0.50072347, -0.41713881, -0.910187173, 1.398521383, -2.249336914, 2.413901882,
              -0.866470275, 0.473005864, -0.32290873, 1.5936451, -2.43638975, 0.072553639, 0.022901334,
              1.563896432, -1.286556336, 0.013603894, -0.675115471, 0.494459221, 0.807378766, -1.151707475,
              1.398538223, 0.764429098, 0.157547476, 0.499730309, -1.100229409, -0.10377932, -0.807829208,
              0.150206757, 0.854577979, -0.659199656, -0.224124415, -0.438436862, -0.446123873, -0.196161369,
              0.470880813, -0.850328004, 0.683679514, 1.858619176, 0.353364577, -0.725437628, -1.100054169]
    y_arma = [1, -0.26841262, -0.462030957, -1.261600327, 0.06964805, -2.60211319, 0.088773071, -1.480445931,
              -0.873331504, -1.314038115, 0.196867674, -2.519123769, -2.00786652, -2.375982452, -1.232267612,
              -2.966753893, -2.830395388, -3.849562771, -3.697859618, -3.450420775, -5.131973167, -3.894620714,
              -3.89933745, -4.182055745, -3.89513607, -5.363289042, -5.625127776, -7.006448398, -7.451580133,
              -7.476922166, -9.125936397, -10.03393672, -11.47060986, -13.06377366, -14.56327787, -15.64113072,
              -18.26070538, -19.23818857, -19.56389662, -21.55262675, -24.21523058, -27.37294835]
    y_arma_3 = [1.7353783, -0.50072347, -0.41713881, -0.92181951, 0.36780299, -1.743817484, 0.237778149, -0.182590216,
                -0.1241625, -0.375413807, 1.169004369, -1.100234682, -1.446588147, -1.114497817, 0.407219526,
                -0.905032923, -1.28627579, -1.82756835, -1.43961739, -0.667941851, -1.964033703, -0.916233958,
                0.015790115, -0.034643347, 0.275217813, -0.787403122, -1.031894986, -1.730389506, -1.704323326,
                -0.880478776, -1.632939545, -2.185126825, -2.691584215, -3.296429054, -3.72094185, -3.501186254,
                -4.616730324, -4.438674962, -2.800814468, -2.76314241, -4.092466378, -5.609301596]
    # i
    y_42_e = [2.62434536, 1.30041627, 0.375950045, -0.006054495, 1.79302332, -0.258324885, 2.36560341, 2.05991608,
              2.08202446, 2.268096861, 3.93116521, 1.524029966, 1.785940822, 2.907008264, 4.739240601, 3.644241619,
              3.872599141, 4.09039776, 5.163201853, 6.71983113, 5.918288374, 7.994664064, 9.614227514, 9.907592133,
              11.0018358, 10.60140606, 11.45342238, 12.11277965, 13.68522082, 16.2595044, 17.02291925, 18.45175859,
              20.22822728, 22.03636243, 24.45382091, 27.75414918, 29.78903788, 33.67970911, 39.18135347, 42.71672304,
              45.4384421, 48.80163439]
    dy2_c = [0.28228483, 0.42528365, 2.06390432, -3.967604055, 4.558098465, -3.04679366, 0.210617675, 0.046785986,
             1.359817914, -4.187381628, 2.551868065, 0.741978553, 0.593986859, -3.044409352, 1.206178469, -0.127736938,
             0.73782744, 0.366647148, -2.475350066, 2.760740411, -0.573990275, -1.443376865, 0.68370101, -1.611851435,
             1.135268022, -0.309837085, 0.795905866, 0.884664382, -1.928046768, 0.54824645, 0.230451318, -0.085511575,
             0.492145298, 0.765691755, -1.382617606, 1.738604494, 1.493795101, -2.083452834, -0.93082854, 0.524295198]
    dy2_center = 0.117178035
    ty2 = [2.62434536, 1.30041627, -0.02351282, -0.54851618, -0.388059035, 3.592101135, -2.30967309, 4.989531705,
           1.75422875, 2.10413284, 2.454169262, 5.594233559, -0.883105278, 2.047851677, 4.028075707, 6.571472937,
           2.549242638, 4.100956663, 4.308196379, 6.236005947, 8.276460406, 5.116745619, 10.07103975, 11.23379096,
           10.20095675, 12.09607946, 10.20097632, 12.3054387, 12.77213692, 15.25766198, 18.83378799, 17.78633411,
           19.88059793, 22.00469597, 23.84449758, 26.87127939, 31.05447745, 31.82392658, 37.57038034, 44.68299784,
           46.2520926, 48.16016116]
    y_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49, 47,
            53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    y_arima_ = [-1, 3.63158738, 2.833222925, 8.246633725, 8.45740841, 10.32127396, 13.95109758, 15.42190369,
               15.75515902, 20.64662654, 20.6423096, 22.26432179, 23.76316963, 28.83267072, 28.38131309,
               31.38874048, 31.4330339, 36.26387216, 35.53665943, 41.61722481, 37.66348969, 46.75054977,
               43.38474534, 49.10721545, 47.70512525, 51.92136064, 51.27449017, 56.18119216, 55.25551311,
               61.71981598, 58.09867799, 65.00459332, 62.56672054, 68.55389718, 66.80687316, 73.37847494,
               69.94453842, 77.84858735, 76.5981108, 80.96765954, 78.49265884, 84.26380529]
    y_ima_p0d2q1 = [1.7353783, 2.102343981, 2.302532586, 1.749354917, 2.653585657, 0.879090353, 2.055692629, 1.654198595,
             2.007863581, 2.008155108, 3.650756234, 2.557679151, 2.227771692, 1.730534954, 2.614611301, 1.887428128,
             1.59327885, 0.563001728, 0.069384035, 0.192991147, -1.019912055, -0.482265487, 0.440126416, 1.469733769,
             3.204466372, 3.86055961, 4.791143018, 4.902918582, 5.27020725, 6.357311899, 6.543094533, 6.733470482,
             6.490566966, 5.80156063, 4.919427454, 4.415769214, 2.856649393, 2.146116918, 3.033695243, 3.888933107,
             4.236829812, 3.848531803]
    arch = Arch()
    phi = []
    theta = [0.5]
    # theta = [0.3, 0.2, 0.1]
    p = 0
    d = 2
    q = 1
    y_arima = arch.arima(x=y_ima_p0d2q1, e=e, phi=None, theta=theta, p=p, d=d, q=q)
    error = np.array(y_ima_p0d2q1) - y_arima
    print("y_arima")
    print(y_arima)
    print("error")
    print(error)
    # dx_c, mean_dx, tx = arch.arima(x=y_42_e, e=None, phi=None, theta=None, p=p, d=d, q=q)
    # error_dx_c = np.array(dy2_c) - dx_c
    # error_tx = np.array(ty2) - tx
    # print("dx_c")
    # print(dx_c)
    # print("error_dx_c")
    # print(error_dx_c)
    # print("tx")
    # print(tx)
    # print("error_tx")
    # print(error_tx)
    # print("mean_dx")
    # print(mean_dx)
# y_ar
# [ 1.          1.1         1.21        1.331       1.4641      1.61051
#   1.771561    1.9487171   2.14358881  2.35794769  2.59374246  2.85311671
#   3.13842838  3.45227121  3.79749834  4.17724817  4.59497299  5.05447028
#   5.55991731  6.11590904  6.72749995  7.40024994  8.14027494  8.95430243
#   9.84973268 10.83470594 11.91817653 13.10999419 14.42099361 15.86309297
#  17.44940227 19.1943425  21.11377675 23.22515443 25.54766986 28.10243685
#  30.91268054 34.00394858 37.40434345 41.14477778 45.25925557 49.78518113]
# error
# [ 0.00000000e+00  0.00000000e+00 -2.22044605e-16  0.00000000e+00
#  -2.22044605e-16  0.00000000e+00 -2.22044605e-16  0.00000000e+00
#  -4.44089210e-16  0.00000000e+00 -1.00000452e-10 -4.44089210e-16
#   4.00000033e-10 -7.00000058e-10  5.99999606e-10 -6.00000050e-10
#   9.99991201e-11  3.99999145e-10 -5.00000930e-10  7.00000058e-10
#  -5.00000930e-10  9.99991201e-11  5.99998273e-10  1.00000008e-10
#  -3.00001801e-10 -3.60000207e-09  5.99999872e-09 -4.00000033e-09
#   9.99998306e-10 -1.00000186e-09  3.00000025e-09  3.00000025e-09
#  -3.55271368e-15 -5.00000397e-09 -2.00000017e-09  4.00000033e-09
#  -5.00000397e-09  6.99999703e-09 -9.00000430e-09  6.00000050e-09
#   9.99996530e-10 -7.00000413e-09]
# y_ma
# [ 1.7353783  -1.36841262 -0.16677708 -0.75336627  1.45740841 -2.67872605
#   2.95109758 -1.57809631  0.75515902 -0.35337346  1.6423096  -2.73567821
#   0.76316962 -0.16732928  1.38131309 -1.61125952  0.4330339  -0.73612784
#   0.53665943  0.6172248  -1.33651031  1.75054977  0.38474534  0.10721545
#   0.70512525 -1.07863936  0.27449017 -0.81880785  0.25551311  0.71981598
#  -0.90132201  0.00459331 -0.43327947 -0.44610282 -0.19312684  0.37847494
#  -1.05546158  0.84858734  1.5981108  -0.03234046 -0.50734116 -0.73619472]
# error
# [ 0.00000000e+00  0.00000000e+00  5.55111512e-17  0.00000000e+00
#   0.00000000e+00  4.44089210e-16  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  5.55111512e-17  0.00000000e+00 -4.44089210e-16
#   0.00000000e+00  2.77555756e-17 -2.22044605e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  1.11022302e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00 -5.55111512e-17  1.38777878e-17
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.30104261e-17
#   5.55111512e-17  0.00000000e+00  2.77555756e-17  0.00000000e+00
#   0.00000000e+00  0.00000000e+00 -2.22044605e-16  1.38777878e-17
#   0.00000000e+00  1.11022302e-16]
# dx_c  p=0,d=2,q=0
# [0.28228483050000025, 0.4252836505000001, 2.0639043205000003, -3.9676040545, 4.5580984655, -3.0467936594999996,
#  0.21061767550000038, 0.04678598650000014, 1.3598179135000001, -4.187381627500001, 2.5518680655000003,
#  0.7419785515000002, 0.5939868604999999, -3.044409353499999, 1.2061784694999993, -0.1277369374999991,
#  0.7378274395000001, 0.3666471494999998, -2.4753500674999995, 2.7607404115, -0.5739902745000004, -1.443376865499999,
#  0.6837010135000007, -1.6118514415000003, 1.135268025499999, -0.30983708449999764, 0.7959058654999985,
#  0.884664375500002, -1.9280467645000008, 0.5482464554999996, 0.23045131549999848, -0.08551157449999598,
#  0.4921452954999989, 0.7656917554999975, -1.3826176044999978, 1.7386044954999993, 1.4937950955000017,
#  -2.0834528244999997, -0.930828544499995, 0.5242951954999885]
# error_dx_c
# [-5.00000263e-10 -5.00000097e-10 -5.00000485e-10 -4.99999597e-10
#  -5.00000041e-10 -5.00000485e-10 -5.00000374e-10 -5.00000139e-10
#   4.99999819e-10 -4.99999153e-10 -5.00000485e-10  1.49999979e-09
#  -1.49999990e-09  1.49999879e-09 -4.99999375e-10 -5.00000902e-10
#   4.99999930e-10 -1.49999985e-09  1.49999968e-09 -5.00000041e-10
#  -4.99999597e-10  4.99998931e-10 -3.50000062e-09  6.50000032e-09
#  -3.49999896e-09 -5.00002373e-10  5.00001485e-10  6.49999798e-09
#  -3.49999918e-09 -5.49999957e-09  2.50000151e-09 -5.00004024e-10
#   2.50000110e-09 -4.99997488e-10 -1.50000212e-09 -1.49999924e-09
#   5.49999823e-09 -9.50000034e-09  4.49999493e-09  2.50001153e-09]
# tx
# [ 2.62434536e+00  1.30041627e+00 -2.35128200e-02 -5.48516180e-01
#  -3.88059035e-01  3.59210114e+00 -2.30967309e+00  4.98953170e+00
#   1.75422875e+00  2.10413284e+00  2.45416926e+00  5.59423356e+00
#  -8.83105278e-01  2.04785168e+00  4.02807571e+00  6.57147294e+00
#   2.54924264e+00  4.10095666e+00  4.30819638e+00  6.23600595e+00
#   8.27646041e+00  5.11674562e+00  1.00710398e+01  1.12337910e+01
#   1.02009568e+01  1.20960795e+01  1.02009763e+01  1.23054387e+01
#   1.27721369e+01  1.52576620e+01  1.88337880e+01  1.77863341e+01
#   1.98805979e+01  2.20046960e+01  2.38444976e+01  2.68712794e+01
#   3.10544774e+01  3.18239266e+01  3.75703803e+01  4.46829978e+01
#   4.62520926e+01  4.81601612e+01]
# error_tx
# [ 0.00000000e+00  0.00000000e+00  1.00613962e-16  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  8.88178420e-16
#   2.22044605e-16  0.00000000e+00  0.00000000e+00  0.00000000e+00
#  -1.11022302e-16 -9.99999639e-10  1.00000008e-09 -9.99999195e-10
#   9.99999195e-10  0.00000000e+00  0.00000000e+00  9.99999195e-10
#  -1.00000008e-09  9.99999195e-10 -4.00000033e-09 -3.99999855e-09
#  -2.00000017e-09 -7.00000058e-09  0.00000000e+00  1.77635684e-15
#  -1.77635684e-15 -9.99999905e-09  9.99999727e-09  9.99999727e-09
#   0.00000000e+00  3.55271368e-15 -3.55271368e-15  0.00000000e+00
#   3.55271368e-15  0.00000000e+00  0.00000000e+00  1.00000008e-08
#  -1.00000008e-08 -7.10542736e-15]
# mean_dx
# 0.11717803449999982
# y_arima
# [  1.          -0.26841262  -0.46203096  -0.22201859  -1.26558416
#    1.07079317  -6.72136417   7.10519854  -6.97589844   1.7790995
#   -1.260315     1.12359216  -9.11680928   1.89075827  -2.32537254
#   -0.03207518  -7.42950425  -1.3675122   -5.59842594  -1.63625081
#   -4.42945973  -7.18014288   0.94299567  -5.15839158  -4.06072724
#   -4.05553073  -8.48280849  -5.37410543  -9.35896273  -6.14236485
#   -7.93709428 -12.55167347 -10.55537795 -13.93020266 -15.01748076
#  -15.57655833 -17.30590539 -21.72286342 -16.80653708 -19.20026921
#  -25.87329907 -28.35056693]
# error
# [ 0.00000000e+00 -1.11022302e-16 -1.66533454e-16 -1.03958173e+00
#   1.33523221e+00 -3.67290636e+00  6.81013724e+00 -8.58564447e+00
#   6.10256694e+00 -3.09313761e+00  1.45718268e+00 -3.64271592e+00
#   7.10894276e+00 -4.26674073e+00  1.09310492e+00 -2.93467871e+00
#   4.59910886e+00 -2.48205057e+00  1.90056632e+00 -1.81416997e+00
#  -7.02513442e-01  3.28552217e+00 -4.84233312e+00  9.76335836e-01
#   1.65591172e-01 -1.30775831e+00  2.85768072e+00 -1.63234297e+00
#   1.90738260e+00 -1.33455732e+00 -1.18884212e+00  2.51773675e+00
#  -9.15231914e-01  8.66428996e-01  4.54202893e-01 -6.45723869e-02
#  -9.54799989e-01  2.48467485e+00 -2.75735954e+00 -2.35235754e+00
#   1.65806849e+00  9.77618582e-01]
# y_arima p=3 q=0
# [-1.  5.  3.  9.  7. 13. 11. 17. 15. 21. 19. 25. 23. 29. 27. 33. 31. 37.
#  35. 41. 39. 45. 43. 49. 47. 53. 51. 57. 55. 61. 59. 65. 63. 69. 67. 73.
#  71. 77. 75. 81. 79. 85.]
# error
# [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
#  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
# y_ma_3  p=0,q=3
# [ 1.7353783  -0.50072347 -0.41713881 -0.91018717  1.39852138 -2.24933691
#   2.41390188 -0.86647027  0.47300586 -0.32290873  1.5936451  -2.43638975
#   0.07255364  0.02290133  1.56389643 -1.28655634  0.01360389 -0.67511547
#   0.49445922  0.80737877 -1.15170747  1.39853822  0.7644291   0.15754748
#   0.49973031 -1.10022941 -0.10377932 -0.80782921  0.15020676  0.85457798
#  -0.65919966 -0.22412442 -0.43843686 -0.44612387 -0.19616137  0.47088081
#  -0.850328    0.68367951  1.85861918  0.35336458 -0.72543763 -1.10005417]
# error
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   2.22044605e-16  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
#   5.55111512e-17  5.89805982e-17 -2.22044605e-16  0.00000000e+00
#   5.03069808e-17  0.00000000e+00  5.55111512e-17  0.00000000e+00
#  -2.22044605e-16  2.22044605e-16 -1.11022302e-16  2.77555756e-17
#  -5.55111512e-17  0.00000000e+00  1.38777878e-17  0.00000000e+00
#   2.77555756e-17 -1.11022302e-16  0.00000000e+00  2.77555756e-17
#   0.00000000e+00  0.00000000e+00  2.77555756e-17 -5.55111512e-17
#   1.11022302e-16  0.00000000e+00 -2.22044605e-16  5.55111512e-17
#   1.11022302e-16  0.00000000e+00]
# y_arima  p=3,q=3
# [ 1.7353783  -0.50072347 -0.41713881 -0.92181951  0.36780299 -1.74381749
#   0.23777815 -0.18259022 -0.1241625  -0.37541381  1.16900437 -1.10023468
#  -1.44658815 -1.11449782  0.40721953 -0.90503292 -1.28627579 -1.82756835
#  -1.43961739 -0.66794185 -1.9640337  -0.91623396  0.01579011 -0.03464335
#   0.27521781 -0.78740312 -1.03189499 -1.73038951 -1.70432333 -0.88047878
#  -1.63293955 -2.18512682 -2.69158422 -3.29642905 -3.72094185 -3.50118625
#  -4.61673032 -4.43867496 -2.80081447 -2.76314241 -4.09246638 -5.6093016 ]
# error
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.11022302e-16
#   2.77555756e-16  1.00000008e-09 -5.99999994e-10  2.99999942e-10
#   2.00000086e-10  0.00000000e+00 -1.00000008e-10  6.99999836e-10
#  -5.99999828e-10  5.00000041e-10 -3.00000025e-10  4.00000033e-10
#  -1.00000008e-10  2.00000239e-10  6.00000050e-10 -1.11022302e-16
#   1.00000008e-10  1.00000563e-10  3.99999874e-10 -4.99999993e-10
#   2.99999969e-10  3.00000025e-10  2.00000239e-10 -3.99999811e-10
#   8.00000066e-10 -3.99999922e-10  6.00000272e-10 -5.00000041e-10
#   7.00000502e-10 -5.00000041e-10  4.00000033e-10  2.00000017e-10
#   2.00000905e-10 -4.00000033e-10  2.00000461e-10  2.00000461e-10
#  -2.00000017e-10  4.00000921e-10]
# y_arima_ p=1,d=2,q=1
# [-1.          3.63158738  2.83322292  6.76842198  8.96265563 11.24907112
#  13.54012418 14.29384477 19.86386428 16.92956962 22.67916942 22.85507686
#  23.08015243 25.27483049 31.7698096  31.89653261 31.4273947  33.7613114
#  36.90180296 41.04170045 39.61047972 45.55158279 43.23853794 52.63599882
#  46.50351422 52.40593395 50.85073856 54.72889567 55.84681275 60.93900903
#  59.94979287 64.62455213 61.00715382 69.083511   65.97987551 73.22950269
#  70.63296729 77.4217055  76.06973958 84.52679722 79.26681978 82.18299082]
# error
# [ 0.00000000e+00  0.00000000e+00  4.44089210e-16  1.47821174e+00
#  -5.05247224e-01 -9.27797159e-01  4.10973402e-01  1.12805892e+00
#  -4.10870526e+00  3.71705692e+00 -2.03685982e+00 -5.90755073e-01
#   6.83017202e-01  3.55784023e+00 -3.38849651e+00 -5.07792133e-01
#   5.63920150e-03  2.50256076e+00 -1.36514353e+00  5.75524362e-01
#  -1.94699003e+00  1.19896698e+00  1.46207402e-01 -3.52878337e+00
#   1.20161103e+00 -4.84573308e-01  4.23751606e-01  1.45229649e+00
#  -5.91299638e-01  7.80806947e-01 -1.85111488e+00  3.80041191e-01
#   1.55956672e+00 -5.29613823e-01  8.26997646e-01  1.48972251e-01
#  -6.88428873e-01  4.26881851e-01  5.28371217e-01 -3.55913768e+00
#  -7.74160943e-01  2.08081447e+00]
# y_ima_p0d2q1
# [ 1.7353783   2.10234398  2.30253259  1.74935492  2.65358566  0.87909035
#   2.05569263  1.6541986   2.00786358  2.00815511  3.65075623  2.55767915
#   2.22777169  1.73053495  2.6146113   1.88742813  1.59327885  0.56300173
#   0.06938404  0.19299115 -1.01991206 -0.48226549  0.44012642  1.46973377
#   3.20446637  3.86055961  4.79114302  4.90291858  5.27020725  6.3573119
#   6.54309453  6.73347048  6.49056697  5.80156063  4.91942745  4.41576921
#   2.85664939  2.14611692  3.03369524  3.88893311  4.23682981  3.8485318 ]
# error
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.00000030e-09
#  -1.00000008e-09  1.00000053e-09  0.00000000e+00 -2.22044605e-16
#   4.44089210e-16  9.99999639e-10 -9.99999639e-10  9.99999639e-10
#  -9.99999195e-10  9.99999639e-10  0.00000000e+00 -2.22044605e-16
#   0.00000000e+00  1.00000019e-09 -1.00000021e-09  2.77555756e-17
#   9.99999861e-10  4.99600361e-16 -5.55111512e-17  0.00000000e+00
#   0.00000000e+00  0.00000000e+00  0.00000000e+00  1.00000097e-09
#  -1.00000008e-09  9.99999195e-10  0.00000000e+00  8.88178420e-16
#  -8.88178420e-16  0.00000000e+00  0.00000000e+00  1.00000008e-09
#  -9.99999639e-10  1.00000008e-09 -4.44089210e-16 -9.99999639e-10
#   9.99999195e-10  1.00000008e-09]

def test_arma_least_squares_estimation():
    y_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49, 47,
            53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    y_ar = [1, 1.1, 1.21, 1.331, 1.4641, 1.61051, 1.771561, 1.9487171, 2.14358881, 2.357947691, 2.59374246,
              2.853116706, 3.138428377, 3.452271214, 3.797498336, 4.177248169, 4.594972986, 5.054470285,
              5.559917313, 6.115909045, 6.727499949, 7.400249944, 8.140274939, 8.954302433, 9.849732676,
              10.83470594, 11.91817654, 13.10999419, 14.42099361, 15.86309297, 17.44940227, 19.1943425,
              21.11377675, 23.22515442, 25.54766986, 28.10243685, 30.91268053, 34.00394859, 37.40434344,
              41.14477779, 45.25925557, 49.78518112]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_ma = [1.7353783, -1.36841262, -0.166777075, -0.753366275, 1.45740841, -2.678726045, 2.95109758, -1.57809631,
            0.75515902, -0.35337346, 1.6423096, -2.73567821, 0.763169625, -0.16732928, 1.381313085, -1.61125952,
            0.433033895, -0.736127845, 0.53665943, 0.617224805, -1.336510315, 1.75054977, 0.384745335, 0.10721545,
            0.70512525, -1.078639365, 0.27449017, -0.818807845, 0.255513105, 0.71981598, -0.901322015, 0.004593315,
            -0.433279465, -0.44610282, -0.19312684, 0.378474935, -1.05546158, 0.848587345, 1.5981108, -0.03234046,
            -0.50734116, -0.736194715]
    y_arma = [1, -0.26841262, -0.462030957, -1.261600327, 0.06964805, -2.60211319, 0.088773071, -1.480445931,
              -0.873331504, -1.314038115, 0.196867674, -2.519123769, -2.00786652, -2.375982452, -1.232267612,
              -2.966753893, -2.830395388, -3.849562771, -3.697859618, -3.450420775, -5.131973167, -3.894620714,
              -3.89933745, -4.182055745, -3.89513607, -5.363289042, -5.625127776, -7.006448398, -7.451580133,
              -7.476922166, -9.125936397, -10.03393672, -11.47060986, -13.06377366, -14.56327787, -15.64113072,
              -18.26070538, -19.23818857, -19.56389662, -21.55262675, -24.21523058, -27.37294835]
    y_arma_3 = [1.7353783, -0.50072347, -0.41713881, -0.92181951, 0.36780299, -1.743817484, 0.237778149, -0.182590216,
                -0.1241625, -0.375413807, 1.169004369, -1.100234682, -1.446588147, -1.114497817, 0.407219526,
                -0.905032923, -1.28627579, -1.82756835, -1.43961739, -0.667941851, -1.964033703, -0.916233958,
                0.015790115, -0.034643347, 0.275217813, -0.787403122, -1.031894986, -1.730389506, -1.704323326,
                -0.880478776, -1.632939545, -2.185126825, -2.691584215, -3.296429054, -3.72094185, -3.501186254,
                -4.616730324, -4.438674962, -2.800814468, -2.76314241, -4.092466378, -5.609301596]
    dx_c_42 = [-8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0,
               -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0, -8.0, 8.0,
               -8.0, 8.0, -8.0, 8.0]
    arch = Arch()
    p = 5
    q = 0
    phi, theat, R_2, B_1 = arch.arma_least_squares_estimation(y_streamflow_1460, e=e, p=p, q=q)
    print("phi")
    print(phi)
    print("theat")
    print(theat)
    print("R_2")
    print(R_2)
# phi
# [1.1]
# theat
# []
# R_2
# 1.0000000000000004
# phi
# []
# theat
# [0.5]
# R_2
# 1.0000000000000004
# phi
# [1.1]
# theat
# [0.5]
# R_2
# 0.9999999999999996
# y_42
# phi
# [ 1.  1. -1.]
# theat
# []
# R_2
# 1.0000000000000004
# y_arma_3
# phi
# [ 1.1 -0.2  0.2]
# theat
# [0.3 0.2 0.1]
# R_2
# 1.0000000000000004
# dx_c_42
# phi
# [-1.]
# theat
# []
# R_2
# 1.0
# y_residual_2_streamflow_1460 p=1 q=0
# phi
# [0.14032203]
# theat
# []
# R_2
# 0.01895381366485759
# y_residual_2_streamflow_1460 p=3 q=0
# phi
# [0.12751182 0.0629116  0.04566266]
# theat
# []
# R_2
# 0.025183448141315852
# y_streamflow_1460  p=3
# phi
# [ 1.80161201 -1.28440015  0.43756275]
# theat
# []
# R_2
# 0.9344269048513744
# y_streamflow_1460  p=4
# phi
# [ 1.87735466 -1.50673214  0.74942559 -0.173099  ]
# theat
# []
# R_2
# 0.9367795602495427
# y_streamflow_1460  p=5
# phi
# [ 1.91134184 -1.65388684  1.04528139 -0.5417279   0.19634819]
# theat
# []
# R_2
# 0.9387957167533237
def test_x_residual():
    y_42 = [-1, 5, 3, 9, 7, 13, 11, 17, 15, 21, 19, 25, 23, 29, 27, 33, 31, 37, 35, 41, 39, 45, 43, 49, 47,
            53, 51, 57, 55, 61, 59, 65, 63, 69, 67, 73, 71, 77, 75, 81, 79, 85]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_arma = [1, -0.26841262, -0.462030957, -1.261600327, 0.06964805, -2.60211319, 0.088773071, -1.480445931,
              -0.873331504, -1.314038115, 0.196867674, -2.519123769, -2.00786652, -2.375982452, -1.232267612,
              -2.966753893, -2.830395388, -3.849562771, -3.697859618, -3.450420775, -5.131973167, -3.894620714,
              -3.89933745, -4.182055745, -3.89513607, -5.363289042, -5.625127776, -7.006448398, -7.451580133,
              -7.476922166, -9.125936397, -10.03393672, -11.47060986, -13.06377366, -14.56327787, -15.64113072,
              -18.26070538, -19.23818857, -19.56389662, -21.55262675, -24.21523058, -27.37294835]
    y_arma_3 = [1.7353783, -0.50072347, -0.41713881, -0.92181951, 0.36780299, -1.743817484, 0.237778149, -0.182590216,
                -0.1241625, -0.375413807, 1.169004369, -1.100234682, -1.446588147, -1.114497817, 0.407219526,
                -0.905032923, -1.28627579, -1.82756835, -1.43961739, -0.667941851, -1.964033703, -0.916233958,
                0.015790115, -0.034643347, 0.275217813, -0.787403122, -1.031894986, -1.730389506, -1.704323326,
                -0.880478776, -1.632939545, -2.185126825, -2.691584215, -3.296429054, -3.72094185, -3.501186254,
                -4.616730324, -4.438674962, -2.800814468, -2.76314241, -4.092466378, -5.609301596]
    y_arima_ = [-1, 3.63158738, 2.833222925, 8.246633725, 8.45740841, 10.32127396, 13.95109758, 15.42190369,
               15.75515902, 20.64662654, 20.6423096, 22.26432179, 23.76316963, 28.83267072, 28.38131309,
               31.38874048, 31.4330339, 36.26387216, 35.53665943, 41.61722481, 37.66348969, 46.75054977,
               43.38474534, 49.10721545, 47.70512525, 51.92136064, 51.27449017, 56.18119216, 55.25551311,
               61.71981598, 58.09867799, 65.00459332, 62.56672054, 68.55389718, 66.80687316, 73.37847494,
               69.94453842, 77.84858735, 76.5981108, 80.96765954, 78.49265884, 84.26380529]
    arch = Arch()
    p = 3
    d = 0
    q = 3
    x_residual, y_t, R_2, phi, theta, se_beta = arch.x_residual(y_arma_3_100, e_100, p, d, q)
    print("x_residual")
    print(x_residual)
    print("y_t")
    print(y_t)
    print("R_2")
    print(R_2)
    print("phi")
    print(phi)
    print("theta")
    print(theta)
    print("se_beta")
    print(se_beta)
# x_residual
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  4.13844514e-11
#   1.56662294e-10  7.87194754e-10 -1.77807047e-10 -2.26987956e-10
#   5.21301516e-10 -1.11195664e-10 -1.12275078e-10  4.90903318e-10
#  -1.61525904e-10  2.20385710e-10 -3.22448512e-10  2.88028601e-10
#   1.70512715e-10  4.63185046e-12  6.24862828e-10 -1.06068154e-10
#   8.88311646e-12  2.75892309e-10  1.98695019e-11 -5.22870115e-10
#   3.20349025e-10  1.27309052e-10  3.13661319e-10 -5.37479616e-10
#   8.55849835e-10 -4.94138064e-10  4.74455808e-10 -3.66128017e-10
#   5.77501602e-10 -5.54486235e-10  3.70079523e-10  1.00500497e-10
#   3.07363024e-11 -3.61678687e-10 -1.22156951e-10 -1.31422873e-10
#  -2.18366658e-10  2.72983414e-10]
# y_arma_3
# [ 1.7353783  -0.50072347 -0.41713881 -0.92181951  0.36780299 -1.74381748
#   0.23777815 -0.18259022 -0.1241625  -0.37541381  1.16900437 -1.10023468
#  -1.44658815 -1.11449782  0.40721953 -0.90503292 -1.28627579 -1.82756835
#  -1.43961739 -0.66794185 -1.9640337  -0.91623396  0.01579011 -0.03464335
#   0.27521781 -0.78740312 -1.03189499 -1.73038951 -1.70432333 -0.88047878
#  -1.63293955 -2.18512682 -2.69158422 -3.29642905 -3.72094185 -3.50118625
#  -4.61673032 -4.43867496 -2.80081447 -2.76314241 -4.09246638 -5.6093016 ]
# R_2
# 1.0000000000000004
# x_residual
# [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
#  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
# y_42
# [-1.  5.  3.  9.  7. 13. 11. 17. 15. 21. 19. 25. 23. 29. 27. 33. 31. 37.
#  35. 41. 39. 45. 43. 49. 47. 53. 51. 57. 55. 61. 59. 65. 63. 69. 67. 73.
#  71. 77. 75. 81. 79. 85.]
# R_2
# 1.0
# a_diagonal
# [0.00040064]
# x_residual
# [ 0.00000000e+00  0.00000000e+00  4.44089210e-16  1.40331335e+00
#  -8.17717294e-01 -4.99646601e-01 -3.29780729e-01  1.84984922e+00
#  -4.27926446e+00  3.93349275e+00 -2.04579485e+00  5.20593307e-02
#   2.96326628e-02  3.53882280e+00 -3.44268153e+00  1.84931853e-02
#  -3.06962969e-01  2.54767613e+00 -1.60210167e+00  7.07292812e-01
#  -1.66289830e+00  9.33161702e-01  6.11715380e-01 -3.06226425e+00
#   1.44870941e+00 -3.69034572e-02  2.54079400e-01  1.52194864e+00
#  -8.51870393e-01  8.01416393e-01 -1.58802027e+00  2.62271187e-01
#   1.47652842e+00 -6.48347871e-01  5.89154885e-01  3.03825909e-02
#  -6.24899347e-01  1.54941652e-01  6.70700736e-01 -2.82999462e+00
#  -4.28358225e-01  2.13245049e+00]
# y_arima_
# [-1.          3.63158738  2.83322292  6.84332038  9.2751257  10.82092056
#  14.28087831 13.57205447 20.03442348 16.71313379 22.68810445 22.21226246
#  23.73353697 25.29384792 31.82399462 31.37024729 31.73999687 33.71619603
#  37.1387611  40.909932   39.32638799 45.81738807 42.77302996 52.1694797
#  46.25641584 51.9582641  51.02041077 54.65924352 56.1073835  60.91839959
#  59.68669826 64.74232213 61.09019212 69.20224505 66.21771828 73.34809235
#  70.56943777 77.6936457  75.92741006 83.79765416 78.92101707 82.1313548 ]
# R_2
# 0.9430946447793861
# phi
# [-0.99651228]
# theta
# [0.86154508]
# se_beta
# [0.03930439469615502, 0.29713902184498536]
# x_residual  p=1,d=2,q=0
# [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
#  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
# y_42
# [-1.  5.  3.  9.  7. 13. 11. 17. 15. 21. 19. 25. 23. 29. 27. 33. 31. 37.
#  35. 41. 39. 45. 43. 49. 47. 53. 51. 57. 55. 61. 59. 65. 63. 69. 67. 73.
#  71. 77. 75. 81. 79. 85.]
# R_2
# 1.0
# phi
# [-1.]
# theta
# []
# se_beta
# [nan]
# x_residual  p=1,d=2,q=1
# [ 0.          0.          0.          0.79397652 -0.51466611  1.725641
#  -1.13232029 -0.00205007 -0.03471921 -0.21012213 -1.28683611  1.3571145
#   0.88347822  0.06122573 -0.92980285  0.46681841  0.52890566  0.52307427
#   0.26695905 -0.98332938  1.09859177 -1.30175444 -1.02333415 -1.08610094
#  -0.88577079  0.10027781  0.39070302  0.57043108  0.58939896 -0.86480166
#   0.70081002  0.15259318  0.89384488  0.6000891   0.97346217 -0.23584514
#   1.24215142 -0.38789033 -1.58760219 -1.48718962  0.15588401  0.53697959]
# y_42
# [-1.          5.          3.          8.20602348  7.51466611 11.274359
#  12.13232029 17.00205007 15.03471921 21.21012213 20.28683611 23.6428855
#  22.11652178 28.93877427 27.92980285 32.53318159 30.47109434 36.47692573
#  34.73304095 41.98332938 37.90140823 46.30175444 44.02333415 50.08610094
#  47.88577079 52.89972219 50.60929698 56.42956892 54.41060104 61.86480166
#  58.29918998 64.84740682 62.10615512 68.3999109  66.02653783 73.23584514
#  69.75784858 77.38789033 76.58760219 82.48718962 78.84411599 84.46302041]
# R_2
# 0.9893443873943417
# phi
# [-1.03210395]
# theta
# [-0.21305252]
# se_beta
# [0.018171873517133032, 0.15570320780260488]
# x_residual  p=3,d=0,q=3
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  4.13844514e-11
#   1.56662294e-10  7.87194754e-10 -1.77807047e-10 -2.26987956e-10
#   5.21301516e-10 -1.11195664e-10 -1.12275078e-10  4.90903318e-10
#  -1.61525904e-10  2.20385710e-10 -3.22448512e-10  2.88028601e-10
#   1.70512715e-10  4.63185046e-12  6.24862828e-10 -1.06068154e-10
#   8.88311646e-12  2.75892309e-10  1.98695019e-11 -5.22870115e-10
#   3.20349025e-10  1.27309052e-10  3.13661319e-10 -5.37479616e-10
#   8.55849835e-10 -4.94138064e-10  4.74455808e-10 -3.66128017e-10
#   5.77501602e-10 -5.54486235e-10  3.70079523e-10  1.00500497e-10
#   3.07363024e-11 -3.61678687e-10 -1.22156951e-10 -1.31422873e-10
#  -2.18366658e-10  2.72983414e-10]
# y_arma_3
# [ 1.7353783  -0.50072347 -0.41713881 -0.92181951  0.36780299 -1.74381748
#   0.23777815 -0.18259022 -0.1241625  -0.37541381  1.16900437 -1.10023468
#  -1.44658815 -1.11449782  0.40721953 -0.90503292 -1.28627579 -1.82756835
#  -1.43961739 -0.66794185 -1.9640337  -0.91623396  0.01579011 -0.03464335
#   0.27521781 -0.78740312 -1.03189499 -1.73038951 -1.70432333 -0.88047878
#  -1.63293955 -2.18512682 -2.69158422 -3.29642905 -3.72094185 -3.50118625
#  -4.61673032 -4.43867496 -2.80081447 -2.76314241 -4.09246638 -5.6093016 ]
# R_2
# 1.0000000000000004
# phi
# [ 1.1 -0.2  0.2]
# theta
# [0.3 0.2 0.1]
# se_beta
# [3.526733475186766e-10, 3.718670773606283e-10, 1.7479428215457548e-10, 3.5304111238549773e-10, 1.746122221821107e-10, 1.4576179032287249e-10]
# x_residual
# [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  7.07850714e-06
#  -1.84118727e-05 -4.96932612e-05  1.18716461e-05 -3.45149134e-06
# y_t
# [  1.62434536  -0.61175641  -0.52817175  -1.06196741   0.22235134
#   -1.95349311   0.06139824  -0.41122424  -0.40623355  -0.6993039
# R_2
# 0.9999999999871758
# phi
# [ 1.05000148 -0.19999837  0.19999655]
# theta
# [0.30000549 0.2000049  0.0999975 ]
# se_beta
# [2.330751891026416e-05, 2.5574868559214998e-05, 8.828379847179134e-06, 2.3583773354609526e-05, 1.1762251886041388e-05, 9.797838306742823e-06]

def test_x_residual_streamflow():
    arch = Arch()
    p = 5
    d = 0
    q = 0
    x_residual, y_t, R_2, phi, theta, se_beta = arch.x_residual(y_streamflow_1460, e_100, p, d, q)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\x_residual.txt', x_residual)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\y_t.txt', y_t)
    print("R_2")
    print(R_2)
    print("phi")
    print(phi)
    print("theta")
    print(theta)
    print("se_beta")
    print(se_beta)
# y_residual_streamflow_1460  p=2
# R_2
# 0.9207290207522015
# phi
# [ 1.5331421  -0.61353046]
# theta
# []
# se_beta
# [0.02077505901306154, 0.020776326740508087]
# y_residual_streamflow_1460  p=3
# R_2
# 0.9344269048513744
# phi
# [ 1.80161201 -1.28440015  0.43756275]
# theta
# []
# se_beta
# [0.02400366981844562, 0.040984491020285965, 0.024005252043346952]
# y_streamflow_395 p=3
# R_2
# 0.9950663164644005
# phi
# [ 2.40237309 -2.01357576  0.61026411]
# theta
# []
# se_beta
# [0.04991477786357921, 0.09593768871420823, 0.049900263471139426]
# y_streamflow_395 p=2
# R_2
# 0.9933629294169934
# phi
# [ 1.86818005 -0.87194949]
# theta
# []
# se_beta
# [0.027635877526645366, 0.02762854656367414]

def test_LB_statistic():
    y_residual = [0, 0, -0.65798056, 1.20741142, -0.99820696, 2.40876836, -1.85362018, 0.85126399, -0.45792635,
                  0.36726925, -1.61099009, 2.1557183, 0.20889489, 0.51447928, -1.28002155, 1.20188049, 0.04015461,
                  1.00535443, -0.17882309, -0.45951062, 0.93548651, -0.99910244, -1.07769606, -0.39597124, -1.06442015]
    y_residual_42 = [0, 0, 0, 1.07296862, -0.86540763, 2.3015387, -1.74481176, 0.7612069, -0.3190391, 0.24937038,
                     -1.46210794, 2.06014071, 0.3224172, 0.38405435, -1.13376944, 1.09989127, 0.17242821, 0.87785842,
                     -0.04221375, -0.58281521, 1.10061918, -1.14472371, -0.90159072, -0.50249434, -0.90085595,
                     0.68372786, 0.12289023, 0.93576943, 0.26788808, -0.53035547, 0.69166075, 0.39675353, 0.6871727,
                     0.84520564, 0.67124613, 0.0126646, 1.11731035, -0.2344157, -1.65980218, -0.74204416, 0.19183555,
                     0.88762896]
    e_42 = [1.62434536, -0.61175641, -0.52817175, -1.07296862, 0.86540763, -2.3015387, 1.74481176, -0.7612069,
            0.3190391, -0.24937038, 1.46210794, -2.06014071, -0.3224172, -0.38405435, 1.13376944, -1.09989127,
            -0.17242821, -0.87785842, 0.04221375, 0.58281521, -1.10061918, 1.14472371, 0.90159072, 0.50249434,
            0.90085595, -0.68372786, -0.12289023, -0.93576943, -0.26788808, 0.53035547, -0.69166075, -0.39675353,
            -0.6871727, -0.84520564, -0.67124613, -0.0126646, -1.11731035, 0.2344157, 1.65980218, 0.74204416,
            -0.19183555, -0.88762896]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_arma_3_residual = [0.00E+00, 0.00E+00, 0.00E+00, 4.14E-11, 1.57E-10, 7.87E-10, -1.78E-10, -2.27E-10, 5.21E-10,
                         -1.11E-10, -1.12E-10, 4.91E-10, -1.62E-10, 2.20E-10, -3.22E-10, 2.88E-10, 1.71E-10, 4.63E-12,
                         6.25E-10, -1.06E-10, 8.88E-12, 2.76E-10, 1.99E-11, -5.23E-10, 3.20E-10, 1.27E-10, 3.14E-10,
                         -5.37E-10, 8.56E-10, -4.94E-10, 4.74E-10, -3.66E-10, 5.78E-10, -5.54E-10, 3.70E-10, 1.01E-10,
                         3.07E-11, -3.62E-10, -1.22E-10, -1.31E-10, -2.18E-10, 2.73E-10]
    y_residual_42_p1d2 = [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                          0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]
    y_residual_arima_p1d2q1 = [0.0000, 0.0000, 0.0000, 0.7940, -0.5147, 1.7256, -1.1323, -0.0021, -0.0347, -0.2101,
                               -1.2868, 1.3571, 0.8835, 0.0612, -0.9298, 0.4668, 0.5289, 0.5231, 0.2670, -0.9833,
                               1.0986, -1.3018, -1.0233, -1.0861, -0.8858, 0.1003, 0.3907, 0.5704, 0.5894, -0.8648,
                               0.7008, 0.1526, 0.8938, 0.6001, 0.9735, -0.2358, 1.2422, -0.3879, -1.5876, -1.4872,
                               0.1559, 0.5370]
    arch = Arch()
    m = 1
    LB, acf = arch.LB_statistic(e, m)
    print("LB")
    print(LB)
    print("acf")
    print(acf)
# LB
# 27.829265039808767
# acf
# [-0.28481598529511254, 0.18435464616999242, -0.2735880527973914, 0.19595639700086842, -0.3141998549392499,
#  0.15981852447176298, -0.20192173274245087, 0.11507419162945515, -0.0962735984624025, 0.1350466929485835,
#  -0.2528406547808198, -0.049099378738369524, -0.05686051624781958, 0.08785513043231927, 0.12662767453208082,
#  0.09301925304520033, -0.014631827266700313, -0.03579969070491006]
# LB
# 3.6563421669841074
# acf
# [-0.28481598529511254]

def test_get_chi_critical():
    arch = Arch()
    m = 1
    p = 0.05
    chi_critical = arch.get_chi_critical(m, p)
    print("chi_critical")
    print(chi_critical)
# chi_critical
# 9.39
# chi_critical
# 0.004

def test_test_arima():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual_42 = [0, 0, 0, 1.07296862, -0.86540763, 2.3015387, -1.74481176, 0.7612069, -0.3190391, 0.24937038,
                     -1.46210794, 2.06014071, 0.3224172, 0.38405435, -1.13376944, 1.09989127, 0.17242821, 0.87785842,
                     -0.04221375, -0.58281521, 1.10061918, -1.14472371, -0.90159072, -0.50249434, -0.90085595,
                     0.68372786, 0.12289023, 0.93576943, 0.26788808, -0.53035547, 0.69166075, 0.39675353, 0.6871727,
                     0.84520564, 0.67124613, 0.0126646, 1.11731035, -0.2344157, -1.65980218, -0.74204416, 0.19183555,
                     0.88762896]
    y_arma_3_residual = [0.00E+00, 0.00E+00, 0.00E+00, 4.14E-11, 1.57E-10, 7.87E-10, -1.78E-10, -2.27E-10, 5.21E-10,
                         -1.11E-10, -1.12E-10, 4.91E-10, -1.62E-10, 2.20E-10, -3.22E-10, 2.88E-10, 1.71E-10, 4.63E-12,
                         6.25E-10, -1.06E-10, 8.88E-12, 2.76E-10, 1.99E-11, -5.23E-10, 3.20E-10, 1.27E-10, 3.14E-10,
                         -5.37E-10, 8.56E-10, -4.94E-10, 4.74E-10, -3.66E-10, 5.78E-10, -5.54E-10, 3.70E-10, 1.01E-10,
                         3.07E-11, -3.62E-10, -1.22E-10, -1.31E-10, -2.18E-10, 2.73E-10]
    y_residual_arima_p1d2q1 = [0.0000, 0.0000, 0.0000, 0.7940, -0.5147, 1.7256, -1.1323, -0.0021, -0.0347, -0.2101,
                               -1.2868, 1.3571, 0.8835, 0.0612, -0.9298, 0.4668, 0.5289, 0.5231, 0.2670, -0.9833,
                               1.0986, -1.3018, -1.0233, -1.0861, -0.8858, 0.1003, 0.3907, 0.5704, 0.5894, -0.8648,
                               0.7008, 0.1526, 0.8938, 0.6001, 0.9735, -0.2358, 1.2422, -0.3879, -1.5876, -1.4872,
                               0.1559, 0.5370]
    y_residual_arma_3_p3d0q3 = [0.00E+00, 0.00E+00, 0.00E+00, 4.14E-11, 1.57E-10, 7.87E-10, -1.78E-10, -2.27E-10,
                                5.21E-10, -1.11E-10, -1.12E-10, 4.91E-10, -1.62E-10, 2.20E-10, -3.22E-10, 2.88E-10,
                                1.71E-10, 4.63E-12, 6.25E-10, -1.06E-10, 8.88E-12, 2.76E-10, 1.99E-11, -5.23E-10,
                                3.20E-10, 1.27E-10, 3.14E-10, -5.37E-10, 8.56E-10, -4.94E-10, 4.74E-10, -3.66E-10,
                                5.78E-10, -5.54E-10, 3.70E-10, 1.01E-10, 3.07E-11, -3.62E-10, -1.22E-10, -1.31E-10,
                                -2.18E-10, 2.73E-10]
    arch = Arch()
    m = 6
    p = 0.05
    b_significant = arch.test_arima(y_residual_streamflow_1460, m, p)
    print("b_significant")
    print(b_significant)
# b_significant  m=6 y_residual_arima_p1d2q1
# True
# b_significant  y_residual_arma_3_p3d0q3
# False
# b_significant e_1000
# True
# b_significant  y_residual_arma_3_p3d0q3_100 m=6
# False
# b_significant  e_42 m=6
# False
# b_significant  y_residual_streamflow_1460 m=6  p=3
# False

def test_t_statistic():
    y_residual = [0,  0,  -7.00148942,  2.81307703,  -0.86616938,  2.35613508,  -1.19714684,  0.4232423,  -0.4589695,
                  0.54786256,  -1.83051924,  1.84837348,  0.76232344,  0.96888897,  -1.44205859,  1.03469247,
                  0.18368458,  1.3957388,  -0.13007158]
    y_residual_42_p1d2 = [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                          0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]
    y_residual_arima_p1d2q1 = [0.0000, 0.0000, 0.0000, 0.7940, -0.5147, 1.7256, -1.1323, -0.0021, -0.0347, -0.2101,
                               -1.2868, 1.3571, 0.8835, 0.0612, -0.9298, 0.4668, 0.5289, 0.5231, 0.2670, -0.9833,
                               1.0986, -1.3018, -1.0233, -1.0861, -0.8858, 0.1003, 0.3907, 0.5704, 0.5894, -0.8648,
                               0.7008, 0.1526, 0.8938, 0.6001, 0.9735, -0.2358, 1.2422, -0.3879, -1.5876, -1.4872,
                               0.1559, 0.5370]
    y_residual_arma_3_p3d0q3 = [0.00E+00, 0.00E+00, 0.00E+00, 4.14E-11, 1.57E-10, 7.87E-10, -1.78E-10, -2.27E-10,
                                5.21E-10, -1.11E-10, -1.12E-10, 4.91E-10, -1.62E-10, 2.20E-10, -3.22E-10, 2.88E-10,
                                1.71E-10, 4.63E-12, 6.25E-10, -1.06E-10, 8.88E-12, 2.76E-10, 1.99E-11, -5.23E-10,
                                3.20E-10, 1.27E-10, 3.14E-10, -5.37E-10, 8.56E-10, -4.94E-10, 4.74E-10, -3.66E-10,
                                5.78E-10, -5.54E-10, 3.70E-10, 1.01E-10, 3.07E-11, -3.62E-10, -1.22E-10, -1.31E-10,
                                -2.18E-10, 2.73E-10]
    arch = Arch()
    phi = [1.1, -0.2, 0.2]
    theta = [0.3, 0.2, 0.1]
    se_beta = [3.526733475186766e-10, 3.718670773606283e-10, 1.7479428215457548e-10, 3.5304111238549773e-10, 1.746122221821107e-10, 1.4576179032287249e-10]
    t_statistic = arch.t_statistic(y_residual_arma_3_p3d0q3, phi, theta, se_beta)
    print("t_statistic")
    print(t_statistic)
# t_statistic
# [-57.54816672  -1.3860782 ]
# t_statistic
# [ 3.11903354e+09 -5.37826584e+08  1.14420219e+09  8.49759389e+08
#   1.14539519e+09  6.86050849e+08]

def test_get_t_critical():
    arch = Arch()
    m = 18
    p = 0.05
    t_critical = arch.get_t_critical(42-m, p)
    print("t_critical")
    print(t_critical)
# t_critical
# 1.711

def test_test_parameters():
    y_residual_arima_p1d2q1 = [0.0000, 0.0000, 0.0000, 0.7940, -0.5147, 1.7256, -1.1323, -0.0021, -0.0347, -0.2101,
                               -1.2868, 1.3571, 0.8835, 0.0612, -0.9298, 0.4668, 0.5289, 0.5231, 0.2670, -0.9833,
                               1.0986, -1.3018, -1.0233, -1.0861, -0.8858, 0.1003, 0.3907, 0.5704, 0.5894, -0.8648,
                               0.7008, 0.1526, 0.8938, 0.6001, 0.9735, -0.2358, 1.2422, -0.3879, -1.5876, -1.4872,
                               0.1559, 0.5370]
    y_residual_arma_3_p3d0q3 = [0.00E+00, 0.00E+00, 0.00E+00, 4.14E-11, 1.57E-10, 7.87E-10, -1.78E-10, -2.27E-10,
                                5.21E-10, -1.11E-10, -1.12E-10, 4.91E-10, -1.62E-10, 2.20E-10, -3.22E-10, 2.88E-10,
                                1.71E-10, 4.63E-12, 6.25E-10, -1.06E-10, 8.88E-12, 2.76E-10, 1.99E-11, -5.23E-10,
                                3.20E-10, 1.27E-10, 3.14E-10, -5.37E-10, 8.56E-10, -4.94E-10, 4.74E-10, -3.66E-10,
                                5.78E-10, -5.54E-10, 3.70E-10, 1.01E-10, 3.07E-11, -3.62E-10, -1.22E-10, -1.31E-10,
                                -2.18E-10, 2.73E-10]
    arch = Arch()
    # phi = [1.1, -0.2, 0.2]
    # theta = [0.3, 0.2, 0.1]
    # se_beta = [3.526733475186766e-10, 3.718670773606283e-10, 1.7479428215457548e-10, 3.5304111238549773e-10, 1.746122221821107e-10, 1.4576179032287249e-10]
    # phi = [1.05000148, -0.19999837, 0.19999655]
    # theta = [0.30000549, 0.2000049, 0.0999975 ]
    # se_beta = [2.330751891026416e-05, 2.5574868559214998e-05, 8.828379847179134e-06, 2.3583773354609526e-05, 1.1762251886041388e-05, 9.797838306742823e-06]
    # phi = [1.86818005, -0.87194949]
    # theta = []
    # se_beta = [0.027635877526645366, 0.02762854656367414]
    phi = [1.80161201, -1.28440015, 0.43756275]
    theta = []
    se_beta = [0.02400366981844562, 0.040984491020285965, 0.024005252043346952]
    m = 6
    significance_level = 0.05
    b_significant = arch.test_parameters(y_residual_streamflow_1460, phi, theta, se_beta, m, significance_level)
    print("b_significant")
    print(b_significant)
# b_significant  m=6 y_residual_arma_3_p3d0q3
# [True, True, True, True, True, True]
# b_significant  m=6 y_residual_arma_3_p3d0q3_100
# [True, True, True, True, True, True]
# b_significant  m=6 y_residual_streamflow_395
# [True, True]
# b_significant  m=6 y_residual_streamflow_1460
# [True, True, True]

def test_arma_one_step():
    arch = Arch()
    x = [54.3, 53.2, 52.1, 50.9, 50.4, 50.4, 50.4, 50.4, 50.0, 49.3]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    phi = [1.80161201, -1.28440015, 0.43756275]
    theta = [0.5]
    p=3
    x_ = x[-p:]
    x_.reverse()
    x_infer = arch.arma_one_step(x=x_, phi=phi)
    print("x_infer")
    print(x_infer)
# x_infer
# 46.652627192999994

def test_reverse_integrate_one_degree_one_step():
    arch = Arch()
    x_infer_t = 0.0
    x_t_ = -0.6
    x_infer = arch.reverse_integrate_one_degree_one_step(x_infer_t, x_t_)
    print("x_infer")
    print(x_infer)
# x_infer
# -0.6

def test_reverse_integrate_d_degree_one_step():
    arch = Arch()
    d = 3
    x_infer_t = 0.1
    x_t_ = [97.0, 96.5, 95.9]
    x_infer = arch.reverse_integrate_d_degree_one_step(d, x_infer_t, x_t_)
    print("x_infer")
    print(x_infer)
# x_infer
# 95.30000000000001

def test_arima_infer():
    arch = Arch()
    x = [54.3, 53.2, 52.1, 50.9, 50.4, 50.4, 50.4, 50.4, 50.0, 49.3 ]
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    phi = [1.80161201, -1.28440015, 0.43756275]
    theta = [0.5]
    t = 10
    p=3
    d=0
    q=0
    x_infer = arch.arima_infer(t=t, x=x, phi=phi, p=p, d=d)
    print("x_infer")
    print(x_infer)
# x_infer
# [46.652627192999994, 42.60714355396138, 38.41274374902763, 34.89369075281492, 32.17085740345077, 29.94992722295506,
#  27.906073792332272, 25.884995513871274, 23.897125949780055, 22.017315385116646]

def test_infer_ar():
    arch = Arch()
    x = [96, 97.2]
    phi =[10, 0.6, 0.3]
    l = 3
    p = 2
    b_constant = True
    x_infer = arch.infer_ar(x, phi, p, l, b_constant)
    print("x_infer = ", x_infer)
# x_infer =  [97.11999999999999, 97.43199999999999, 97.59519999999998]

def test_var_infer_l_ar():
    arch = Arch()
    x_infer = [97.12, 97.432, 97.5952]
    phi = [0.6, 0.3]
    l = 3
    p = 2
    std_e = 6
    G, var_ar, confidence_range_95 = arch.var_infer_l_ar(x_infer, phi, l, p, std_e)
    print("G = ", G)
    print("var_ar = ", var_ar)
    print("confidence_range_95 = ", confidence_range_95)
# G =  [1, 0.6, 0.6599999999999999]
# var_ar =  [36.0, 48.959999999999994, 64.6416]
# confidence_range_95 =  [[85.36, 108.88000000000001], [83.71760114332386, 111.14639885667614], [81.83680000000001, 113.3536]]

def test_infer_ar_reverse():
    arch = Arch()
    x = [96, 97.2, 97.11999999999999, ]
    x = [97.43199999999999, 97.59519999999998]
    # x = [530, 525]
    x = [525, 520]
    phi =[10, 0.6, 0.3]
    phi = [1.85816724, -0.86378065]
    l = 1
    p = 2
    b_constant = False
    x_infer = arch.infer_ar_reverse(x, phi, p, l, b_constant)
    print("x_infer = ", x_infer)
# x_infer =  [527.3767142155823]
# x_infer =  [95.9999999999998, 97.20000000000005, 97.11999999999996]

def test_ma_infer():
    arch = Arch()
    e = [-6, 8, -4]
    theta = [0.8, -0.6, 0.2]
    center = 100
    l = 5
    q = 3
    x_infer = arch.ma_infer(e, theta, l, q, center)
    print("x_infer = ", x_infer)
# x_infer =  [109.2, 96.0, 100.8, 100.0, 100.0]

def test_var_infer_l_ma():
    arch = Arch()
    x_infer = [109.2, 96, 100.8, 100, 100]
    theta = [0.8, -0.6, 0.2]
    l = 5
    q = 3
    var_e = 25
    var_ma, confidence_range_95 = arch.var_infer_l_ma(x_infer, theta, l, q, var_e)
    print("var_ma = ", var_ma)
    print("confidence_range_95 = ", confidence_range_95)
# var_ma =  [25, 41.0, 50.0, 51.0, 51.0]
# confidence_range_95 =  [[99.4, 119.0], [83.44987649463161, 108.55012350536839],
#                         [86.94070708874366, 114.65929291125633], [86.00280028005601, 113.99719971994399],
#                         [86.00280028005601, 113.99719971994399]]

def test_arma_infer():
    arch = Arch()
    x = [96, 97.2]
    e = [-6, 8, -4]
    phi = [0.6, 0.3]
    theta = [0.8, -0.6, 0.2]
    p = 2
    q = 3
    l = 5
    x_infer = arch.arma_infer(x, e, phi, theta, p, q, l)
    print("x_infer = ", x_infer)

def test_var_infer_l_arma():
    arch = Arch()
    x_infer = [109.2, 96, 100.8, 100, 100]
    phi = [0.6, 0.3]
    theta = [0.8, -0.6, 0.2]
    var_e = 25
    p = 2
    q = 3
    l = 5
    G, var_arma, confidence_range_95 = arch.var_infer_l_arma(x_infer, phi, theta, var_e, p, q, l)
    print("G = ", G)
    print("var_arma = ", var_arma)
    print("confidence_range_95 = ", confidence_range_95)

def test_arima_infer_():
    arch = Arch()
    x = [4.5, 5.3]
    e = [0.8]
    phi = [1.8, -0.8]
    theta = [-0.6]
    p = 2
    q = 1
    l = 3
    x_infer = arch.arima_infer_(x, e, phi, theta, p, q, l)
    print("x_infer = ", x_infer)

def test_var_infer_l_arima():
    arch = Arch()
    x_infer = [5.46, 5.59, 5.69]
    phi = [1.8, -0.8]
    theta = [-0.6]
    var_e = 1
    p = 2
    q = 1
    l = 3
    var_arima, confidence_range_95 = arch.var_infer_l_arima(x_infer, phi, theta, var_e, p, q, l)
    print("var_arima = ", var_arima)
    print("confidence_range_95 = ", confidence_range_95)

def test_LM_statistic():
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    q = 3
    y_residual_2 = np.power(y_residual, 2)
    y_residual_2 = y_residual_2.tolist()
    a, R_2 = arch.ar_least_squares_estimation(y_residual_2_streamflow_395, q)
    residual_2_fit = arch.arma(y_residual_2_streamflow_395, e=None, phi=a, theta=None, p=q, q=0)  # ar model
    e = y_residual_2_streamflow_395 - residual_2_fit
    e_2 = np.power(e, 2)
    LM = arch.LM_statistic(y_residual_2_streamflow_395, q, e_2)
    print("LM")
    print(LM)
# LM
# 0.6707065303253715
# LM
# -129.27344400589584

def test_F_statistic():
    arch = Arch()
    R_2 = 0.025185118907720204
    k = 3
    n = 1460
    F_statistic = arch.F_statistic(R_2, k, n)
    print("F_statistic")
    print(F_statistic)
# F_statistic
# 12.538973241959683

def test_BPtest_LM_statistic():
    arch = Arch()
    R_2 = 0.025185118907720204
    n = 1460
    BPtest_LM_statistic = arch.BPtest_LM_statistic(R_2, n)
    print("BPtest_LM_statistic")
    print(BPtest_LM_statistic)
# BPtest_LM_statistic
# 36.7702736052715

def test_get_F_critical():
    arch = Arch()
    fd_n = 110
    fd_d = 45
    significance_level = 0.05
    F_critical = arch.get_F_critical(fd_n, fd_d, significance_level)
    print("F_critical")
    print(F_critical)
# F_critical (50, 0.05, 2)
# 3.18
# F_critical (110, 0.05, 2)
# 3.082
# F_critical (100, 0.05, 45)
# 1.495
# F_critical (110, 0.05, 45)
# 1.4849999999999999

def test_arch_test():
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    q = 3
    significance_level = 0.05
    b_arch_Q, b_arch_LM, b_arch_F, b_arch_bpLM = arch.arch_test(y_residual_streamflow_395, q, significance_level)
    print("b_arch_Q")
    print(b_arch_Q)
    print("b_arch_LM")
    print(b_arch_LM)
    print("b_arch_F")
    print(b_arch_F)
    print("b_arch_bpLM")
    print(b_arch_bpLM)
# b_arch_Q, b_arch_LM
# (True, True)
# b_arch_Q, b_arch_LM  q=2  y_residual_streamflow_395
# (True, False)
# b_arch_Q, b_arch_LM  q=3  y_residual_streamflow_395
# (True, False)
# b_arch_Q, b_arch_LM  q=6  y_residual_streamflow_395
# (True, False)
# b_arch_Q, b_arch_LM  q=3  y_residual_streamflow_1460
# (True, False)
# b_arch_Q, b_arch_LM  q=6  y_residual_streamflow_1460
# (True, False)
# b_arch_Q, b_arch_LM, b_arch_bpLM  q=3  y_residual_streamflow_1460
# (True, False, True)
# b_arch_Q, b_arch_LM, b_arch_F, b_arch_bpLM  q=3  y_residual_streamflow_395
# (True, False, True, True)
# b_arch_Q, b_arch_LM, b_arch_F, b_arch_bpLM  q=3  y_residual_streamflow_1460
# (True, False, True, True)

def test_delta_2_one_step():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    q = 3
    # y_residual_2 = np.power(y_residual, 2)
    # y_residual_2_ = y_residual_2[2:2+q]
    y_residual_2_streamflow_395_ = y_residual_2_streamflow_395[3:3+q]
    y_residual_2_streamflow_395_.append(1)
    y_residual_2_streamflow_395_.reverse()
    alpha = [35.10725569, 0.86070866, -0.50716606,  0.41552226]
    delta_2_i = arch.delta_2_one_step(y_residual_2_streamflow_395_, alpha,)
    print("delta_2_i")
    print(delta_2_i)
# delta_2_i
# 35.967493821477845

def test_epsilon_2():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    y_residual_2 = np.power(y_residual, 2)
    y_residual_2 = y_residual_2.tolist()
    alpha = [35.10725569, 0.86070866, -0.50716606,  0.41552226]  # omega
    q = 3
    epsilon_2 = arch.epsilon_2(y_residual_2_streamflow_395, alpha, q)
    print("epsilon_2")
    print(epsilon_2)
# epsilon_2
# [ 0.00000000e+00  0.00000000e+00  1.39448247e+00  3.67809737e+01
#   3.56196324e+01  3.53651817e+01  3.59674938e+01  3.51383442e+01
#   3.53642220e+01  3.52589476e+01  3.51263958e+01  3.67725101e+01
#   3.56316565e+01  3.53422045e+01  3.59274909e+01  3.53800474e+01
#   3.53800474e+01  3.53800474e+01  3.54190326e+01  3.63003622e+01

def test_arch_least_squares_estimation():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    e_ = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    y_residual_2 = np.power(y_residual, 2)
    y_residual_2 = y_residual_2.tolist()
    q = 1
    e_2 = np.power(e_395, 2)
    a, R_2, delta_2 = arch.arch_ordinary_least_squares_estimation(y_residual_2_streamflow_1460, q)
    print("a")
    print(a)
    print("R_2")
    print(R_2)
    print("delta_2")
    print(delta_2)
# a y_residual_2_streamflow_395  q=3
# [35.10725569  0.86070866 -0.50716606  0.41552226]
# R_2
# 0.2360206703534833
# delta_2
# 0.0014069025302231941
# a y_residual_2_streamflow_1460  q=3
# [1.33278024e+04 1.25569344e-01 6.10891224e-02 4.37201780e-02]
# R_2
# 0.025185118907720204
# delta_2
# 2.0724485863696087e-10
# a  y_residual_2_streamflow_395  q=1
# [41.6261723   0.67115674]
# R_2
# 0.1912180277043999
# delta_2
# -2.3142358823738634e-15
# a
# [1.49127499e+04 1.37672850e-01]
# R_2
# 0.018953813664857603
# delta_2
# 9.581507969295046e-12

def test_Omega_i():
    arch = Arch()
    theta = [41.6261723, 0.67115674]
    Zi = [1, y_residual_2_streamflow_395[2]]
    sigma_n4 = arch.Omega_i(Zi, theta)
    print("sigma_n4")
    print(sigma_n4)
# sigma_n4  y_residual_2_streamflow_395[1]
# 0.0005771212224997373
# sigma_n4  y_residual_2_streamflow_395[2]
# 0.0005425654055262422

def test_Omega():
    arch = Arch()
    # theta = [41.6261723, 0.67115674]
    theta = [1.49127499e+04, 1.37672850e-01]
    Omega = arch.Omega(y_residual_2_streamflow_1460, theta)
    print("Omega")
    print(Omega)
# Omega
# y_streamflow_395_Omege
# Omega
# y_streamflow_1460_Omege

def test_arch_feasible_generalized_least_squares_estimation():
    arch = Arch()
    residual_2 = y_residual_2_streamflow_395
    Omege = y_streamflow_395_Omege
    b_y = False
    q = 4
    a, R_2 = arch.arch_feasible_generalized_least_squares_estimation(residual_2, q, Omege)   # , y
    print("a")
    print(a)
    print("R_2")
    print(R_2)
    # print("y")
    # print(y)
# a  y_residual_2_streamflow_395 q=3
# [ 2.18960415  0.02024819 -0.0022809   0.01220647]
# R_2
# 0.20152472141990246
# a  y_residual_2_streamflow_1460  q=3
# [6.71658575e+02 2.37001714e-02 3.90087440e-02 3.41720975e-02]
# R_2
# 0.01887150094068471
# y
# [671.65857542 672.93963109 674.96591371 ... 672.13081132 672.10939714
#  672.09004761]
# a  y_residual_2_streamflow_1460  q=2
# [7.78084010e+02 2.26087523e-02 5.56963086e-02]
# R_2
# 0.015415758616253898
# y
# [778.08401028 778.08401028 779.30607192 ... 778.44414034 778.43795922
#  778.45323335]
# a  y_residual_2_streamflow_395 q=3
# [ 2.18960415  0.02024819 -0.0022809   0.01220647]
# R_2
# 0.20152472141990246
# a   y_residual_2_streamflow_395  q=4
# [2.13812510e+00 1.74150336e-02 8.79121891e-04 7.03499591e-03
#  5.84739033e-03]
# R_2
# 0.194291868669965

def test_arch_constrained_ordinary_least_squares():
    arch = Arch()
    q = 4
    q_n = [2, 3]  # [ 2.18960415  0.02024819 -0.0022809   0.01220647]  the second parameter is negative.
    residual_2 = y_residual_2_streamflow_395
    Omega = y_streamflow_395_Omege
    # residual_2 = y_residual_2_streamflow_1460
    # Omega = y_streamflow_1460_Omege
    a, R_2 = arch.arch_constrained_ordinary_least_squares(residual_2, q, Omega, q_n=q_n, b_y=False)
    print("a")
    print(a)
    print("R_2")
    print(R_2)
    # print("y")
    # print(y)
# a  ordinary_least_squares()  y_residual_2_streamflow_395 q=3
# [34.83797803  0.60908538  0.          0.16389898]
# R_2
# 0.20090092667479065
# a  generalized_least_squares()  y_residual_2_streamflow_395 q=3
# [2.18518342 0.01851308 0.         0.01112357]
# R_2
# 0.19271578808251524
# a  generalized_least_squares()  y_residual_2_streamflow_1460  q=3  q_n=2
# [7.59918507e+02 3.04042231e-02 0.00000000e+00 4.70991700e-02]
# R_2
# 0.015063477236114566
# y
# [759.9185072  761.56193424 761.4564297  ... 760.30480721 760.29983445
#  760.225877  ]
# a  generalized_least_squares()  y_residual_2_streamflow_1460  q=3  q_n=2
# [7.01963967e+02 0.00000000e+00 5.24775189e-02 3.24733372e-02]
# R_2
# 0.009773397543140126
# y
# [701.96396727 701.96396727 704.80051314 ... 702.39017006 702.34078721
#  702.37449447]
# a   generalized_least_squares()  y_residual_2_streamflow_1460  q=3  q_n=1
# [9.96505964e+02 3.33257051e-02]
# R_2
# 0.01895381366485754
# y
# [996.50596352 996.50596352 996.50596352 ... 996.64746391 996.67910659
#  996.62366969]
# a  generalized_least_squares()  y_residual_2_streamflow_1460  q=3  q_n=2
# [7.59918507e+02 3.04042231e-02 0.00000000e+00 4.70991700e-02]
# R_2
# 0.015063477236114566
# a   y_residual_2_streamflow_395  q=3  q_n=2
# [2.18518342 0.01851308 0.         0.01112357]
# R_2
# 0.19271578808251524
# a   y_residual_2_streamflow_395  q=3  q_n=[2, 3]
# [2.20308553 0.01903664 0.         0.         0.01019919]
# R_2
# 0.19985836190027448

def test_initial_values():
    arch = Arch()
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    beta = [2.18518342, 0.01851308, 0., 0.01112357]
    ini_values = arch.initial_values(alpha, beta)
    print("ini_values")
    print(ini_values)
# ini_values
# -5933641468865  # todo:1.75
# ini_values  omega
# 2.18518342

def test_conditional_quasi_likelihood():
    arch = Arch()
    p = 2
    q = 3
    residual_2 = y_residual_2_streamflow_395[1:1+q]
    delta_2 = [1, 1,1, 1,2]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    beta = [2.18518342, 0.01851308, 0., 0.01112357]
    delta_2 = arch.conditional_quasi_likelihood(residual_2, delta_2, q, alpha, beta)
    print("delta_2")
    print(delta_2)

def test_arma_garch():
    arch = Arch()
    P = 3
    Q = 2
    p = 2
    q = 3
    residual_2 = y_residual_2_streamflow_395[1:1+q]
    delta_2 = [1, 1,1, 1,2]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    beta = [2.18518342, 0.01851308, 0., 0.01112357]
    h, e, xx = arch.arma_garch(residual_2, delta_2, P, Q, p, q, alpha, beta)
    print("h")
    print(h)
    print("e")
    print(e)
    print("xx")
    print(xx)

def test_asymptotic_variance_a0_alpha0():
    arch = Arch()
    a = 1
    alpha = 2
    variance = arch.asymptotic_variance_a0_alpha0(a, alpha)
    print("variance")
    print(variance)


def test_likelihood_equations():
    arch = Arch()
    p = 2
    q = 3
    residual_2 = y_residual_2_streamflow_395[1:1+q]
    delta_2 = [1, 1,1, 1,2]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    beta = [2.18518342, 0.01851308, 0., 0.01112357]
    eta_2 = [2.18518342, 0.01851308, 0., 0.01112357]
    l = arch.likelihood_equations(residual_2, delta_2, eta_2)
    print("l")
    print(l)

def test_arch_asymptotic_variance():
    arch = Arch()
    p = 2
    q = 3
    residual_2 = y_residual_2_streamflow_395[1:1+q]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    beta = [2.18518342, 0.01851308, 0., 0.01112357]
    eta_2 = [2.18518342, 0.01851308, 0., 0.01112357]
    average_f = arch.arch_asymptotic_variance(residual_2, alpha)
    print("average_f")
    print(average_f)

def test_delta_2():
    arch = Arch()
    residual_2 = y_residual_2_streamflow_395
    # residual_2 = y_residual_2_streamflow_395_1
    alpha0 = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha1 = [9.30971232e+01, 9.49159600e+01, 0.00000000e+00, 9.46274455e+02]
    alpha2 = [35.19315819, 0.9220255,  0., 3.8679039]
    alpha3 = [35.40975055, 1.11804071, 0., 3.56875317]
    alpha4 = [42.2744951, 28.59260134, 0., 420.75117497]
    alpha5 = [46.11069133, 21.70821798, 0., 106.6395288]
    alpha4_ = [2.30286748e+03, 1.48993133e+03, 0.00000000e+00, 7.35790267e+03]
    alpha4_ = [3.17251096e+03, 2.18526687e+03, 0.00000000e+00, 8.75038684e+03]
    alpha4_ = [2.00659474e+03, 1.42036877e+03, 0.00000000e+00, 2.10256674e+04]
    alpha4_ = [1.37244233e+03, 1.82313809e+03, 0.00000000e+00, 1.34555206e+04]
    alpha4_ = [35.19315819, 0.9220255, 0., 3.8679039]
    alpha4_ = [4.81614767e+03, 1.59475061e+03, 0.00000000e+00, 4.92331438e+04]
    alpha4_ = [256.76405645, 257.17492165, 256.21983995, 256.45970337]
    alpha_395_1 = [35.40808393, 1.1411455, 0.22434246, 4.09766646]
    alpha_395_2 = [68.35686024, 66.15518812, 66.16172623, 66.19459768]
    alpha_395_2 = [24.88502542, 22.72549769, 22.69956968, 22.6979746]
    alpha_395_2 = [12.82059331, 10.67330381, 10.63789087, 10.6258312]
    alpha_395_2 = [34.54383114, 0.25392635, 0., 2.69992071]
    alpha_395_2 = [34.51688396, 0.24714697, 0., 3.18938236]
    alpha_395_2 = [31, 0.15392635, 0., 1.69992071]
    alpha_395_2 = [28, 0.15392635, 0., 1.1]
    alpha_395_2 = [2, 1]
    alpha_395_2 = [25, 0.1, 0., 0.95]
    alpha_395_2 = [27.52040446, 0.25392635, 0.0, 0.9377970799999997]
    alpha_395_2 = [27.522109401732685, 0.25392635, 0.0, 0.9382139505572842]
    alpha_395_2 = [27.522109401732685, 0.25392635, 0.0, 0.4399943968985215]
    alpha_395_2 = [6.68332411, 0.04860733, 0., 1.17182912]
    alpha_395_2 = [3.1894915, 2.21839188, 1.94194313, 2.72129519]
    alpha_395_2 = [9.57176198, 0.24797631, 0.0, 9.13934837]
    alpha_395_2 = [27.27562994, 0.59387741, 0., 0.47085832]
    alpha_395_2 = [28.315534512397793, 0.4930557878144175, 0.0, 0.417781961114859]
    alpha_395_2 = [28.315534512397793, 0.4930557878144175, 0.0, 0.417781961114859]
    alpha_395_2 = [27.53412208, 0.26761428, 0.0, 0.45247333]
    alpha_395_2 = [31.854001115793487, 0.7860586340837658, 0, 0.0238826394]
    alpha_395_2 = [1.24844341, 0.24797631, 0., 0.80837988]
    alpha_395_2 = [9.57176198, 0.19900104230560642, 0.0, 0.7608739469009016]
    alpha_395_2 = [9.57176198, 0.653031955108359, 0.0, 0.19799621871888057]
    alpha_395_2 = [32.627761957093725, 0.34626167604364577, 0.0, 0.29322838191996803]
    # delta_2 = arch.delta_2(residual_2, alpha_395_2)
    residual = y_residual_streamflow_1460
    mean_residual, residual_center = arch.residual_center(residual)
    residual_2 = np.power(residual_center, 2)
    alpha = [6.71921606e+02, 1.62963230e+04, 3.34895884e+02, 3.69703420e+01]
    alpha = [6.85822878e+02, 1.73127878e+03, 5.06418697e+02, 3.99362576e+02]
    alpha = [6.98690405e+02, 2.76598574e+01, 2.82575788e+01, 2.89027965e+01]
    alpha = [5.938228063533756, 5.658997571510659, 0.039008744, 0.0341720975]
    alpha_1460 = [8.11449905e+02, 6.55662354e-01, 2.01090012e-01, 1.14012439e-02]
    delta_2 = arch.delta_2(residual_2, alpha)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\delta_2.txt', delta_2)
    # print("delta_2")
    # print(delta_2)

def test_log_likelihood_gauss_vt():
    arch = Arch()
    residual_2 = y_residual_2_streamflow_395
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha = [1.24844341, 0.24797631, 0., 0.80837988]
    alpha = [6.68332411, 0.04860733, 0., 1.17182912]
    alpha = [27.53412208, 0.26761428, 0., 0.45247333]
    alpha = [9.57176198, 0.24797631, 0., 9.13934837]
    alpha = [27.27562994, 0.59387741, 0., 0.47085832]
    L_theta = arch.log_likelihood_gauss_vt(residual_2, alpha)
    print("L_theta")
    print(L_theta)
# L_theta_bc
# 3366.3309763442985
# L_theta_bc
# 3366.3309763442985
# L_theta
# -3729.311696960144
# L_theta
# -3166.8616991943304
# L_theta   alpha = [6.68332411, 0.04860733, 0., 1.17182912]
# -1601.7054566091706
# L_theta   alpha = [27.53412208, 0.26761428, 0., 0.45247333]
# -1309.8630227142996
# L_theta    alpha = [9.57176198, 0.24797631, 0., 9.13934837]
# -1351.3885224262633

def test_distance_theta_0_1():
    arch = Arch()
    theta0 = [2.18518342, 0.01851308, 0., 0.01112357]
    theta1 = [34.83797803, 0.60908538, 0., 0.16389898]
    gradient = [-30052.930200781702, -30781.481516442, -1146.8238021734578, -14832.662553089904, -6339.343972740608, -17149.872735899407]
    distance = arch.distance_theta_0_1(gradient)
    print("distance")
    print(distance)
# distance  theta0 theta1
# 1066.577111810273
# distance  gradient
# 2406306718.109453

def test_gradient_theta():
    arch = Arch()
    lambd = 0.8
    theta0 = [2.18518342, 0.01851308, 0., 0.01112357]
    theta1 = [34.83797803, 0.60908538, 0., 0.16389898]
    grad = arch.gradient_theta(lambd, theta0, theta1)
    print("grad")
    print(grad)
# grad
# [-52.24447138  -0.94491568  -0.          -0.24444066]

def test_x_residual_via_parameters():
    arch = Arch()
    x = y_streamflow_395
    phi = [1.86818005, -0.87194949]
    phi = [103.06400015, 101.64626596]
    x_residual = arch.x_residual_via_parameters(x, phi)
    print("x_residual")
    print(x_residual)
    # print("y_t")
    # print(y_t)
# x_residual
# [ 0.00000000e+00  0.00000000e+00  1.39448223e+00  1.31951719e+00
# y_t
# [167.6        165.8        163.60551777 163.68048281 164.3780424

def test_gradient_thetai():
    arch = Arch()
    x = y_streamflow_395
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    theta = phi + alpha
    d_theta = 0.000001
    i_theta = 3
    grad = arch.gradient_thetai(x, theta, d_theta, i_theta, p, q)
    print("grad")
    print(grad)
# grad   d_theta=0.000001  i_theta=0
# 30052.930200326955
# grad
# 14832.662553089904

def test_gradient():
    arch = Arch()
    x = y_streamflow_395
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha1 = [9.30971232e+01, 9.49159600e+01, 0.00000000e+00, 9.46274455e+02]
    alpha2 = [35.19315819, 0.9220255,  0., 3.8679039]
    alpha3 = [35.40975055, 1.11804071, 0., 3.56875317]
    alpha4 = [2.18518342, 0.1851308, 0., 0.1112357]
    alpha4_ = [42.2744951, 28.59260134, 0., 420.75117497]
    alpha4_ = [6.49175070e-03, 3.02082401e-02, 0.00000000e+00, 9.81992982e-01]
    alpha4_ = [6.49175070e+01, 3.02082401e+02, 0.00000000e+00, 9.81992982e+03]
    alpha5 = [35.27874373, 1.03865214, 0., 4.72882228]
    alpha3_ = [35.50123889, 1.23349839, 0., 4.49514331]
    theta = phi + alpha4_
    d_theta = 0.000001
    i_theta = [2, 3, 5]
    grad = arch.gradient(x, theta, d_theta, p, q, i_theta)
    print("grad")
    print(grad)
# grad   alpha4_
# [0, 0, -0.9318364391219802, -1.0781370747281471, 0, -0.26700718080974184]
# grad  alpha5
# [0, 0, -0.9173791113425978, -9.91096476354869, 0, -3.671990498332889]
# grad  alpha3_
# [0, 0, -0.8961903859017184, -9.683588586995029, 0, -3.777280880967737]
# grad  alpha4_ = [6.49175070e-03, 3.02082401e-02, 0.00000000e+00, 9.81992982e-01]
# [0. 0. 67986.07189103 25468.47745907 0. 6237.62756641]
# grad  alpha4_ = [6.49175070e+01, 3.02082401e+02, 0.00000000e+00, 9.81992982e+03]
# [ 0.          0.         -0.12391547 -0.10186704  0.         -0.01593025]

def test_gradient_module():
    arch = Arch()
    grad0 = [0, 0, 1146.8238021734578, 14832.662553089904, 0, 17149.872735899407]
    grad1 = [0, 0, -0.40426266423310153, -0.39192309486679733, 0, -0.12180657904536929]
    grad2 = [0, 0, -0.8498277566104662, -10.047750492958585, 0, -4.117954404136981]
    grad3 = [0, 0, -0.821793264549342, -9.939450137608219, 0, -4.3086290588689735]
    grad4 = [0, 0, -0.9318364391219802, -1.0781370747281471, 0, -0.26700718080974184]
    module = arch.gradient_module(grad4)
    print("module")
    print(module)
# module  grad0
# 22703.330550926068
# module   grad1
# 0.5760805991192116
# module   grad2
# 10.892063425228766
# module   grad3
# 10.864267005858649
# module   grad4
# 1.4498246569095397

def test_grid_search():
    arch = Arch()
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha4 = [2.18518342, 0.1851308, 0., 0.1112357]
    theta = phi + alpha4
    grad = [0, 0, 1146.8238021734578, 14832.662553089904, 0, 17149.872735899407]
    grad4 = [0, 0, 867.7843084115011, 380.4215930358623, 0, 1610.3814296002383]
    d_theta = 0.000001
    p = 2
    q = 3
    theta1, likelihood_theta_1_0, L_theta = arch.grid_search(y_residual_2_streamflow_395, theta, grad4, d_theta, p)
    print("theta1")
    print(theta1)
    print("likelihood_theta_1_0")
    print(likelihood_theta_1_0)
    print("L_theta")
    print(L_theta)
# theta1
# [ 1.86818005 -0.87194949  2.2035326   0.25583568  0.          0.28552153]
# likelihood_theta_1_0
# 976.0210089674238
# L_theta
# -2753.2906879927204
# theta1  alpha4
# [ 1.86818005 -0.87194949  2.2035326   0.4224534   0.          0.38563366]
# likelihood_theta_1_0
# 329.8449981934873
# L_theta
# -2655.687445100867
# theta1  alpha4
# [ 1.86818005 -0.87194949  2.19906797  0.19121755  0.          0.1370018 ]
# likelihood_theta_1_0
# 52.501197072047034
# L_theta
# -2933.0312462223073

def test_grid_search_single_parameter():
    arch = Arch()
    residual_2 = y_residual_2_streamflow_395
    phi = [1.86818005, -0.87194949]
    alpha = [34.54383114, 0.25392635, 0., 2.69992071]
    theta = phi + alpha
    gradient = [0., 0., -3.51171334, -3.5041112, -3.51313309, -3.52424726]
    p = 2
    q = 3
    theta1, likelihood_theta_1_0, L_theta = arch.grid_search_single_parameter(residual_2, theta, gradient, p, q)
    print("theta1")
    print(theta1)
    print("likelihood_theta_1_0")
    print(likelihood_theta_1_0)
    print("L_theta")
    print(L_theta)
# theta1
# [1.86818005, -0.87194949, 27.52040446, 0.25392635, 0.0, 0.9377970799999997]
# likelihood_theta_1_0
# 9.206679431804105
# L_theta
# -1311.1707213307743

def test_b_sort():
    arch = Arch()
    x = [0.19799621871888057, 0.653031955108359]
    x = np.array(x)
    b_sort = arch.b_sort(x)
    print("b_sort")
    print(b_sort)
# b_sort
# False

def test_gradient_ascent():
    arch = Arch()
    x_1 = y_streamflow_395
    phi = [1.86818005, -0.87194949]
    alpha4 = [2.18518342, 0.1112357, 0., 0.1851308]
    alpha3 = [31, 0.15392635, 0., 1.69992071]
    alpha3 = [25, 0.15392635, 0., 0.9]
    alpha3 = [12.38431257, 0.36105982, 0.31656086, 10.18909357]
    alpha3 = [27.522109401732685, 0.25392635, 0.0, 0.9382139505572842]
    alpha3 = [25, 0.1, 0., 0.95]
    alpha3 = [27.522109401732685, 0.25392635, 0.0, 0.4399943968985215]
    alpha3 = [27.27562994, 0.59387741, 0., 0.47085832]
    alpha3 = [2.18518342, 0.01851308, 0., 0.01112357]  #
    alpha3 = [34.54383114, 0.25392635, 0., 2.69992071]
    alpha3 = [35.40975055, 1.11804071, 0., 3.56875317]
    alpha3 = [6.49175070e-03, 3.02082401e-02, 0.00000000e+00, 9.81992982e-01]
    alpha3 = [12.6339965, 13.27432677, 12.14344754, 12.20402554]
    alpha3 = [35.19315819, 0.9220255, 0., 3.8679039]
    alpha3 = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha3 = [12.6339965, 13.27432677, 12.14344754, 12.20402554]
    alpha3 = [27.53412208, 0.26761428, 0., 0.45247333]
    alpha3 = [6.68332411, 0.04860733, 0.0, 1.17182912]
    alpha3 = [12.38431257, 0.36105982, 0.31656086, 10.18909357]
    alpha3 = [12.38431257, 0.36105982, 0, 10.18909357]
    alpha3 = [34.54437298, 0.27457799, 0., 0.08664029]
    alpha3 = [28.315534512397793, 0.4930557878144175, 0.0, 0.417781961114859]
    alpha3 = [0.5, 1.1, 0., 0.1]
    alpha3 = [31.854001115793487, 0.7860586340837658, 0, 0.0238826394]
    alpha3 = [1.24844341, 0.24797631, 0., 0.80837988]
    alpha3 = [2.13532, 0.24797631, 0., 0.913934837]
    alpha3 = [9.57176198, 0.7608739469009016, 0.0, 0.19900104230560642]
    alpha3 = [9.57176198, 0.24797631, 0., 9.13934837]
    alpha3 = [9.57176198, 0.653031955108359, 0.0, 0.19799621871888057]
    alpha3 = [4.371142650345725, 0.01851308, 0.0, 22.69797459697165]
    alpha3 = [4.28662871e+01, 9.57687128e-01, 1.54552824e-02, 2.38826394e-02]
    alpha3 = [31.407267353060522, 0.24797631, 0.0, 0.3684060832831398]
    alpha3 = [2.13532, 0.24797631, 0.0, 9.13934837]
    alpha3 = [27.58876158046549, 0.24797631, 0.0, 0.41743525552577315]
    alpha3 = [32.627761957093725, 0.34626167604364577, 0.0, 0.29322838191996803]
    alpha3 = [31.854001115793487, 0.7860586340837658, 0, 0.0238826394]
    alpha3 = [27.58876158046549, 0.41743525552577315, 0.0, 0.24797631]
    theta = phi + alpha3
    # theta = [9.16096572e+03, 9.20671727e+03, 4.28662871e+01, 9.57687128e-01, 1.54552824e-02, 2.38826394e-02]
    x = y_streamflow_1460
    phi_1460 = [1.80161201, -1.28440015, 0.43756275]
    alpha_1460 = [5.938228063533756, 5.658997571510659, 0.039008744, 0.0341720975]
    alpha_1460 = [5.938228063533756, 5.658997571510659]
    alpha_1460 = [5.938228063533756, 0.658997571510659, 0.039008744, 0.0341720975]
    alpha_1460 = [8.11449905e+02, 6.55662354e-01, 2.01090012e-01, 1.14012439e-02]
    alpha_1460 = [8.12368859e+02, 6.54006050e-01, 2.01399265e-01, 1.21316704e-02]
    alpha_1460 = [6.71658575e+02, 2.37001714e-02, 3.90087440e-02, 3.41720975e-02]
    alpha_1460 = [1.23897803e+03, 8.03851893e-01, 0.00000000e+00, 3.52769147e-02]
    alpha_1460 = [4.81614767e+03, 1.59475061e+03, 0.00000000e+00, 4.92331438e+04]
    alpha_1460 = [694.8050247685098, 5.658997571510659, 0.039008744, 0.0341720975]
    # theta = phi_1460 + alpha_1460
    p = 2
    q = 3
    b_arima = True
    theta1 = arch.gradient_ascent(x_1, theta, p, q, b_arima)
    print("theta1")
    print(theta1)
## y_streamflow_1460  phi_1460 = [1.80161201, -1.28440015, 0.43756275]  alpha_1460 = [4.81614767e+03, 1.59475061e+03, 0.00000000e+00, 4.92331438e+04]
# ----------iloop = 0----------
# [ 1.80161201e+00 -1.28440015e+00  4.37562750e-01  4.81612627e+03  1.59472905e+03  0.00000000e+00  4.92331219e+04]
# gradient = [-1.76564282e+04 -1.79651959e+04 -1.82109810e+04 -1.33771892e-03 -1.34764406e-03 -1.35738251e-03 -1.36674299e-03]
# L_theta = -12705.653677769478
# distance_grad_0 = 7.316110101400201e-06
# likelihood_theta_1_0 = 0.0010807966191350715
# distance_theta_1_0 = 0.001401236958408247
# theta1 = [ 1.80161201e+00 -1.28440015e+00  4.37562750e-01  4.81612627e+03  1.59472905e+03  0.00000000e+00  4.92331219e+04]
# ----------end----------
# gradient = [ 2.91096585e+03  2.84855721e+03  2.87514816e+03 -1.13675641e-01  -1.34230524e-01 -1.53066317e-01 -1.73128576e-01]
# L_theta = -7575.795363043124
# distance_grad_0 = 0.08434278603119609
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 1730
# theta1
# [ 1.80161201e+00 -1.28440015e+00  4.37562750e-01  1.23897803e+03  8.03851893e-01  0.00000000e+00  3.52769147e-02]
## y_streamflow_395  phi = [1.86818005, -0.87194949]  alpha = alpha3 = [27.58876158046549, 0.41743525552577315, 0.0, 0.24797631]
# ----------iloop = 0----------
# [1.86818005, -0.87194949, 27.58876158046549, 0.41743525552577315, 0.0, 0.24797631]
# gradient = [2246.8588131  2243.94290814   -3.70037562   -3.68966512   -3.70247231   -3.71898943]
# L_theta = -1298.6559523142448
# distance_grad_0 = 54.84559202149318
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# theta1 = [1.86818005, -0.87194949, 27.58876158046549, 0.41743525552577315, 0.0, 0.24797631]
# ----------end----------
# gradient = [2246.8588131  2243.94290814   -3.70037562   -3.68966512   -3.70247231   -3.71898943]
# L_theta = -1298.6559523142448
# distance_grad_0 = 54.84559202149318
# likelihood_theta_1_0 = 0.0
# distance_theta_1_0 = 0.0
# iloop = 0
# theta1
# [1.86818005, -0.87194949, 27.58876158046549, 0.41743525552577315, 0.0, 0.24797631]

def test_multi_gradient_ascent():
    arch = Arch()
    phi = [1.86818005, -0.87194949]
    alpha1 = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha2 = [34.83797803, 0.60908538, 0., 0.16389898]
    alpha3 = [35.10725569, 0.86070866, 0.0, 0.41552226]
    alpha4 = [0.5, 1.1, 0., 0.1]
    theta1 = phi[:] + alpha1[:]
    theta2 = phi[:] + alpha2[:]
    theta3 = phi[:] + alpha3[:]
    theta = [theta1[:], theta2[:], theta3[:]]
    phi_1460 = [1.80161201, -1.28440015, 0.43756275]
    alpha_1460 = [6.71658575e+02, 2.37001714e-02, 3.90087440e-02, 3.41720975e-02]
    theta = phi_1460 + alpha_1460
    d_theta = 0.000001
    p = 2
    p=3
    q = 3
    i_theta = [2, 3, 5]
    i_theta = [3, 4, 5, 6]
    theta1 = arch.multi_gradient_ascent(y_residual_2_streamflow_395, theta, d_theta, p, q, i_theta)
    print("theta1")
    print(theta1)
# 1 theta1 L_theta
# ----------end----------
# gradient = [ 0.          0.         -0.03091418 -0.02333354  0.          0.00591263]
# L_theta = -2906.4385930042995
# distance_grad_0 = 0.001535099789738615
# likelihood_theta_1_0 = 9.157446538665681e-05
# distance_theta_1_0 = 5.996483553666465e-06
# iloop = 2
# ----------end----------
# gradient = [ 0.          0.         -0.03589912 -0.02705701  0.          0.00981709]
# L_theta = -2910.6908158702904
# distance_grad_0 = 0.0021172039317647368
# likelihood_theta_1_0 = 0.00012027964112348855
# distance_theta_1_0 = 8.270327858456003e-06
# iloop = 2
# theta1
# [array([ 1.86818005e+00, -8.71949490e-01,  3.55126928e+05,  3.70693097e+05,
#         0.00000000e+00,  3.69634114e+06]), array([ 1.86818005e+00, -8.71949490e-01,  1.42225607e+03,  1.22301976e+03,
#         0.00000000e+00,  1.44689296e+04]), array([ 1.86818005e+00, -8.71949490e-01,  1.21672379e+03,  1.00605286e+03,
#         0.00000000e+00,  1.23177205e+04])]

def test_st_theta():
    arch = Arch()
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [35.19315819, 0.9220255,  0., 3.8679039]
    residual_2 = y_residual_2_streamflow_395[4:4+q+1]  # t = 8  i=7
    residual_2.reverse()
    residual = y_residual_streamflow_395[4:4+q+1]
    residual.reverse()
    x = y_streamflow_395[4-p:4+q]
    x.reverse()
    residual_2_ = residual_2.copy()
    residual_2_[0] = 1
    alpha_ = np.transpose(alpha)
    h = arch.delta_2_one_step(residual_2_, alpha_)
    st = arch.st_theta(residual, x, h, alpha, p, q)
    print("st")
    print(st)
# st
# [-5.24625544e+00 -5.24240296e+00 -1.35432734e-02 -1.04699592e-03
#  -5.23896533e-03 -5.23896533e-03]
# st  alpha = [35.19315819, 0.9220255,  0., 3.8679039]
# [-6.57425924e+00 -6.58397153e+00 -1.35432676e-02 -1.04667789e-03
#  -5.23967354e-03 -5.23967354e-03]

def test_gradient_s():
    arch = Arch()
    x = y_streamflow_395
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    alpha = [35.19315819, 0.9220255, 0., 3.8679039]
    theta = phi + alpha
    gradient = arch.gradient_s(x, theta, p, q)
    print("gradient")
    print(gradient)
# gradient
# [-1619.12801894 -1640.28632029    -3.43881184    -3.4317577
#     -3.44010076    -3.45012194]

def test_residual_divide_delta_mean_std():
    arch = Arch()
    residual = y_residual_streamflow_395
    phi = [1.86818005, -0.87194949]
    alpha = [35.19315819, 0.9220255, 0., 3.8679039]
    theta = phi + alpha
    delta_2 = arch.delta_2(y_residual_2_streamflow_395, alpha)
    delta = np.sqrt(delta_2)
    mean, std = arch.residual_divide_delta_mean_std(residual, delta)
    print("mean")
    print(mean)
    print("std")
    print(std)
# mean
# 0.161609753502022
# std
# 0.829115257619602

def test_arch():
    arch = Arch()
    residual_2 = y_residual_2_streamflow_395
    e = e_395
    alpha = [32.627761957093725, 0.34626167604364577, 0.0, 0.29322838191996803]
    epsilon = arch.arch(residual_2, e, alpha)
    print("epsilon")
    print(epsilon)
# epsilon
# [ 9.37362632e+00 -3.53026896e+00 -3.04792610e+00 -6.19179095e+00
#   4.98873138e+00 -1.32876568e+01  1.00644419e+01 -4.35739994e+00

def test_arima_arch():
    arch = Arch()
    x = y_streamflow_395
    e = e_395
    p = 2
    q = 3
    phi = [1.86818005, -0.87194949]
    alpha = [32.627761957093725, 0.34626167604364577, 0.0, 0.29322838191996803]
    theta = phi + alpha
    y_t = arch.arima_arch(x, e, theta, p, q)
    print("y_t")
    print(y_t)
# y_t
# [176.97362629 162.26973105 160.55759167 157.48869188 169.36677376
#  151.09038563 174.44248422 158.33928042 161.94576829 157.08564851

def test_arima_arch_1460():
    arch = Arch()
    x = y_streamflow_1460
    p = 3
    q = 3
    phi_1460 = [1.80161201, -1.28440015, 0.43756275]
    alpha_1460 = [8.11449905e+02, 6.55662354e-01, 2.01090012e-01, 1.14012439e-02]
    theta = phi_1460 + alpha_1460
    y_arch, y_arch_s, y_arima, residual, mean_residual, residual_center, residual_2, delta_2, delta, epsilon, e, e_, nse, rmse, max_abs_error = arch.arima_arch(x, theta, p, q)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\y_arch.txt', y_arch)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\y_arch_s.txt', y_arch_s)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\y_arima.txt', y_arima)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\residual.txt', residual)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\residual_center.txt', residual_center)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\residual_2.txt', residual_2)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\delta_2.txt', delta_2)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\delta.txt', delta)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\epsilon.txt', epsilon)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\e.txt', e)
    np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\e_.txt', e_)
    print("mean_residual = " + str(mean_residual))
    print("NSE = " + str(nse))
    print("RMSE = " + str(rmse))
    print("max_abs_error = " + str(max_abs_error))
# e13
# mean_residual = 13.743311710946587
# NSE = 0.8963015155709045
# RMSE = 164.1130601263889
# max_abs_error = 3991.533857455335
# e14
# mean_residual = 13.743311710946587
# NSE = 0.8906916385007407
# RMSE = 168.49368605135302
# max_abs_error = 3983.5711724228454
# e15
# mean_residual = 13.743311710946587
# NSE = 0.9239190035192292
# RMSE = 140.57077368034888
# max_abs_error = 3171.637157356575

def test_arima_arch_model():
    arch = Arch()
    x = y_streamflow_1460
    p = 3
    q = 3
    phi_1460 = [1.80161201, -1.28440015, 0.43756275]
    alpha_1460 = [8.11449905e+02, 6.55662354e-01, 2.01090012e-01, 1.14012439e-02]
    theta = phi_1460 + alpha_1460
    nse = 0.92
    rmse = 130
    max_error = 3000
    max_loop =1000
    result = arch.arima_arch_model(x, theta, p, q, nse, rmse, max_error, max_loop)
    if result["y_arch"] is not None:
        np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\y_arch.txt', result["y_arch"])
        np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\y_arima.txt', result["y_arima"])
        np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\residual.txt', result["residual"])
        np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\residual_center.txt', result["residual_center"])
        np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\residual_2.txt', result["residual_2"])
        np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\delta_2.txt', result["delta_2"])
        np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\delta.txt', result["delta"])
        np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\epsilon.txt', result["epsilon"])
        np.savetxt(r'D:\minio\waterism\datasets-origin\camels\camels_ystl\arch\e_.txt', result["e"])
        print("n_loop = " + str(result["i_loop"]))
        print("mean_residual = " + str(result["mean_residual"]))
        print("NSE = " + str(result["nse"]))
        print("RMSE = " + str(result["rmse"]))
        print("max_abs_error = " + str(result["max_abs_error"]))
# e17    nse = 0.92  rmse = 130  max_error = 3200
# n_loop = 104
# mean_residual = 13.743311710946587
# NSE = 0.935538020237547
# RMSE = 129.39239715058932
# max_abs_error = 2734.8405995230596
# e18    nse = 0.92  rmse = 130  max_error = 2800
# n_loop = 145
# mean_residual = 13.743311710946587
# NSE = 0.9399722485755084
# RMSE = 124.86277331050377
# max_abs_error = 2632.3670951118047
# e20    nse = 0.92  rmse = 130  max_error = 2500
# n_loop = 97
# mean_residual = 13.743311710946587
# NSE = 0.9474276062760204
# RMSE = 116.85190983060292
# max_abs_error = 2337.8740910390716
# e21    nse = 0.92  rmse = 130  max_error = 2400
# n_loop = 505
# mean_residual = 13.743311710946587
# NSE = 0.939438206953457
# RMSE = 125.41696918041434
# max_abs_error = 2293.1312354338224

def test_infer_arch():
    arch = Arch()
    # camelsus_streamflow_01013500_80  i=15
    residual_2 = [9.340741818, 9.51309017, 47.4390774, 45.18711657]
    alpha = [3.17744057e+02, 2.78526653e-01, 5.45285923e-01, 4.38002156e-03, 1.15738438e-02]
    q = 4
    e = [0.03, -0.32, 0.86, -0.09]
    epsilon = arch.infer_arch(residual_2, alpha, q, e)
    print("epsilon = ", epsilon)


def test_log_likelihood_gamma():
    arch = Arch()
    x = y_streamflow_395
    p = 2
    q = 3
    v = 3
    phi = [1.86818005, -0.87194949]
    alpha = [2.18518342, 0.01851308, 0., 0.01112357]
    theta = phi + alpha
    residual_2 = y_residual_2_streamflow_395
    L_theta = arch.log_likelihood_gamma(v, residual_2, theta, p, q)
    print("L_theta")
    print(L_theta)
# L_theta
# -932.9348379994717

def test_mL_estimation():
    arch = Arch()
    x = 0
    y = 0
    e = 0.05
    lnLt = arch.mL_estimation(x, y, e)
    print("lnLt")
    print(lnLt)


def test_garch_one_step():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    h = [1, 2]
    arch = Arch()
    y_residual_2 = np.power(y_residual, 2)
    eta = [0.5, 0.5]
    alpha = [1.1, 0.5, -0.5]
    epsilon_t, h_t = arch.garch_one_step(h, y_residual_2, eta, alpha, e)
    print("epsilon_t")
    print(epsilon_t)
    print("h_t")
    print(h_t)

def test_garch():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    y_residual_2 = np.power(y_residual, 2)
    p = 2
    q = 2
    eta = [0.5, 0.5]
    alpha = [1.1, 0.5, -0.5]
    epsilon_t = arch.garch(y_residual_2, e, eta, alpha, p, q)
    print("epsilon_t")
    print(epsilon_t)

def test_garch_least_squares_estimation():
    e = [1.7353783, -0.50072347, -0.41713881, -0.96193568, 0.97644057, -2.19050576, 1.8558447, -0.65017396,
         0.43007204, -0.13833744, 1.57314088, -1.94910777, -0.21138426, -0.27302141, 1.24480238, -0.98885833,
         -0.06139527, -0.76682548, 0.15324669, 0.69384815, -0.98958624, 1.25575665, 1.01262366, 0.61352728,
         1.01188889, -0.57269492, -0.01185729, -0.82473649, -0.15685514, 0.64138841, -0.58062781, -0.28572059,
         -0.57613976, -0.7341727, -0.56021319, 0.09836834, -1.00627741, 0.34544864, 1.77083512, 0.8530771,
         -0.08080261, -0.77659602]
    y_residual = [0, 0, -7.00148942, 2.81307703, -0.86616938, 2.35613508, -1.19714684, 0.4232423, -0.4589695,
                  0.54786256, -1.83051924, 1.84837348, 0.76232344, 0.96888897, -1.44205859, 1.03469247,
                  0.18368458, 1.3957388, -0.13007158]
    arch = Arch()
    h = [1, 1]
    y_residual_2 = np.power(y_residual, 2)
    y_residual_2 = y_residual_2.tolist()
    p = 2
    q = 2
    a, R_2 = arch.garch_least_squares_estimation(h, y_residual_2, e, p, q)
    print("a")
    print(a)
    print("R_2")
    print(R_2)

def ar1(
    x,
    phi,
    c,
    e,
):
    """AR(1)"""
    x_t = c + phi * x + e

    return x_t

def arch_ordinary_least_squares_estimation():
    """
    estimation of ARCH(q) models by ordinary least squares.
    Returns
    -------

    """


def test_ar1():
    x = [0.8, 0.2, -1.2, -0.4, 0.0]

